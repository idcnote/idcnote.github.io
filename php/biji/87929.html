<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>Yii查询生成器(Query Builder)用法实例教程_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="本文为yii官网英文文档的翻译版本，主要介绍了Yii查询生成器(Query Builder)的用法。分享给大家供大家参考之用。具体如下：<br />
首先，Yii的查询生成器提供了用面向对象的方式写SQL语" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">Yii查询生成器(Query Builder)用法实例教程</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>本文为yii官网英文文档的翻译版本，主要介绍了Yii查询生成器(Query Builder)的用法。分享给大家供大家参考之用。具体如下：<br />
首先，Yii的查询生成器提供了用面向对象的方式写SQL语</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>本文为yii官网英文文档的翻译版本，主要介绍了Yii查询生成器(Query Builder)的用法。分享给大家供大家参考之用。具体如下：</p>
<p>首先，Yii的查询生成器提供了用面向对象的方式写SQL语句。它允许开发人员使用类的方法和属性来指定一个SQL语句的各个部分。然后，组装成一个有效的SQL语句，可以通过调用DAO数据访问对象的描述方法为进一步执行。以下显示了一个典型的使用查询生成器建立一个select语句：</p>
<div class="phpstudycode">
<pre class="brush:php;">
$user = Yii::app()-&gt;db-&gt;createCommand()
  -&gt;select('id, username, profile')
  -&gt;from('tbl_user u')
  -&gt;join('tbl_profile p', 'u.id=p.user_id')
  -&gt;where('id=:id', array(':id'=&gt;$id))
  -&gt;queryRow();

</pre>
</div>
<p>当你在应用程序中需要组装SQL语句的程序，或基于一些条件逻辑时，最好使用查询生成器。使用查询生成器的好处主要包括：</p>
<p>①.它可以建立复杂的SQL语句编程。</p>
<p>②.它会自引用表名和列名防止SQL保留字和特殊字符的冲突。</p>
<p>③.它还可以引用参数值和使用参数绑定，这有助于减少SQL注入攻击的风险。</p>
<p>④.它提供了一定程度的数据库抽象，简化了迁移到不同的数据库平台的成本。</p>
<p>它不强制使用查询生成器。事实上，如果你的查询是简单的，它是更容易和更快的直接写SQL语句。</p>
<p>注：<span style="color: #ff0000">查询生成器不能用于修改现有的查询指定为SQL语句</span>。例如，下面的代码将不能工作：</p>
<div class="phpstudycode">
<pre class="brush:php;">
$command = Yii::app()-&gt;db-&gt;createCommand('SELECT * FROM tbl_user');
// the following line will NOT append WHERE clause to the above SQL
$command-&gt;where('id=:id', array(':id'=&gt;$id));
</pre>
</div>
<p><span style="color: #0000ff">换句话说，不要混合使用普通的SQL和查询生成器。</span></p>
<p><strong>1. 制备查询生成器（Preparing Query Builder）</strong></p>
<p>Yii的查询生成器是从 CDbCommand 提供主要数据库查询类，描述数据访问对象。</p>
<p>开始使用查询生成器，我们创造了 CDbCommand 的一个新实例，</p>
<div class="phpstudycode">
<pre class="brush:php;">
$command = Yii::app()-&gt;db-&gt;createCommand();
</pre>
</div>
<p>我们使用 Yii::app()-&gt;db 来获得数据库连接，然后调用 CDbConnection::createCommand() 创建所需的命令实例。</p>
<p>请注意，将整个SQL语句放入 createcommand() ，叫做数据访问对象，我们需呀把设置它为空。这是因为我们将在下面的解释中使用查询生成器添加SQL语句的各个部分的方法。</p>
<p><strong>2. 建立数据检索查询（Building Data Retrieval Queries）</strong></p>
<p>数据检索查询是指选择SQL语句。查询生成器提供了一套方法来建立一个SELECT语句的各个部分。因为所有这些方法返回 CDbCommand 的实例，我们可以使用方法链调用他们，如图所示，在本节开头的例子。</p>
<p>select():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定查询的选择部分&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specifies the SELECT part of the query<br />
selectDistinct():&nbsp; 指定查询不重复的选择部分&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specifies the SELECT part of the query and turns on the DISTINCT flag<br />
from():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定查询的FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specifies the FROM part of the query<br />
where():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定查询的WHERE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specifies the WHERE part of the query<br />
andWhere():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 用and的方式添加到WHERE的条件中&nbsp; appends condition to the WHERE part of the query with AND operator<br />
orWhere():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 用or的方式添加到WHERE的条件中&nbsp;&nbsp;&nbsp; appends condition to the WHERE part of the query with OR operator<br />
join():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 添加一个内部联接的查询片段&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; appends an inner join query fragment<br />
leftJoin():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 追加一个左外连接查询片段&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; appends a left outer join query fragment<br />
rightJoin():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 追加一个右外部联接查询片段&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; appends a right outer join query fragment<br />
crossJoin():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 追加一个交叉连接查询片段&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; appends a cross join query fragment<br />
naturalJoin():&nbsp;&nbsp;&nbsp;&nbsp; 追加一个自然连接查询片段&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; appends a natural join query fragment<br />
group():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定查询的GROUP BY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specifies the GROUP BY part of the query<br />
having():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定查询的HAVING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specifies the HAVING part of the query<br />
order():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定查询的ORDER BY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specifies the ORDER BY part of the query<br />
limit():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定查询的LIMIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specifies the LIMIT part of the query<br />
offset():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定查询的OFFSET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; specifies the OFFSET part of the query<br />
union():&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 添加查询的UNION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; appends a UNION query fragment</p>
<p>在下面，我们将解释如何使用这些查询生成器方法。为简单起见，我们假设底层数据库是MySQL。注意：如果你使用的是其他数据库，表/列/值引用的例子可能是不同的。</p>
<p><strong>select()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function select($columns='*')
</pre>
</div>
<p>该select()方法指定一个查询的选择部分。$columns参数指定要选择的列，它可以是一个字符串，用逗号分隔列，或者一个数组的列名称。列的名称可以包含表的前缀和 / 或列别名。该方法将自动引用列名，除非一列包含一些括号（这意味着这个列是一个DB的表达式）。</p>
<p>下面是一些例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// SELECT *
select()
// SELECT `id`, `username`
select('id, username')
// SELECT `tbl_user`.`id`, `username` AS `name`
select('tbl_user.id, username as name')
// SELECT `id`, `username`
select(array('id', 'username'))
// SELECT `id`, count(*) as num
select(array('id', 'count(*) as num'))

</pre>
</div>
<p><strong>selectDistinct()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function selectDistinct($columns)
</pre>
</div>
<p>selectdistinct()方法类似于select()，除了它打开了 DISTINCT 的标志。例如，selectdistinct（'id，用户名”）会产生以下SQL：</p>
<div class="phpstudycode">
<pre class="brush:php;">
SELECT DISTINCT `id`, `username`

</pre>
</div>
<p><strong>from()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function from($tables)
</pre>
</div>
<p>from()方法指定来了一个查询的FROM部分。 $tables 参数指定表的选择。这可以是一个字符串，用逗号分隔的表的名称，或表名数组。表的名称可以包含架构前缀（例如公共。tbl_user）和/或表的别名（e.g.tbl_user U）。该方法将自动引用表的名称，除非它包含一些括号（即表是一个给定的子查询或DB的表达式）。</p>
<p>下面是一些例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// FROM `tbl_user`
from('tbl_user')
// FROM `tbl_user` `u`, `public`.`tbl_profile` `p`
from('tbl_user u, public.tbl_profile p')
// FROM `tbl_user`, `tbl_profile`
from(array('tbl_user', 'tbl_profile'))
// FROM `tbl_user`, (select * from tbl_profile) p
from(array('tbl_user', '(select * from tbl_profile) p'))

</pre>
</div>
<p><strong>where()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function where($conditions, $params=array())
</pre>
</div>
<p>where()方法指定查询的WHERE。$conditions 参数指定查询条件的同时，$params 指定参数绑定到整个查询。$conditions参数可以是一个字符串（例如id = 1）或一个数组中的格式：</p>
<p>array(operator, operand1, operand2, ...)<br />
operator 可以是以下的任何一个：</p>
<p>①.and: operands 应该使用 and 连接在一起。例如， array('and', 'id=1', 'id=2') 将产生 id=1 AND id=2 。如果一个操作数是一个数组，它将使用这里描述的相同规则转换成一个字符串。例如，array('and', 'type=1', array('or', 'id=1', 'id=2')) 将生成 type=1 AND (id=1 OR id=2)。</p>
<p>②.or: 类似 and 操作，除了operands 是使用 OR 连接的。</p>
<p>③.in: operand 1 应是一个列或 DB 表达式，而 operand 2 是代表值的范围的数组，列或 DB 表达式应在这个数组的范围内。例如，array('in', 'id', array(1,2,3)) 将生成 id IN (1,2,3)。</p>
<p>④.not in: 类似 in 操作，除了用 NOT IN 代替 IN&nbsp; 去生成SQL。</p>
<p>⑤.like: operand 1 应是一个列或 DB 表达式，而 operand 2 是代表值的范围的数组，列或 DB 表达式应在这个数组的范围内。例如，array('like', 'name', '%tester%') 会生成 name LIKE '%tester%'。当规定值的范围为一个数组时，多个 LIKE 生成SQL时会用 AND 连接。例如，array('like', 'name', array('%test%', '%sample%')) 会生成 name LIKE '%test%' AND name LIKE '%sample%'。</p>
<p>⑥.not like: 类似 like 的操作，除了用 NOT LIKE 代替 LIKE&nbsp; 去生成SQL。</p>
<p>⑦.or like: 类似 like 的操作，除了多个 like 生成 SQL 时用OR连接。</p>
<p>⑧.or not like:&nbsp; 类似 not like 的操作，除了多个 like 生成 SQL 时用OR连接。</p>
<p>下面是一些例子，使用的地方：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// WHERE id=1 or id=2
where('id=1 or id=2')
// WHERE id=:id1 or id=:id2
where('id=:id1 or id=:id2', array(':id1'=&gt;1, ':id2'=&gt;2))
// WHERE id=1 OR id=2
where(array('or', 'id=1', 'id=2'))
// WHERE id=1 AND (type=2 OR type=3)
where(array('and', 'id=1', array('or', 'type=2', 'type=3')))
// WHERE `id` IN (1, 2)
where(array('in', 'id', array(1, 2))
// WHERE `id` NOT IN (1, 2)
where(array('not in', 'id', array(1,2)))
// WHERE `name` LIKE '%Qiang%'
where(array('like', 'name', '%Qiang%'))
// WHERE `name` LIKE '%Qiang' AND `name` LIKE '%Xue'
where(array('like', 'name', array('%Qiang', '%Xue')))
// WHERE `name` LIKE '%Qiang' OR `name` LIKE '%Xue'
where(array('or like', 'name', array('%Qiang', '%Xue')))
// WHERE `name` NOT LIKE '%Qiang%'
where(array('not like', 'name', '%Qiang%'))
// WHERE `name` NOT LIKE '%Qiang%' OR `name` NOT LIKE '%Xue%'
where(array('or not like', 'name', array('%Qiang%', '%Xue%')))

</pre>
</div>
<p>请注意，当操作者含有like时，我们必须明确指定的通配符（如%和_）的模式。如果参数是从用户的输入，我们也应该使用下面的代码转义特殊字符，以防止他们被当作通配符：</p>
<div class="phpstudycode">
<pre class="brush:php;">
$keyword=$_GET['q'];
// escape % and _ characters
$keyword=strtr($keyword, array('%'=&gt;'\%', '_'=&gt;'\_'));
$command-&gt;where(array('like', 'title', '%'.$keyword.'%'));

</pre>
</div>
<p><strong>andWhere()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function andWhere($conditions, $params=array())
</pre>
</div>
<p>用and 的方式添加到WHERE的条件中。此方法的行为几乎是 where() 相同，除了它只是添加条件不能取代它。在 where() 文档中有该方法参数的详细信息。</p>
<p><strong>orWhere()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function orWhere($conditions, $params=array())
</pre>
</div>
<p>用 or 的方式添加到WHERE的条件中。此方法的行为几乎是 where() 相同，除了它只是添加条件不能取代它。在 where() 文档中有该方法参数的详细信息。</p>
<p><strong>order()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function order($columns)
</pre>
</div>
<p>order() 方法指定查询的ORDER BY部分。$columns 参数指定列进行排序，这可以是一个包含用逗号分隔列和order的方向（ASC 或 DESC）的字符串，或者一个列和order的方向的数组。列名称可以包含表前缀。该方法将自动引用列名，除非一列包含一些括号（即给出一个 DB 表达式）。</p>
<p>下面是一些例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// ORDER BY `name`, `id` DESC
order('name, id desc')
// ORDER BY `tbl_profile`.`name`, `id` DESC
order(array('tbl_profile.name', 'id desc'))

</pre>
</div>
<p><strong>limit() and offset()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function limit($limit, $offset=null)
function offset($offset)

</pre>
</div>
<p>limit()和offset()方法指定查询的 LIMIT 和 OFFSET 部分。请注意，某些DBMS不支持 LIMIT 和 OFFSET 语法。在这种情况下，查询生成器将改写整个SQL语句来模拟 LIMIT 和 OFFSET 的功能。</p>
<p>下面是一些例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// LIMIT 10  取前10条
limit(10)
// LIMIT 10 OFFSET 20  取到第21~30条
limit(10, 20)
// OFFSET 20  去掉前20条后剩下的数据
offset(20)

</pre>
</div>
<p><strong>join() and its variants</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function join($table, $conditions, $params=array())
function leftJoin($table, $conditions, $params=array())
function rightJoin($table, $conditions, $params=array())
function crossJoin($table)
function naturalJoin($table)

</pre>
</div>
<p>join()方法及其变种指定如何与其他表连接，使用内部联接，左外连接，右外部联接，交叉连接，或自然连接。 $table 参数指定要加入哪个表。表名可以包含数据库的前缀和 / 或别名。该方法将引用表名，除非它包含一个插入语，即一个DB表达式或子查询。 $conditions 参数指定连接条件。它的语法与where() 相同。$params 参数指定绑定到整个查询的参数。</p>
<p>值得注意的是，它不像其他的查询生成器方法，每次调用一个join方法都会追加到SQL中。</p>
<p>下面是一些例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// JOIN `tbl_profile` ON user_id=id
join('tbl_profile', 'user_id=id')
// LEFT JOIN `pub`.`tbl_profile` `p` ON p.user_id=id AND type=1
leftJoin('pub.tbl_profile p', 'p.user_id=id AND type=:type', array(':type'=&gt;1))

</pre>
</div>
<p><strong>group()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function group($columns)
</pre>
</div>
<p>group() 方法指定查询的GROUP BY。 $columns 参数指定列进行分组，它可以是一个用逗号分隔的列的字符串，或者一个列的数组。列名称可以包含表前缀。该方法将自动引用列名，除非一列包含一些括号（即是一个 DB 表达式）。</p>
<p>下面是一些例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// GROUP BY `name`, `id`
group('name, id')
// GROUP BY `tbl_profile`.`name`, `id`
group(array('tbl_profile.name', 'id'))

</pre>
</div>
<p><strong>having()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function having($conditions, $params=array())
</pre>
</div>
<p>having() 方法指定查询的 HAVING。它的使用方式与 where() 相同。</p>
<p>下面是一些例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// HAVING id=1 or id=2
having('id=1 or id=2')
// HAVING id=1 OR id=2
having(array('or', 'id=1', 'id=2'))

</pre>
</div>
<p><strong>union()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function union($sql)
</pre>
</div>
<p>union() 方法指定查询 UNION。它使用UNION操作附加到现有的SQL上。调用union()多次将现有的SQL附加多个表。</p>
<p>下面是一些例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// UNION (select * from tbl_profile)
union('select * from tbl_profile')

</pre>
</div>
<p><strong>执行查询（Executing Queries）</strong></p>
<p>调用上面查询生成器的方法来建立一个查询后，我们可以调用DAO方法数据访问对象执行查询。例如，我们可以调用 CDbCommand::queryRow() 获得连续的结果，或者使用 CDbCommand::queryAll() 立刻得到所有行。</p>
<p>例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
$users = Yii::app()-&gt;db-&gt;createCommand()
  -&gt;select('*')
  -&gt;from('tbl_user')
  -&gt;queryAll();

</pre>
</div>
<p><strong>检索表（Retrieving SQLs）</strong></p>
<p>除了执行查询生成器的查询，我们也可以获取相应的SQL语句。这可以通过调用 CDbCommand::getText() 获得。</p>
<div class="phpstudycode">
<pre class="brush:php;">
$sql = Yii::app()-&gt;db-&gt;createCommand()
  -&gt;select('*')
  -&gt;from('tbl_user')
  -&gt;text;
</pre>
</div>
<p>如果有任何参数必须绑定到查询的，他们可以通过 CDbCommand::params 的属性绑定。</p>
<p><strong>建立查询的替代语法（Alternative Syntax for Building Queries）</strong></p>
<p>有时，使用方法链来建立一个查询可能不是最佳的选择。Yii的查询生成器允许使用对简单象属性赋值的方式去建立查询。特别是，每个查询生成器的方法都有一个具有相同名称的属性。给属性赋值相当于调用相应的方法。例如，下面两个语句是等价的，假设$command 代表 CDbCommand 对象：</p>
<div class="phpstudycode">
<pre class="brush:php;">
$command-&gt;select(array('id', 'username'));
$command-&gt;select = array('id', 'username');
</pre>
</div>
<p>此外， CDbConnection::createCommand() 方法可以把一个数组作为参数。数组中的键值对将被用来初始化创建的 CDbCommand 实例的属性。这意味着，我们可以使用下面的代码来建立一个查询：</p>
<div class="phpstudycode">
<pre class="brush:php;">
$row = Yii::app()-&gt;db-&gt;createCommand(array(
  'select' =&gt; array('id', 'username'),
  'from' =&gt; 'tbl_user',
  'where' =&gt; 'id=:id',
  'params' =&gt; array(':id'=&gt;1),
))-&gt;queryRow();

</pre>
</div>
<p><strong>建立多个查询（Building Multiple Queries）</strong></p>
<p>一个 CDbCommand 实例可以重复使用多次建立几个查询。建立一个新的查询之前，需要调用 CDbCommand::reset() 方法以清理前面的查询。例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
$command = Yii::app()-&gt;db-&gt;createCommand();
$users = $command-&gt;select('*')-&gt;from('tbl_users')-&gt;queryAll();
$command-&gt;reset(); // clean up the previous query
$posts = $command-&gt;select('*')-&gt;from('tbl_posts')-&gt;queryAll();

</pre>
</div>
<p><strong>3. 建立数据操作查询（Building Data Manipulation Queries)</strong></p>
<p>数据操作查询是指SQL语句插入，更新和删除数据库表中的数据。对应于这些查询，查询生成器分别提供了插入，更新和删除的方法。不同于上面介绍 SELECT 的查询方法，这些数据操作查询方法将建立一个完整的SQL语句，并立即执行。</p>
<p>insert(): 将行插入到表<br />
update(): 更新表中的数据<br />
delete(): 从表中删除数据<br />
下面描述了这些数据操作查询方法。</p>
<p><strong>insert()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function insert($table, $columns)
</pre>
</div>
<p>insert()方法的建立和执行一条 INSERT SQL 语句。 $table 参数指定要插入的表，而键值对数组 $columns 指定要插入的列的值。该方法将转义表名，并且将与绑定参数结合使用。</p>
<p>下面是一个例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// build and execute the following SQL:
// INSERT INTO `tbl_user` (`name`, `email`) VALUES (:name, :email)
$command-&gt;insert('tbl_user', array(
  'name'=&gt;'Tester',
  'email'=&gt;'tester@example.com',
));

</pre>
</div>
<p><strong>update()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function update($table, $columns, $conditions='', $params=array())
</pre>
</div>
<p>update()方法的建立和执行一个SQL更新语句。 $table 参数指定要更新的表； $columns 是键值对的数组，用于指定要更新的列值的；$conditions 和 $params 像where()一样，指定 UPDATE 语句中的 WHERE 子句。该方法将转义表名，并且将与要更新的值的参数结合使用。</p>
<p>下面是一个例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// build and execute the following SQL:
// UPDATE `tbl_user` SET `name`=:name WHERE id=:id
$command-&gt;update('tbl_user', array(
  'name'=&gt;'Tester',
), 'id=:id', array(':id'=&gt;1));

</pre>
</div>
<p><strong>delete()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function delete($table, $conditions='', $params=array())
</pre>
</div>
<p>delete()方法的建立和执行一个SQL删除语句。 $table 参数指定要删除数据的表；$conditions 和$params像where()一样，指定 DELETE 语句中的 WHERE 子句。该方法将正确转义表名。</p>
<p>下面是一个例子：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// build and execute the following SQL:
// DELETE FROM `tbl_user` WHERE id=:id
$command-&gt;delete('tbl_user', 'id=:id', array(':id'=&gt;1));

</pre>
</div>
<p><strong>4. 建立架构操作查询（Building Schema Manipulation Queries）</strong></p>
<p>除了正常的数据检索和操作查询，查询生成器提供了一套用于可以操纵数据库的构建和执行SQL查询的方法。它支持以下操作：</p>
<p>createTable(): 创建一个表<br />
renameTable(): 重命名表<br />
dropTable(): 删除一个表<br />
truncateTable(): 截断一个表，即删除表中的所有数据但不删除表本身<br />
addColumn(): 给表添加列<br />
renameColumn(): 重命名表中的列<br />
alterColumn(): 改变一个表的列<br />
addForeignKey(): 添加一个外键（自1.1.6可用）<br />
dropForeignKey(): 删除一个外键（自1.1.6可用）<br />
dropColumn(): 删除一个表的列<br />
createIndex(): 创建一个索引<br />
dropIndex(): 删除一个索引</p>
<p>Info: 虽然在不同的数据库管理系统中SQL语句操作数据库的模式有很大的不同，但查询生成器试图提供一个统一的接口，用于构建这些查询。这简化了数据库迁移从一个数据库管理系统到另一个任务。</p>
<p><strong>抽象数据类型 Abstract Data Types</strong></p>
<p>查询生成器中引入了一组可以在定义表的列中使用抽象数据类型。与物理数据类型不同，物理数据类型有具体独特的DBMS而且在不同的DBMS中有很大的不同，抽象数据类型都是独立的DBMS。当抽象数据类型在定义表的列中使用时，查询生成器将其转换成相应的物理数据类型。</p>
<p>下面的抽象数据类型由查询生成器的支持。</p>
<p>pk: 一个通用的主键类型，将被转换成 int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY for MySQL;<br />
string: 字符串类型，将被转换成 varchar(255) for MySQL;<br />
text: 文本型（长字符串），将被转换成 text for MySQL;<br />
integer: 整数类型，将被转换成 int(11) for MySQL;<br />
float: 浮点数类型，将被转换成 float for MySQL;<br />
decimal: 十进制数类型，将被转换成 decimal for MySQL;<br />
datetime: datetime类型，将被转换成 datetime for MySQL;<br />
timestamp: 时间戳类型，将被转换成 timestamp for MySQL;<br />
time: 时间类型，将被转换成 time for MySQL;<br />
date: 日期类型，将被转换成 date for MySQL;<br />
binary: 二进制数据类型，将被转换成 blob for MySQL;<br />
boolean: 布尔类型，将被转换成 tinyint(1) for MySQL;<br />
money: 金钱/货币型，将被转换成 decimal(19,4) for MySQL. 自1.1.8版本开始此类型可以使用。</p>
<p><strong>createTable()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function createTable($table, $columns, $options=null)

</pre>
</div>
<p>createTable() 方法构建和执行一条创建表的SQL语句。$table 参数指定要创建的表的名称。 $columns 参数指定在新表中的列。他们必须被指定为名称类型的键值对(e.g. 'username'=&gt;'string')。 $options 参数指定应附加到生成的SQL上的任何额外的SQL片段。查询生成器将正确的引用的表名以及列名。</p>
<p>当指定一个列的定义时，可以使用如上所述的抽象数据类型。查询生成器会根据当前使用的数据库管理系统的抽象数据类型转换成相应的物理数据类型。例如，string 类型将被转换为MySQL的 varchar(255)。</p>
<p>一个列定义还可以包含非抽象数据类型或规格。他们将没有任何改变的被放置在生成的SQL中。例如，point 不是一个抽象数据类型，如果用在列定义，它会出现在生成的SQL中，而且 string NOT NULL将被转换varchar(255) NOT NULL（即只有抽象类型的字符串转换）。</p>
<p>下面是一个例子，显示了如何创建一个表：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// CREATE TABLE `tbl_user` (
//   `id` int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
//   `username` varchar(255) NOT NULL,
//   `location` point
// ) ENGINE=InnoDB
createTable('tbl_user', array(
  'id' =&gt; 'pk',
  'username' =&gt; 'string NOT NULL',
  'location' =&gt; 'point',
), 'ENGINE=InnoDB')

</pre>
</div>
<p><strong>renameTable()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function renameTable($table, $newName)
</pre>
</div>
<p>renameTable() 方法创建和执行一条重命名表名的SQL语句。 $table 参数指定要重命名的表的名称。 $newName 参数指定表的新名称。查询生成器将正确引用的表名。</p>
<p>下面是一个示例，演示了如何重命名表：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// RENAME TABLE `tbl_users` TO `tbl_user`
renameTable('tbl_users', 'tbl_user')

</pre>
</div>
<p><strong>dropTable()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function dropTable($table)
</pre>
</div>
<p>dropTable() 方法创建和执行一条删除表的SQL语句。在$table 参数指定要删除的表的名称。查询生成器会正确地引用的表名。</p>
<p>下面是一个示例展示如何删除一个表：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// DROP TABLE `tbl_user`
dropTable('tbl_user')

</pre>
</div>
<p><strong>truncateTable()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function truncateTable($table)
</pre>
</div>
<p>truncateTable() 方法建立和执行一条清空表数据的SQL语句。 $table 参数指定清空的表名。查询生成器会正确地引用的表名。</p>
<p>下面是一个示例显示如何清空表：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// TRUNCATE TABLE `tbl_user`
truncateTable('tbl_user')

</pre>
</div>
<p><strong>addColumn()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function addColumn($table, $column, $type)
</pre>
</div>
<p>addColumn() 方法创建并执行一条添加一个表的新列的SQL语句。 $table 参数指定新列将被添加到的表的名称。 $column 参数指定新列的名称。 $type 指定新列的定义。列定义中可以包含抽象数据类型，如 "createTable"小节中的描述。查询生成器将正确的引用的表名以及列名。</p>
<p>下面是一个示例，演示如何添加一个表的列：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// ALTER TABLE `tbl_user` ADD `email` varchar(255) NOT NULL
addColumn('tbl_user', 'email', 'string NOT NULL')

</pre>
</div>
<p><strong>dropColumn()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function dropColumn($table, $column)
</pre>
</div>
<p>dropColumn() 方法创建和执行一条删除表列的SQL语句。 $table 参数指定要被删除的列所属的表名。 $column 参数指定要被删除的列名。查询生成器将正确地引用的表名以及列名。</p>
<p>下面是一个示例展示如何删除一个表列：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// ALTER TABLE `tbl_user` DROP COLUMN `location`
dropColumn('tbl_user', 'location')

</pre>
</div>
<p><strong>renameColumn()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function renameColumn($table, $name, $newName)
</pre>
</div>
<p>renameColumn() 方法创建和执行一条重命名列的SQL语句。 $table 参数指定要重命名的列所属的表的名称。 $name 参数指定的旧列名。 $newName 指定新的列名。查询生成器将正确地引用的表名以及列名。</p>
<p>下面是一个示例，展示了如何重命名表列：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// ALTER TABLE `tbl_users` CHANGE `name` `username` varchar(255) NOT NULL
renameColumn('tbl_user', 'name', 'username')

</pre>
</div>
<p><strong>alterColumn()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function alterColumn($table, $column, $type)
</pre>
</div>
<p>alterColumn() 方法创建和执行一条修改表列的SQL语句。 $table 参数指定要被改变的列所属的表的名称。 $column 参数指定被改变的列的名称。$type 指定列的新定义。列定义中可以包含抽象数据类型，如 "createTable"小节中的描述。查询生成器将正确的引用的表名以及列名。</p>
<p>下面是一个示例，展示了如何更改一个表列：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// ALTER TABLE `tbl_user` CHANGE `username` `username` varchar(255) NOT NULL
alterColumn('tbl_user', 'username', 'string NOT NULL')

</pre>
</div>
<p><strong>addForeignKey()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function addForeignKey($name, $table, $columns,$refTable, $refColumns, $delete=null, $update=null)

</pre>
</div>
<p>addForeignKey() 方法创建和执行一条添加一个外键约束SQL语句。 $name 参数指定外键的名称。 $table 和 $columns 参数指定外键的表名和列名。如果有多个列，他们应该用逗号字符分隔。 $refTable 和 $refColumns 参数指定表名和列名的外键引用。 $delete 和 $update 参数指定 SQL语句中的 ON DELETE 和ON UPDATE选项。大多数的DBMS都支持这些选项：RESTRICT, CASCADE, NO ACTION, SET DEFAULT, SET NULL. 。查询生成器会正确地引用表名，索引名和列名。</p>
<p>下面是一个示例，演示如何添加一个外键约束：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// ALTER TABLE `tbl_profile` ADD CONSTRAINT `fk_profile_user_id`
// FOREIGN KEY (`user_id`) REFERENCES `tbl_user` (`id`)
// ON DELETE CASCADE ON UPDATE CASCADE
addForeignKey('fk_profile_user_id', 'tbl_profile', 'user_id', 'tbl_user', 'id', 'CASCADE', 'CASCADE')

</pre>
</div>
<p><strong>dropForeignKey()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function dropForeignKey($name, $table)
</pre>
</div>
<p>dropForeignKey() 方法创建和执行一条删除一个外键约束的SQL语句。 $name 参数指定的要删除的外键约束的名称。 $table 参数指定外键所属的表的名称。查询生成器将正确地引用的表名以及约束名称。</p>
<p>下面是一个示例，显示了如何删除外键约束：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// ALTER TABLE `tbl_profile` DROP FOREIGN KEY `fk_profile_user_id`
dropForeignKey('fk_profile_user_id', 'tbl_profile')

</pre>
</div>
<p><strong>createIndex()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function createIndex($name, $table, $column, $unique=false)
</pre>
</div>
<p>createIndex() 方法构建和执行一条创建索引的SQL语句。 $name 参数指定要创建的索引的名称。$table 参数指定索引所属的表的名称。$column 参数指定要索引的列的名称。 $unique 参数指定是否创建一个唯一索引。如果索引由多个列，则必须用逗号将它们隔开。查询生成器会正确地引用表名，索引名和列名。</p>
<p>下面是一个示例，显示了如何创建索引：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// CREATE INDEX `idx_username` ON `tbl_user` (`username`)
createIndex('idx_username', 'tbl_user', 'username')

</pre>
</div>
<p><strong>dropIndex()</strong></p>
<div class="phpstudycode">
<pre class="brush:php;">
function dropIndex($name, $table)
</pre>
</div>
<p>dropIndex() 方法创建和执行一条删除索引的SQL语句。 $name 参数指定要删除的索引的名称。$table 参数指定索引所属的表的名称。查询生成器将正确地引用的表名以及索引名称。</p>
<p>下面是一个示例，显示了如何删除索引：</p>
<div class="phpstudycode">
<pre class="brush:php;">
// DROP INDEX `idx_username` ON `tbl_user`
dropIndex('idx_username', 'tbl_user')

</pre>
</div>
<p>希望本文所述对大家yii学习有所帮助。</p>
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/87928.html'>浅谈InnoDB隔离模式的使用对MySQL性能造成的影响</a><a>下一篇</a><a href='/php/biji/87930.html'>HTML5的表单(绝对特别强大的功能)使用示例</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>