<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>asp.net导出excel数据的常见方法汇总_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="本文实例讲述了asp.net中一些常用的excel数据导出方法，同时也介绍了在数据导入或导出时可能碰到的一些问题总结，分享给大家供大家参考。希望文章对你会有所帮助。具体实现方法" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">asp.net导出excel数据的常见方法汇总</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>本文实例讲述了asp.net中一些常用的excel数据导出方法，同时也介绍了在数据导入或导出时可能碰到的一些问题总结，分享给大家供大家参考。希望文章对你会有所帮助。具体实现方法</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>本文实例讲述了asp.net中一些常用的excel数据导出方法，同时也介绍了在数据导入或导出时可能碰到的一些问题总结，分享给大家供大家参考。希望文章对你会有所帮助。具体实现方法如下：</p>
<p><strong>1、由dataset生成</strong></p>
<p><div class="codetitle"><span><a style="CURSOR: pointer" data="70161" class="copybut" id="copybut70161" onclick="doCopy('code70161')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code70161">public void CreateExcel(DataSet ds,string typeid,string FileName)&nbsp; <br />
&nbsp; { <br />
&nbsp;&nbsp; HttpResponse resp; <br />
&nbsp;&nbsp; resp = Page.Response; <br />
&nbsp;&nbsp; resp.ContentEncoding = System.Text.Encoding.GetEncoding("GB2312"); <br />
&nbsp;&nbsp; resp.AppendHeader("Content-Disposition", "attachment;filename=" + FileName);&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; string colHeaders= "", ls_item=""; <br />
&nbsp;&nbsp; int i=0; <br />
&nbsp;<br />
&nbsp;&nbsp; //定义表对象与行对像，同时用DataSet对其值进行初始化 <br />
&nbsp;&nbsp; DataTable dt=ds.Tables[0]; <br />
&nbsp;&nbsp; DataRow[] myRow=dt.Select("");&nbsp; <br />
&nbsp;&nbsp; // typeid=="1"时导出为EXCEL格式文件；typeid=="2"时导出为XML格式文件 <br />
&nbsp;&nbsp; if(typeid=="1") <br />
&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp; //取得数据表各列标题，各标题之间以t分割，最后一个列标题后加回车符 <br />
&nbsp;&nbsp;&nbsp; for(i=0;i&nbsp;&nbsp;&nbsp;&nbsp; colHeaders+=dt.Columns[i].Caption.ToString()+"t"; <br />
&nbsp;&nbsp;&nbsp; colHeaders +=dt.Columns[i].Caption.ToString() +"n";&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; //向HTTP输出流中写入取得的数据信息 <br />
&nbsp;&nbsp;&nbsp; resp.Write(colHeaders);&nbsp; <br />
&nbsp;&nbsp;&nbsp; //逐行处理数据&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp; foreach(DataRow row in myRow) <br />
&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp;&nbsp; //在当前行中，逐列获得数据，数据之间以t分割，结束时加回车符n <br />
&nbsp;&nbsp;&nbsp;&nbsp; for(i=0;i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ls_item +=row[i].ToString() + "t";&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp;&nbsp; ls_item += row[i].ToString() +"n"; <br />
&nbsp;&nbsp;&nbsp;&nbsp; //当前行数据写入HTTP输出流，并且置空ls_item以便下行数据&nbsp;&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp;&nbsp; resp.Write(ls_item); <br />
&nbsp;&nbsp;&nbsp;&nbsp; ls_item=""; <br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp; } <br />
&nbsp;&nbsp; else <br />
&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp; if(typeid=="2") <br />
&nbsp;&nbsp;&nbsp; {&nbsp; <br />
&nbsp;&nbsp;&nbsp;&nbsp; //从DataSet中直接导出XML数据并且写到HTTP输出流中 <br />
&nbsp;&nbsp;&nbsp;&nbsp; resp.Write(ds.GetXml()); <br />
&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; } <br />
&nbsp;&nbsp; //写缓冲区中的数据到HTTP头文件中 <br />
&nbsp;&nbsp; resp.End(); <br />
}</div></p>
<p><strong>2、由datagrid生成</strong></p>
<p><div class="codetitle"><span><a style="CURSOR: pointer" data="61875" class="copybut" id="copybut61875" onclick="doCopy('code61875')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code61875">public void ToExcel(System.Web.UI.Control ctl)&nbsp;&nbsp; <br />
&nbsp; { <br />
&nbsp;&nbsp; HttpContext.Current.Response.AppendHeader("Content-Disposition","attachment;filename=Excel.xls"); <br />
&nbsp;&nbsp; HttpContext.Current.Response.Charset ="UTF-8";&nbsp;&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; HttpContext.Current.Response.ContentEncoding =System.Text.Encoding.Default; <br />
&nbsp;&nbsp; HttpContext.Current.Response.ContentType ="application/ms-excel";//image/JPEG;text/HTML;image/GIF;vnd.ms-excel/msword <br />
&nbsp;&nbsp; ctl.Page.EnableViewState =false;&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; System.IO.StringWriter&nbsp; tw = new System.IO.StringWriter() ; <br />
&nbsp;&nbsp; System.Web.UI.HtmlTextWriter hw = new System.Web.UI.HtmlTextWriter (tw); <br />
&nbsp;&nbsp; ctl.RenderControl(hw); <br />
&nbsp;&nbsp; HttpContext.Current.Response.Write(tw.ToString()); <br />
&nbsp;&nbsp; HttpContext.Current.Response.End(); <br />
&nbsp; }</div><br />
&nbsp;<br />
用法：ToExcel(datagrid1);&nbsp;<br />
&nbsp;<br />
<strong>3、这个用dataview</strong></p>
<p><div class="codetitle"><span><a style="CURSOR: pointer" data="39848" class="copybut" id="copybut39848" onclick="doCopy('code39848')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code39848">public void OutputExcel(DataView dv,string str) <br />
{ <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; // TODO: 在此处添加构造函数逻辑 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //dv为要输出到Excel的数据，str为标题名称 <br />
&nbsp;&nbsp; GC.Collect(); <br />
&nbsp;&nbsp; Application excel;// = new Application(); <br />
&nbsp;&nbsp; int rowIndex=4; <br />
&nbsp;&nbsp; int colIndex=1; <br />
&nbsp;<br />
&nbsp;&nbsp; _Workbook xBk; <br />
&nbsp;&nbsp; _Worksheet xSt; <br />
&nbsp;<br />
&nbsp;&nbsp; excel= new ApplicationClass(); <br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; xBk = excel.Workbooks.Add(true); <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; xSt = (_Worksheet)xBk.ActiveSheet; <br />
&nbsp;<br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //取得标题 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; foreach(DataColumn col in dv.Table.Columns) <br />
&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp; colIndex++; <br />
&nbsp;&nbsp;&nbsp; excel.Cells[4,colIndex] = col.ColumnName; <br />
&nbsp;&nbsp;&nbsp; xSt.get_Range(excel.Cells[4,colIndex],excel.Cells[4,colIndex]).HorizontalAlignment = XlVAlign.xlVAlignCenter;//设置标题格式为居中对齐 <br />
&nbsp;&nbsp; } <br />
&nbsp;<br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //取得表格中的数据 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; foreach(DataRowView row in dv) <br />
&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp; rowIndex ++; <br />
&nbsp;&nbsp;&nbsp; colIndex = 1; <br />
&nbsp;&nbsp;&nbsp; foreach(DataColumn col in dv.Table.Columns) <br />
&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp;&nbsp; colIndex ++; <br />
&nbsp;&nbsp;&nbsp;&nbsp; if(col.DataType == System.Type.GetType("System.DateTime")) <br />
&nbsp;&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excel.Cells[rowIndex,colIndex] = (Convert.ToDateTime(row[col.ColumnName].ToString())).ToString("yyyy-MM-dd"); <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xSt.get_Range(excel.Cells[rowIndex,colIndex],excel.Cells[rowIndex,colIndex]).HorizontalAlignment = XlVAlign.xlVAlignCenter;//设置日期型的字段格式为居中对齐 <br />
&nbsp;&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp;&nbsp; else <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(col.DataType == System.Type.GetType("System.String")) <br />
&nbsp;&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excel.Cells[rowIndex,colIndex] = "'"+row[col.ColumnName].ToString(); <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xSt.get_Range(excel.Cells[rowIndex,colIndex],excel.Cells[rowIndex,colIndex]).HorizontalAlignment = XlVAlign.xlVAlignCenter;//设置字符型的字段格式为居中对齐 <br />
&nbsp;&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp;&nbsp; else <br />
&nbsp;&nbsp;&nbsp;&nbsp; { <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excel.Cells[rowIndex,colIndex] = row[col.ColumnName].ToString(); <br />
&nbsp;&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp;&nbsp; } <br />
&nbsp;&nbsp; } <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //加载一个合计行 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; int rowSum = rowIndex + 1; <br />
&nbsp;&nbsp; int colSum = 2; <br />
&nbsp;&nbsp; excel.Cells[rowSum,2] = "合计"; <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[rowSum,2],excel.Cells[rowSum,2]).HorizontalAlignment = XlHAlign.xlHAlignCenter; <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //设置选中的部分的颜色 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[rowSum,colSum],excel.Cells[rowSum,colIndex]).Select(); <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[rowSum,colSum],excel.Cells[rowSum,colIndex]).Interior.ColorIndex = 19;//设置为浅黄色，共计有56种 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //取得整个报表的标题 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; excel.Cells[2,2] = str; <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //设置整个报表的标题格式 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[2,2],excel.Cells[2,2]).Font.Bold = true; <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[2,2],excel.Cells[2,2]).Font.Size = 22; <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //设置报表表格为最适应宽度 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[4,2],excel.Cells[rowSum,colIndex]).Select(); <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[4,2],excel.Cells[rowSum,colIndex]).Columns.AutoFit(); <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //设置整个报表的标题为跨列居中 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[2,2],excel.Cells[2,colIndex]).Select(); <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[2,2],excel.Cells[2,colIndex]).HorizontalAlignment = XlHAlign.xlHAlignCenterAcrossSelection; <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //绘制边框 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[4,2],excel.Cells[rowSum,colIndex]).Borders.LineStyle = 1; <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[4,2],excel.Cells[rowSum,2]).Borders[XlBordersIndex.xlEdgeLeft].Weight = XlBorderWeight.xlThick;//设置左边线加粗 <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[4,2],excel.Cells[4,colIndex]).Borders[XlBordersIndex.xlEdgeTop].Weight = XlBorderWeight.xlThick;//设置上边线加粗 <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[4,colIndex],excel.Cells[rowSum,colIndex]).Borders[XlBordersIndex.xlEdgeRight].Weight = XlBorderWeight.xlThick;//设置右边线加粗 <br />
&nbsp;&nbsp; xSt.get_Range(excel.Cells[rowSum,2],excel.Cells[rowSum,colIndex]).Borders[XlBordersIndex.xlEdgeBottom].Weight = XlBorderWeight.xlThick;//设置下边线加粗 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; //显示效果 <br />
&nbsp;&nbsp; // <br />
&nbsp;&nbsp; excel.Visible=true; <br />
&nbsp;<br />
&nbsp;&nbsp; //xSt.Export(Server.MapPath(".")+"\"+this.xlfile.Text+".xls",SheetExportActionEnum.ssExportActionNone,Microsoft.Office.Interop.OWC.SheetExportFormat.ssExportHTML);<br />
&nbsp;&nbsp; xBk.SaveCopyAs(Server.MapPath(".")+"\"+this.xlfile.Text+".xls"); <br />
&nbsp;<br />
&nbsp;&nbsp; ds = null; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xBk.Close(false, null,null); <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excel.Quit(); <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Runtime.InteropServices.Marshal.ReleaseComObject(xBk); <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.Runtime.InteropServices.Marshal.ReleaseComObject(excel); <br />
&nbsp;&nbsp;&nbsp; System.Runtime.InteropServices.Marshal.ReleaseComObject(xSt); <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xBk = null; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; excel = null; <br />
&nbsp;&nbsp; xSt = null; <br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; GC.Collect(); <br />
&nbsp;&nbsp; string path = Server.MapPath(this.xlfile.Text+".xls"); <br />
&nbsp;<br />
&nbsp;&nbsp; System.IO.FileInfo file = new System.IO.FileInfo(path); <br />
&nbsp;&nbsp; Response.Clear(); <br />
&nbsp;&nbsp; Response.Charset="GB2312"; <br />
&nbsp;&nbsp; Response.ContentEncoding=System.Text.Encoding.UTF8; <br />
&nbsp;&nbsp; // 添加头信息，为"文件下载/另存为"对话框指定默认文件名 <br />
&nbsp;&nbsp; Response.AddHeader("Content-Disposition", "attachment; filename=" + Server.UrlEncode(file.Name)); <br />
&nbsp;&nbsp; // 添加头信息，指定文件大小，让浏览器能够显示下载进度 <br />
&nbsp;&nbsp; Response.AddHeader("Content-Length", file.Length.ToString()); <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; // 指定返回的是一个不能被客户端读取的流，必须被下载 <br />
&nbsp;&nbsp; Response.ContentType = "application/ms-excel"; <br />
&nbsp;&nbsp;&nbsp; <br />
&nbsp;&nbsp; // 把文件流发送到客户端 <br />
&nbsp;&nbsp; Response.WriteFile(file.FullName); <br />
&nbsp;&nbsp; // 停止页面的执行 <br />
&nbsp;&nbsp; <br />
&nbsp;&nbsp; Response.End(); <br />
}</div>&nbsp;<br />
&nbsp;<br />
<strong>导入、导出EXCEL中的一些问题汇总</strong></p>
<p><strong>一、在项目中的添加引用：<br />
</strong>　　右击项目资源管理器的引用--&gt;添加引用--&gt;选择.NET选项卡--&gt;选择Microsoft.Office.Interop.Excel--&gt;确定；<br />
&nbsp;<br />
　　在选择时注意一下.NET组件的版本号，本例的12.0.0.0是Office2007的版本：<br />
<strong>二、在项目中使用Microsoft.Office.Interop.Excel:<br />
</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 如果想使用Microsoft.Office.Interop.Excel,首先需要在项目中引用命名空间：<br />
　　using Microsoft.Office.Interop.Excel;<br />
<strong>三、建立Excel.Application相关对象<br />
</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <div class="codetitle"><span><a style="CURSOR: pointer" data="79369" class="copybut" id="copybut79369" onclick="doCopy('code79369')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code79369">//建立Application对象<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Microsoft.Office.Interop.Excel.Application myExcel = new Application();<br />
　　//建立Workbooks对象<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Workbooks myBooks = myExcel.Application.Workbooks;<br />
&nbsp;&nbsp;&nbsp;&nbsp; //建立一个System.Reflection.Missing的object对象<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object oMissing = System.Reflection.Missing.Value;</div><br />
<strong>四、打开或新建Excel的book文件<br />
</strong>　　<div class="codetitle"><span><a style="CURSOR: pointer" data="60806" class="copybut" id="copybut60806" onclick="doCopy('code60806')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code60806">//打开Excel文件，注意里的“ExccelFilePath”为Excel文件在服务器上的物理地址，包括文件名<br />
　　Workbook myBook = myBooks.Open(ExccelFilePath,oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, oMissing, oMissing);<br />
&nbsp;&nbsp;&nbsp;&nbsp; //新建Workseet对象,，此处为要操作的工作表 ，当前要操作的工作表的获取方法有两种：使用工作表的索引值或使用工作表的名称，名称默认为：“sheet1”/“Sheet2”等<br />
&nbsp;&nbsp;&nbsp;&nbsp; Worksheet mySheet = (Worksheet)myBook.Worksheets[1];<br />
&nbsp;&nbsp;&nbsp; //如果是新建EXCEL工作簿，需要　设置如下两行内容，以保证工作簿中有一个工作表，<br />
&nbsp;&nbsp;&nbsp; Workbook workbook1 = excel1.Workbooks.Add(true);<br />
&nbsp;&nbsp;&nbsp; Worksheet mySheet= (Worksheet)workbook1.Worksheets["sheet1"];<br />
&nbsp;&nbsp;&nbsp; //设置EXCEL对象是否显示界面，默认为false不显示界面<br />
&nbsp;&nbsp;&nbsp; myExcel.Visble=true;</div><br />
</p>
<p><strong>五、一些比较重要的针对Excel的操作<br />
</strong>&nbsp;&nbsp;&nbsp;&nbsp; 1、获取Range对象<br />
　　　①、获取一个单元格的Range对象：<br />
　　　&nbsp; <div class="codetitle"><span><a style="CURSOR: pointer" data="43053" class="copybut" id="copybut43053" onclick="doCopy('code43053')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code43053">//选择第一行、第一列的单元的单元格为Range对象<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Range r = (Excel.Range)mySheet.Cells[1, 1];<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //选择多个连续的单元格为Range对象<br />
　　　Range r=(Excel.Range)Range.get_Range("A1:F3")</div><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ②、给单元格赋值或取出单元格的值:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <div class="codetitle"><span><a style="CURSOR: pointer" data="69756" class="copybut" id="copybut69756" onclick="doCopy('code69756')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code69756">//已选择了Range对象的赋值：<br />
　　　r.Text="中国";<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //未选择Range对象的赋值:<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mySheet.Cells[1,2].Text="中国";<br />
&nbsp;&nbsp;&nbsp;&nbsp; //已选择了Range对象的取值：<br />
　　　String strValue= r.Text;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //未选择Range对象的取值:<br />
&nbsp;&nbsp; 　String&nbsp; strValue=&nbsp; mySheet.Cells[1,2].Text;</div><br />
&nbsp;&nbsp;&nbsp;&nbsp; ③、给单元格设置边框<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <div class="codetitle"><span><a style="CURSOR: pointer" data="89646" class="copybut" id="copybut89646" onclick="doCopy('code89646')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code89646">mySheet.Cells[2, 1].BorderAround(XlLineStyle.xlContinuous, XlBorderWeight.xlThin, XlColorIndex.xlColorIndexAutomatic, null);//画线</div><br />
&nbsp;&nbsp;&nbsp;&nbsp; ④、合并单元格<br />
　　<div class="codetitle"><span><a style="CURSOR: pointer" data="56534" class="copybut" id="copybut56534" onclick="doCopy('code56534')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code56534">//合并单元格前先要将要合并的单元格选择为Range对象<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Range r=Range.get_Range("A1:F3")；<br />
　 //然后现设置合并单元格<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; r.MergeCells = true;</div><br />
&nbsp;&nbsp;&nbsp;&nbsp; ⑤、设置单元格的字体、字号、背景色等属性<br />
　　　&nbsp; <div class="codetitle"><span><a style="CURSOR: pointer" data="55870" class="copybut" id="copybut55870" onclick="doCopy('code55870')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code55870">mySheet.Cells[1, 1].Font.Name = "黑体";<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mySheet.Cells[1, 1].Font.Size = 20;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mySheet.Rows["1:1"].RowHeight = 40;<br />
　　　　mySheet.Cells[1, 1].Interior.Color = Color.FromArgb(224, 224, 224);//设置颜色</div><br />
&nbsp;&nbsp; ⑥、删除一行：<br />
　　　<div class="codetitle"><span><a style="CURSOR: pointer" data="31303" class="copybut" id="copybut31303" onclick="doCopy('code31303')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code31303">//首先获取要删除的行的Range<br />
　　　　Microsoft.Office.Interop.Excel.Range range = (Microsoft.Office.Interop.Excel.Range)mySheet.Rows[sendedRow[1], Type.Missing];<br />
　　　//注意删除行后删除后的行号被下面的行替换，如果逐行删除，请先从最大的行号往最小的行号删除<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; range.Delete(Microsoft.Office.Interop.Excel.XlDeleteShiftDirection.xlShiftUp);</div><br />
　　⑦、获取有数据的行数<br />
　　　 <div class="codetitle"><span><a style="CURSOR: pointer" data="5004" class="copybut" id="copybut5004" onclick="doCopy('code5004')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code5004">int rowsint = mySheet.UsedRange.Cells.Rows.Count;</div><br />
<strong>六、EXCEL文件的保存与退出</strong></p>
<p>1、EXCEL的保存与退出<br />
&nbsp;&nbsp; <div class="codetitle"><span><a style="CURSOR: pointer" data="57343" class="copybut" id="copybut57343" onclick="doCopy('code57343')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code57343">myBook.Save();<br />
&nbsp;&nbsp; myBooks.Close();<br />
&nbsp;&nbsp; myExcel.Quit();</div></p>
<p>2、EXCEL指定文件保存<br />
　　　<div class="codetitle"><span><a style="CURSOR: pointer" data="327" class="copybut" id="copybut327" onclick="doCopy('code327')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code327">myBook.Close(true, FilePath +_file_Name, null);</div><br />
<strong>七、释放EXCLE对象的资源与结束EXCEL&nbsp; 进程<br />
</strong>　　　关于这方面内容有好多网友都在讲多种方法，经过本人实践，以下方面才能真正做到结束EXCEL的任务进程：<br />
1、将所有以上对EXCEL的操作放到一个方法中，<br />
2、在操作EXCEL后，即时将不使用对象一一释放并赋null值：<br />
　　<div class="codetitle"><span><a style="CURSOR: pointer" data="24490" class="copybut" id="copybut24490" onclick="doCopy('code24490')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code24490">System.Runtime.InteropServices.Marshal.ReleaseComObject(mysheet);<br />
　　mysheet=null;<br />
　　System.Runtime.InteropServices.Marshal.ReleaseComObject(myBook);<br />
　　myBook=null;<br />
　　System.Runtime.InteropServices.Marshal.ReleaseComObject(myBooks);<br />
　　myBooks=null;<br />
　　System.Runtime.InteropServices.Marshal.ReleaseComObject(myExcel);<br />
　　myExcel=null;</div><br />
3、再新建一个方法，并以该方法中执行上面新建的操作EXCEL方法，并在执行完操作EXCEL方法的后面添加GC.Collect()：<br />
<div class="codetitle"><span><a style="CURSOR: pointer" data="52002" class="copybut" id="copybut52002" onclick="doCopy('code52002')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code52002">//下面方法中OutPutEXCEL()方法是输出EXCEL文件的对EXCEL　操作的方法<br />
private void killExcel()<br />
{<br />
　　outPutEXCEL();<br />
　　GC.Collect();<br />
　　GC.WaitForPendingFinalizers();<br />
}</div><br />
　　　　好多网友都在介绍使用GC.Collect()释放EXCEL占用的资源来结束EXCEL进行，如果将“GC.Collect();”与操作EXCEL的业务写在一个程序块中，“GC”是永远不能结束EXCEL进程的，在WEB应用程序中，这种现象是很可怕的事情。原因是GC不会清理本程序块中的垃圾内存的。</p>
<p>4、在业务事件中调用killEXCEL()方法：<br />
<div class="codetitle"><span><a style="CURSOR: pointer" data="16349" class="copybut" id="copybut16349" onclick="doCopy('code16349')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code16349">protected void LinkButton3_Click(object sender, EventArgs e)<br />
{<br />
　　//导出EXCEL<br />
　　killExcel();<br />
}</div><br />
八、一些权限的基本设置：</p>
<p>使用以上方法在开发环境中调试程序没有一点问题，等发布到服务器上后，程序还是不能正常运行，需要进行如下的权限设置：</p>
<p><strong>.NET导出Excel遇到的80070005错误的解决方法: </strong></p>
<p>检索 COM 类工厂中 CLSID 为 {00024500-0000-0000-C000-000000000046}的组件时失败，原因是出现以下错误: 80070005基本上.net导出excel文件，都需要如此配置一下，不配置有的时候没错，而配置后基本应该不会出错。 <br />
具体配置方法如下:&nbsp; <br />
① 在服务器上安装office的Excel软件. <br />
② 在"开始"-&gt;"运行"中输入dcomcnfg.exe启动"组件服务"&nbsp; <br />
③ 依次双击"组件服务"-&gt;"计算机"-&gt;"我的电脑"-&gt;"DCOM配置" <br />
④ 在"DCOM配置"中找到"Microsoft&nbsp; Excel 应用程序",在它上面点击右键,然后点击"属性",弹出"Microsoft Excel 应用程序属性"对话框&nbsp; <br />
⑤ 点击"标识"标签,选择"交互式用户"&nbsp; <br />
⑥ 点击"安全"标签,在"启动和激活权限"上点击"自定义",然后点击对应的"编辑"按钮,在弹出的"安全性"对话框中填加一个"NETWORK&nbsp; SERVICE"用户(注意要选择本计算机名),并给它赋予"本地启动"和"本地激活"权限.&nbsp; <br />
⑦ 依然是"安全"标签,在"访问权限"上点击"自定义",然后点击"编辑",在弹出的"安全性"对话框中也填加一个"NETWORK&nbsp; SERVICE"用户,然后赋予"本地访问"权限.&nbsp; <br />
⑧ 如果交互式用户设置后出现错误8000401a，可取消交互式用户，指定为administratr，可暂时解决此问题。进一步的解决方式还有待探讨。&nbsp; <br />
⑨ 采用第8点的设置后，打开Excel可能会出现“无法使用对象引用或链接”，并且不能进行单元格粘贴。原因不明，取消设置后即可消失。</p>
<p>希望本文所述对大家的asp.net程序设计有所帮助。</p>
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/103097.html'>Win10开始菜单遭用户吐槽：动态磁贴功能不像Win8.1那样</a><a>下一篇</a><a href='/php/biji/103099.html'>Win7系统中键盘ESC键的4种功能介绍</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>