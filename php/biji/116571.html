<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>Python搞定pandas入门实例_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了Python搞定pandas入门实例，具有一定的参考价值，可以用来参考一下。<br />
<br />
对python这个高级语言对此感兴趣的朋友，看看idc笔记做的技术笔记！<br />
习惯上,我" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">Python搞定pandas入门实例</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了Python搞定pandas入门实例，具有一定的参考价值，可以用来参考一下。<br />
<br />
对python这个高级语言对此感兴趣的朋友，看看idc笔记做的技术笔记！<br />
习惯上,我</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了Python搞定pandas入门实例，具有一定的参考价值，可以用来参考一下。</p>

对python这个高级语言对此感兴趣的朋友，看看idc笔记做的技术笔记！
<p>习惯上,我们做以下导入</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [1]: import pandas as pd
In [2]: import numpy as np
In [3]: import matplotlib.pyplot as plt

# End www_512pic_com
</code></pre>
<h3>创建对象</h3>
<p>使用传递的值列表序列创建序列, 让pandas创建默认整数索引</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [4]: s = pd.Series([1,3,5,np.nan,6,8])
In [5]: s
Out[5]: 
0     1
1     3
2     5
3   NaN
4     6
5     8
dtype: float64

# End www_512pic_com
</code></pre>
<p>使用传递的numpy数组创建数据帧,并使用日期索引和标记列.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [6]: dates = pd.date_range(&#39;20130101&#39;,periods=6)
In [7]: dates
Out[7]: [2013-01-01, ..., 2013-01-06]
Length: 6, Freq: D, Timezone: None
 
In [8]: df = pd.DataFrame(np.random.randn(6,4),index=dates,columns=list(&#39;ABCD&#39;))
In [9]: df
Out[9]: 
                   A         B         C         D
2013-01-01  0.469112 -0.282863 -1.509059 -1.135632
2013-01-02  1.212112 -0.173215  0.119209 -1.044236
2013-01-03 -0.861849 -2.104569 -0.494929  1.071804
2013-01-04  0.721555 -0.706771 -1.039575  0.271860
2013-01-05 -0.424972  0.567020  0.276232 -1.087401
2013-01-06 -0.673690  0.113648 -1.478427  0.524988

# End www_512pic_com
</code></pre>
<p>使用传递的可转换序列的字典对象创建数据帧.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [10]: df2 = pd.DataFrame({ &#39;A&#39; : 1.,
   ....:                      &#39;B&#39; : pd.Timestamp(&#39;20130102&#39;),
   ....:                      &#39;C&#39; : pd.Series(1,index=list(range(4)),dtype=&#39;float32&#39;),
   ....:                      &#39;D&#39; : np.array([3] * 4,dtype=&#39;int32&#39;),
   ....:                      &#39;E&#39; : pd.Categorical([&quot;test&quot;,&quot;train&quot;,&quot;test&quot;,&quot;train&quot;]),
   ....:                      &#39;F&#39; : &#39;foo&#39; })
   ....: 
In [11]: df2
Out[11]: 
   A          B  C  D      E    F
0  1 2013-01-02  1  3   test  foo
1  1 2013-01-02  1  3  train  foo
2  1 2013-01-02  1  3   test  foo
3  1 2013-01-02  1  3  train  foo

# End www_512pic_com
</code></pre>
<p>所有明确类型</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [12]: df2.dtypes
Out[12]: 
A           float64
B    datetime64[ns]
C           float32
D             int32
E          category
F            object
dtype: object

# End www_512pic_com
</code></pre>
<p>如果你这个正在使用IPython，标签补全列名（以及公共属性）将自动启用。这里是将要完成的属性的子集：</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [13]: df2.
df2.A                  df2.boxplot
df2.abs                df2.C
df2.add                df2.clip
df2.add_prefix         df2.clip_lower
df2.add_suffix         df2.clip_upper
df2.align              df2.columns
df2.all                df2.combine
df2.any                df2.combineAdd
df2.append             df2.combine_first
df2.apply              df2.combineMult
df2.applymap           df2.compound
df2.as_blocks          df2.consolidate
df2.asfreq             df2.convert_objects
df2.as_matrix          df2.copy
df2.astype             df2.corr
df2.at                 df2.corrwith
df2.at_time            df2.count
df2.axes               df2.cov
df2.B                  df2.cummax
df2.between_time       df2.cummin
df2.bfill              df2.cumprod
df2.blocks             df2.cumsum
df2.bool               df2.D

# End www_512pic_com
</code></pre>
<p>如你所见, 列 A, B, C, 和 D 也是自动完成标签. E 也是可用的; 为了简便起见,后面的属性显示被截断.</p>
<h3>查看数据</h3>
<p>参阅基础部分</p>
<p>查看帧顶部和底部行</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [14]: df.head()
Out[14]: 
                   A         B         C         D
2013-01-01  0.469112 -0.282863 -1.509059 -1.135632
2013-01-02  1.212112 -0.173215  0.119209 -1.044236
2013-01-03 -0.861849 -2.104569 -0.494929  1.071804
2013-01-04  0.721555 -0.706771 -1.039575  0.271860
2013-01-05 -0.424972  0.567020  0.276232 -1.087401
 
In [15]: df.tail(3)
Out[15]: 
                   A         B         C         D
2013-01-04  0.721555 -0.706771 -1.039575  0.271860
2013-01-05 -0.424972  0.567020  0.276232 -1.087401
2013-01-06 -0.673690  0.113648 -1.478427  0.524988

# End www_512pic_com
</code></pre>
<p>显示索引,列,和底层numpy数据</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [16]: df.index
Out[16]: 
[2013-01-01, ..., 2013-01-06]
Length: 6, Freq: D, Timezone: None
 
In [17]: df.columns
Out[17]: Index([u&#39;A&#39;, u&#39;B&#39;, u&#39;C&#39;, u&#39;D&#39;], dtype=&#39;object&#39;)
 
In [18]: df.values
Out[18]: 
array([[ 0.4691, -0.2829, -1.5091, -1.1356],
       [ 1.2121, -0.1732,  0.1192, -1.0442],
       [-0.8618, -2.1046, -0.4949,  1.0718],
       [ 0.7216, -0.7068, -1.0396,  0.2719],
       [-0.425 ,  0.567 ,  0.2762, -1.0874],
       [-0.6737,  0.1136, -1.4784,  0.525 ]])

# End www_512pic_com
</code></pre>
<p>描述显示数据快速统计摘要</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [19]: df.describe()
Out[19]: 
              A         B         C         D
count  6.000000  6.000000  6.000000  6.000000
mean   0.073711 -0.431125 -0.687758 -0.233103
std    0.843157  0.922818  0.779887  0.973118
min   -0.861849 -2.104569 -1.509059 -1.135632
25%   -0.611510 -0.600794 -1.368714 -1.076610
50%    0.022070 -0.228039 -0.767252 -0.386188
75%    0.658444  0.041933 -0.034326  0.461706
max    1.212112  0.567020  0.276232  1.071804

# End www_512pic_com
</code></pre>
<h3>转置数据</h3>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [20]: df.T
Out[20]: 
   2013-01-01  2013-01-02  2013-01-03  2013-01-04  2013-01-05  2013-01-06
A    0.469112    1.212112   -0.861849    0.721555   -0.424972   -0.673690
B   -0.282863   -0.173215   -2.104569   -0.706771    0.567020    0.113648
C   -1.509059    0.119209   -0.494929   -1.039575    0.276232   -1.478427
D   -1.135632   -1.044236    1.071804    0.271860   -1.087401    0.524988

# End www_512pic_com
</code></pre>
<p>按轴排序</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [21]: df.sort_index(axis=1, ascending=False)
Out[21]: 
                   D         C         B         A
2013-01-01 -1.135632 -1.509059 -0.282863  0.469112
2013-01-02 -1.044236  0.119209 -0.173215  1.212112
2013-01-03  1.071804 -0.494929 -2.104569 -0.861849
2013-01-04  0.271860 -1.039575 -0.706771  0.721555
2013-01-05 -1.087401  0.276232  0.567020 -0.424972
2013-01-06  0.524988 -1.478427  0.113648 -0.673690

# End www_512pic_com
</code></pre>
<p>按值排序</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [22]: df.sort(columns=&#39;B&#39;)
Out[22]: 
                   A         B         C         D
2013-01-03 -0.861849 -2.104569 -0.494929  1.071804
2013-01-04  0.721555 -0.706771 -1.039575  0.271860
2013-01-01  0.469112 -0.282863 -1.509059 -1.135632
2013-01-02  1.212112 -0.173215  0.119209 -1.044236
2013-01-06 -0.673690  0.113648 -1.478427  0.524988
2013-01-05 -0.424972  0.567020  0.276232 -1.087401

# End www_512pic_com
</code></pre>
<p>选择器</p>
<p>注释: 标准Python / Numpy表达式可以完成这些互动工作, 但在生产代码中, 我们推荐使用优化的pandas数据访问方法, .at, .iat, .loc, .iloc 和 .ix.</p>
<p>参阅索引文档 索引和选择数据 and 多索引/高级索引</p>
<p></p>
<p>读取</p>
<p>选择单列, 这会产生一个序列, 等价df.A</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [23]: df[&#39;A&#39;]
Out[23]: 
2013-01-01    0.469112
2013-01-02    1.212112
2013-01-03   -0.861849
2013-01-04    0.721555
2013-01-05   -0.424972
2013-01-06   -0.673690
Freq: D, Name: A, dtype: float64

# End www_512pic_com
</code></pre>
<p></p>
<p>使用[]选择行片断</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [24]: df[0:3]
Out[24]: 
                   A         B         C         D
2013-01-01  0.469112 -0.282863 -1.509059 -1.135632
2013-01-02  1.212112 -0.173215  0.119209 -1.044236
2013-01-03 -0.861849 -2.104569 -0.494929  1.071804
 
In [25]: df[&#39;20130102&#39;:&#39;20130104&#39;]
Out[25]: 
                   A         B         C         D
2013-01-02  1.212112 -0.173215  0.119209 -1.044236
2013-01-03 -0.861849 -2.104569 -0.494929  1.071804
2013-01-04  0.721555 -0.706771 -1.039575  0.271860

# End www_512pic_com
</code></pre>
<p>使用标签选择</p>
<p>更多信息请参阅按标签选择</p>
<p>使用标签获取横截面</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [26]: df.loc[dates[0]]
Out[26]: 
A    0.469112
B   -0.282863
C   -1.509059
D   -1.135632
Name: 2013-01-01 00:00:00, dtype: float64

# End www_512pic_com
</code></pre>
<p>使用标签选择多轴</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [27]: df.loc[:,[&#39;A&#39;,&#39;B&#39;]]
Out[27]: 
                   A         B
2013-01-01  0.469112 -0.282863
2013-01-02  1.212112 -0.173215
2013-01-03 -0.861849 -2.104569
2013-01-04  0.721555 -0.706771
2013-01-05 -0.424972  0.567020
2013-01-06 -0.673690  0.113648

# End www_512pic_com
</code></pre>
<p></p>
<p>显示标签切片, 包含两个端点</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [28]: df.loc[&#39;20130102&#39;:&#39;20130104&#39;,[&#39;A&#39;,&#39;B&#39;]]
Out[28]: 
                   A         B
2013-01-02  1.212112 -0.173215
2013-01-03 -0.861849 -2.104569
2013-01-04  0.721555 -0.706771

# End www_512pic_com
</code></pre>
<p>降低返回对象维度</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [29]: df.loc[&#39;20130102&#39;,[&#39;A&#39;,&#39;B&#39;]]
Out[29]: 
A    1.212112
B   -0.173215
Name: 2013-01-02 00:00:00, dtype: float64

# End www_512pic_com
</code></pre>
<p>获取标量值</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [30]: df.loc[dates[0],&#39;A&#39;]
Out[30]: 0.46911229990718628

# End www_512pic_com
</code></pre>
<p>快速访问并获取标量数据 (等价上面的方法)</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [31]: df.at[dates[0],&#39;A&#39;]
Out[31]: 0.46911229990718628

# End www_512pic_com
</code></pre>
<p>按位置选择</p>
<p>更多信息请参阅按位置参阅</p>
<p>传递整数选择位置</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [32]: df.iloc[3]
Out[32]: 
A    0.721555
B   -0.706771
C   -1.039575
D    0.271860
Name: 2013-01-04 00:00:00, dtype: float64

# End www_512pic_com
</code></pre>
<p>使用整数片断,效果类似numpy/python</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [33]: df.iloc[3:5,0:2]
Out[33]: 
                   A         B
2013-01-04  0.721555 -0.706771
2013-01-05 -0.424972  0.567020

# End www_512pic_com
</code></pre>
<p>使用整数偏移定位列表,效果类似 numpy/python 样式</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [34]: df.iloc[[1,2,4],[0,2]]
Out[34]: 
                   A         C
2013-01-02  1.212112  0.119209
2013-01-03 -0.861849 -0.494929
2013-01-05 -0.424972  0.276232

# End www_512pic_com
</code></pre>
<p>显式行切片</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [35]: df.iloc[1:3,:]
Out[35]: 
                   A         B         C         D
2013-01-02  1.212112 -0.173215  0.119209 -1.044236
2013-01-03 -0.861849 -2.104569 -0.494929  1.071804

# End www_512pic_com
</code></pre>
<p>显式列切片</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [36]: df.iloc[:,1:3]
Out[36]: 
                   B         C
2013-01-01 -0.282863 -1.509059
2013-01-02 -0.173215  0.119209
2013-01-03 -2.104569 -0.494929
2013-01-04 -0.706771 -1.039575
2013-01-05  0.567020  0.276232
2013-01-06  0.113648 -1.478427

# End www_512pic_com
</code></pre>
<p>显式获取一个值</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [37]: df.iloc[1,1]
Out[37]: -0.17321464905330861

# End www_512pic_com
</code></pre>
<p></p>
<p>快速访问一个标量（等同上个方法）</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [38]: df.iat[1,1]
Out[38]: -0.17321464905330861

# End www_512pic_com
</code></pre>
<h3>布尔索引</h3>
<p>使用单个列的值选择数据.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [39]: df[df.A &gt; 0]
Out[39]: 
                   A         B         C         D
2013-01-01  0.469112 -0.282863 -1.509059 -1.135632
2013-01-02  1.212112 -0.173215  0.119209 -1.044236
2013-01-04  0.721555 -0.706771 -1.039575  0.271860

# End www_512pic_com
</code></pre>
<p>where 操作.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [40]: df[df &gt; 0]
Out[40]: 
                   A         B         C         D
2013-01-01  0.469112       NaN       NaN       NaN
2013-01-02  1.212112       NaN  0.119209       NaN
2013-01-03       NaN       NaN       NaN  1.071804
2013-01-04  0.721555       NaN       NaN  0.271860
2013-01-05       NaN  0.567020  0.276232       NaN
2013-01-06       NaN  0.113648       NaN  0.524988

# End www_512pic_com
</code></pre>
<p></p>
<p>使用 isin() 筛选：</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [41]: df2 = df.copy()
In [42]: df2[&#39;E&#39;]=[&#39;one&#39;, &#39;one&#39;,&#39;two&#39;,&#39;three&#39;,&#39;four&#39;,&#39;three&#39;]
 
In [43]: df2
Out[43]: 
                   A         B         C         D      E
2013-01-01  0.469112 -0.282863 -1.509059 -1.135632    one
2013-01-02  1.212112 -0.173215  0.119209 -1.044236    one
2013-01-03 -0.861849 -2.104569 -0.494929  1.071804    two
2013-01-04  0.721555 -0.706771 -1.039575  0.271860  three
2013-01-05 -0.424972  0.567020  0.276232 -1.087401   four
2013-01-06 -0.673690  0.113648 -1.478427  0.524988  three
 
In [44]: df2[df2[&#39;E&#39;].isin([&#39;two&#39;,&#39;four&#39;])]
Out[44]: 
                   A         B         C         D     E
2013-01-03 -0.861849 -2.104569 -0.494929  1.071804   two
2013-01-05 -0.424972  0.567020  0.276232 -1.087401  four

# End www_512pic_com
</code></pre>
<h3>赋值</h3>
<p>赋值一个新列，通过索引自动对齐数据</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [45]: s1 = pd.Series([1,2,3,4,5,6],index=pd.date_range(&#39;20130102&#39;,periods=6))
In [46]: s1
Out[46]: 
2013-01-02    1
2013-01-03    2
2013-01-04    3
2013-01-05    4
2013-01-06    5
2013-01-07    6
Freq: D, dtype: int64
 
In [47]: df[&#39;F&#39;] = s1

# End www_512pic_com
</code></pre>
<p>按标签赋值</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [48]: df.at[dates[0],&#39;A&#39;] = 0

# End www_512pic_com
</code></pre>
<p>按位置赋值</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [49]: df.iat[0,1] = 0

# End www_512pic_com
</code></pre>
<p>通过numpy数组分配赋值</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [50]: df.loc[:,&#39;D&#39;] = np.array([5] * len(df))

# End www_512pic_com
</code></pre>
<p>之前的操作结果</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [51]: df
Out[51]: 
                   A         B         C  D   F
2013-01-01  0.000000  0.000000 -1.509059  5 NaN
2013-01-02  1.212112 -0.173215  0.119209  5   1
2013-01-03 -0.861849 -2.104569 -0.494929  5   2
2013-01-04  0.721555 -0.706771 -1.039575  5   3
2013-01-05 -0.424972  0.567020  0.276232  5   4
2013-01-06 -0.673690  0.113648 -1.478427  5   5

# End www_512pic_com
</code></pre>
<p>where 操作赋值.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [52]: df2 = df.copy()
In [53]: df2[df2 &gt; 0] = -df2
In [54]: df2
Out[54]: 
                   A         B         C  D   F
2013-01-01  0.000000  0.000000 -1.509059 -5 NaN
2013-01-02 -1.212112 -0.173215 -0.119209 -5  -1
2013-01-03 -0.861849 -2.104569 -0.494929 -5  -2
2013-01-04 -0.721555 -0.706771 -1.039575 -5  -3
2013-01-05 -0.424972 -0.567020 -0.276232 -5  -4
2013-01-06 -0.673690 -0.113648 -1.478427 -5  -5

# End www_512pic_com
</code></pre>
<p></p>
<p>丢失的数据</p>
<p>pandas主要使用np.nan替换丢失的数据. 默认情况下它并不包含在计算中. 请参阅 Missing Data section</p>
<p>重建索引允许更改/添加/删除指定轴索引,并返回数据副本.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [55]: df1 = df.reindex(index=dates[0:4],columns=list(df.columns) + [&#39;E&#39;])
In [56]: df1.loc[dates[0]:dates[1],&#39;E&#39;] = 1
In [57]: df1
Out[57]: 
                   A         B         C  D   F   E
2013-01-01  0.000000  0.000000 -1.509059  5 NaN   1
2013-01-02  1.212112 -0.173215  0.119209  5   1   1
2013-01-03 -0.861849 -2.104569 -0.494929  5   2 NaN
2013-01-04  0.721555 -0.706771 -1.039575  5   3 NaN

# End www_512pic_com
</code></pre>
<p>删除任何有丢失数据的行.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [58]: df1.dropna(how=&#39;any&#39;)
Out[58]: 
                   A         B         C  D  F  E
2013-01-02  1.212112 -0.173215  0.119209  5  1  1

# End www_512pic_com
</code></pre>
<p>填充丢失数据</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [59]: df1.fillna(value=5)
Out[59]: 
                   A         B         C  D  F  E
2013-01-01  0.000000  0.000000 -1.509059  5  5  1
2013-01-02  1.212112 -0.173215  0.119209  5  1  1
2013-01-03 -0.861849 -2.104569 -0.494929  5  2  5
2013-01-04  0.721555 -0.706771 -1.039575  5  3  5

# End www_512pic_com
</code></pre>
<p>获取值是否nan的布尔标记</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [60]: pd.isnull(df1)
Out[60]: 
                A      B      C      D      F      E
2013-01-01  False  False  False  False   True  False
2013-01-02  False  False  False  False  False  False
2013-01-03  False  False  False  False  False   True
2013-01-04  False  False  False  False  False   True

# End www_512pic_com
</code></pre>
<h3>运算</h3>
<p>参阅二元运算基础</p>
<h3>统计</h3>
<p>计算时一般不包括丢失的数据</p>
<p>执行描述性统计</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [61]: df.mean()
Out[61]: 
A   -0.004474
B   -0.383981
C   -0.687758
D    5.000000
F    3.000000
dtype: float64

# End www_512pic_com
</code></pre>
<p>在其他轴做相同的运算</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [62]: df.mean(1)
Out[62]: 
2013-01-01    0.872735
2013-01-02    1.431621
2013-01-03    0.707731
2013-01-04    1.395042
2013-01-05    1.883656
2013-01-06    1.592306
Freq: D, dtype: float64

# End www_512pic_com
</code></pre>
<p>用于运算的对象有不同的维度并需要对齐.除此之外，pandas会自动沿着指定维度计算.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [63]: s = pd.Series([1,3,5,np.nan,6,8],index=dates).shift(2)
In [64]: s
Out[64]: 
2013-01-01   NaN
2013-01-02   NaN
2013-01-03     1
2013-01-04     3
2013-01-05     5
2013-01-06   NaN
Freq: D, dtype: float64
 
In [65]: df.sub(s,axis=&#39;index&#39;)
Out[65]: 
                   A         B         C   D   F
2013-01-01       NaN       NaN       NaN NaN NaN
2013-01-02       NaN       NaN       NaN NaN NaN
2013-01-03 -1.861849 -3.104569 -1.494929   4   1
2013-01-04 -2.278445 -3.706771 -4.039575   2   0
2013-01-05 -5.424972 -4.432980 -4.723768   0  -1
2013-01-06       NaN       NaN       NaN NaN NaN
Apply

# End www_512pic_com
</code></pre>
<p>在数据上使用函数</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [66]: df.apply(np.cumsum)
Out[66]: 
                   A         B         C   D   F
2013-01-01  0.000000  0.000000 -1.509059   5 NaN
2013-01-02  1.212112 -0.173215 -1.389850  10   1
2013-01-03  0.350263 -2.277784 -1.884779  15   3
2013-01-04  1.071818 -2.984555 -2.924354  20   6
2013-01-05  0.646846 -2.417535 -2.648122  25  10
2013-01-06 -0.026844 -2.303886 -4.126549  30  15
 
In [67]: df.apply(lambda x: x.max() - x.min())
Out[67]: 
A    2.073961
B    2.671590
C    1.785291
D    0.000000
F    4.000000
dtype: float64

# End www_512pic_com
</code></pre>
<h3>直方图</h3>
<p>请参阅 直方图和离散化</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [68]: s = pd.Series(np.random.randint(0,7,size=10))
In [69]: s
Out[69]: 
0    4
1    2
2    1
3    2
4    6
5    4
6    4
7    6
8    4
9    4
dtype: int32
 
In [70]: s.value_counts()
Out[70]: 
4    5
6    2
2    2
1    1
dtype: int64

# End www_512pic_com
</code></pre>
<h3>字符串方法</h3>
<p>序列可以使用一些字符串处理方法很轻易操作数据组中的每个元素,比如以下代码片断。 注意字符匹配方法默认情况下通常使用正则表达式（并且大多数时候都如此）. 更多信息请参阅字符串向量方法.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [71]: s = pd.Series([&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;Aaba&#39;, &#39;Baca&#39;, np.nan, &#39;CABA&#39;, &#39;dog&#39;, &#39;cat&#39;])
In [72]: s.str.lower()
Out[72]: 
0       a
1       b
2       c
3    aaba
4    baca
5     NaN
6    caba
7     dog
8     cat
dtype: object

# End www_512pic_com
</code></pre>
<p>合并</p>
<p>连接</p>
<p>pandas提供各种工具以简便合并序列,数据桢,和组合对象, 在连接/合并类型操作中使用多种类型索引和相关数学函数.</p>
<p>请参阅合并部分</p>
<p>把pandas对象连接到一起</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [73]: df = pd.DataFrame(np.random.randn(10, 4))
In [74]: df
Out[74]: 
          0         1         2         3
0 -0.548702  1.467327 -1.015962 -0.483075
1  1.637550 -1.217659 -0.291519 -1.745505
2 -0.263952  0.991460 -0.919069  0.266046
3 -0.709661  1.669052  1.037882 -1.705775
4 -0.919854 -0.042379  1.247642 -0.009920
5  0.290213  0.495767  0.362949  1.548106
6 -1.131345 -0.089329  0.337863 -0.945867
7 -0.932132  1.956030  0.017587 -0.016692
8 -0.575247  0.254161 -1.143704  0.215897
9  1.193555 -0.077118 -0.408530 -0.862495
 
# break it into pieces
In [75]: pieces = [df[:3], df[3:7], df[7:]]
In [76]: pd.concat(pieces)
Out[76]: 
          0         1         2         3
0 -0.548702  1.467327 -1.015962 -0.483075
1  1.637550 -1.217659 -0.291519 -1.745505
2 -0.263952  0.991460 -0.919069  0.266046
3 -0.709661  1.669052  1.037882 -1.705775
4 -0.919854 -0.042379  1.247642 -0.009920
5  0.290213  0.495767  0.362949  1.548106
6 -1.131345 -0.089329  0.337863 -0.945867
7 -0.932132  1.956030  0.017587 -0.016692
8 -0.575247  0.254161 -1.143704  0.215897
9  1.193555 -0.077118 -0.408530 -0.862495

# End www_512pic_com
</code></pre>
<p>连接</p>
<p>SQL样式合并. 请参阅 数据库style联接</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [77]: left = pd.DataFrame({&#39;key&#39;: [&#39;foo&#39;, &#39;foo&#39;], &#39;lval&#39;: [1, 2]})
In [78]: right = pd.DataFrame({&#39;key&#39;: [&#39;foo&#39;, &#39;foo&#39;], &#39;rval&#39;: [4, 5]})
In [79]: left
Out[79]: 
   key  lval
0  foo     1
1  foo     2
 
In [80]: right
Out[80]: 
   key  rval
0  foo     4
1  foo     5
 
In [81]: pd.merge(left, right, on=&#39;key&#39;)
Out[81]: 
   key  lval  rval
0  foo     1     4
1  foo     1     5
2  foo     2     4
3  foo     2     5

# End www_512pic_com
</code></pre>
<p>添加</p>
<p></p>
<p>添加行到数据增. 参阅 添加</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [82]: df = pd.DataFrame(np.random.randn(8, 4), columns=[&#39;A&#39;,&#39;B&#39;,&#39;C&#39;,&#39;D&#39;])
In [83]: df
Out[83]: 
          A         B         C         D
0  1.346061  1.511763  1.627081 -0.990582
1 -0.441652  1.211526  0.268520  0.024580
2 -1.577585  0.396823 -0.105381 -0.532532
3  1.453749  1.208843 -0.080952 -0.264610
4 -0.727965 -0.589346  0.339969 -0.693205
5 -0.339355  0.593616  0.884345  1.591431
6  0.141809  0.220390  0.435589  0.192451
7 -0.096701  0.803351  1.715071 -0.708758
 
In [84]: s = df.iloc[3]
In [85]: df.append(s, ignore_index=True)
Out[85]: 
          A         B         C         D
0  1.346061  1.511763  1.627081 -0.990582
1 -0.441652  1.211526  0.268520  0.024580
2 -1.577585  0.396823 -0.105381 -0.532532
3  1.453749  1.208843 -0.080952 -0.264610
4 -0.727965 -0.589346  0.339969 -0.693205
5 -0.339355  0.593616  0.884345  1.591431
6  0.141809  0.220390  0.435589  0.192451
7 -0.096701  0.803351  1.715071 -0.708758
8  1.453749  1.208843 -0.080952 -0.264610

# End www_512pic_com
</code></pre>
<p>分组</p>
<p>对于&ldquo;group by&rdquo;指的是以下一个或多个处理</p>
<p>将数据按某些标准分割为不同的组</p>
<p>在每个独立组上应用函数</p>
<p>组合结果为一个数据结构</p>
<p>请参阅 分组部分</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [86]: df = pd.DataFrame({&#39;A&#39; : [&#39;foo&#39;, &#39;bar&#39;, &#39;foo&#39;, &#39;bar&#39;,
   ....:                          &#39;foo&#39;, &#39;bar&#39;, &#39;foo&#39;, &#39;foo&#39;],
   ....:                    &#39;B&#39; : [&#39;one&#39;, &#39;one&#39;, &#39;two&#39;, &#39;three&#39;,
   ....:                          &#39;two&#39;, &#39;two&#39;, &#39;one&#39;, &#39;three&#39;],
   ....:                    &#39;C&#39; : np.random.randn(8),
   ....:                    &#39;D&#39; : np.random.randn(8)})
   ....: 
In [87]: df
Out[87]: 
     A      B         C         D
0  foo    one -1.202872 -0.055224
1  bar    one -1.814470  2.395985
2  foo    two  1.018601  1.552825
3  bar  three -0.595447  0.166599
4  foo    two  1.395433  0.047609
5  bar    two -0.392670 -0.136473
6  foo    one  0.007207 -0.561757
7  foo  three  1.928123 -1.623033

# End www_512pic_com
</code></pre>
<p>分组然后应用函数统计总和存放到结果组</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [88]: df.groupby(&#39;A&#39;).sum()
Out[88]: 
            C        D
A                     
bar -2.802588  2.42611
foo  3.146492 -0.63958

# End www_512pic_com
</code></pre>
<p>按多列分组为层次索引,然后应用函数</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [89]: df.groupby([&#39;A&#39;,&#39;B&#39;]).sum()
Out[89]: 
                  C         D
A   B                        
bar one   -1.814470  2.395985
    three -0.595447  0.166599
    two   -0.392670 -0.136473
foo one   -1.195665 -0.616981
    three  1.928123 -1.623033
    two    2.414034  1.600434

# End www_512pic_com
</code></pre>
<h3>重塑</h3>
<p>请参阅章节 分层索引 和 重塑.</p>
<p></p>
<h3>堆叠</h3>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [90]: tuples = list(zip(*[[&#39;bar&#39;, &#39;bar&#39;, &#39;baz&#39;, &#39;baz&#39;,
   ....:                      &#39;foo&#39;, &#39;foo&#39;, &#39;qux&#39;, &#39;qux&#39;],
   ....:                     [&#39;one&#39;, &#39;two&#39;, &#39;one&#39;, &#39;two&#39;,
   ....:                      &#39;one&#39;, &#39;two&#39;, &#39;one&#39;, &#39;two&#39;]]))
   ....: 
In [91]: index = pd.MultiIndex.from_tuples(tuples, names=[&#39;first&#39;, &#39;second&#39;])
In [92]: df = pd.DataFrame(np.random.randn(8, 2), index=index, columns=[&#39;A&#39;, &#39;B&#39;])
In [93]: df2 = df[:4]
In [94]: df2
Out[94]: 
                     A         B
first second                    
bar   one     0.029399 -0.542108
      two     0.282696 -0.087302
baz   one    -1.575170  1.771208
      two     0.816482  1.100230

# End www_512pic_com
</code></pre>
<p>堆叠 函数 &ldquo;压缩&rdquo; 数据桢的列一个级别.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [95]: stacked = df2.stack()
In [96]: stacked
Out[96]: 
first  second   
bar    one     A    0.029399
               B   -0.542108
       two     A    0.282696
               B   -0.087302
baz    one     A   -1.575170
               B    1.771208
       two     A    0.816482
               B    1.100230
dtype: float64

# End www_512pic_com
</code></pre>
<p>被&ldquo;堆叠&rdquo;数据桢或序列(有多个索引作为索引), 其堆叠的反向操作是未堆栈, 上面的数据默认反堆叠到上一级别:</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [97]: stacked.unstack()
Out[97]: 
                     A         B
first second                    
bar   one     0.029399 -0.542108
      two     0.282696 -0.087302
baz   one    -1.575170  1.771208
      two     0.816482  1.100230
 
In [98]: stacked.unstack(1)
Out[98]: 
second        one       two
first                      
bar   A  0.029399  0.282696
      B -0.542108 -0.087302
baz   A -1.575170  0.816482
      B  1.771208  1.100230
 
In [99]: stacked.unstack(0)
Out[99]: 
first          bar       baz
second                      
one    A  0.029399 -1.575170
       B -0.542108  1.771208
two    A  0.282696  0.816482
       B -0.087302  1.100230

# End www_512pic_com
</code></pre>
<p></p>
<p>数据透视表</p>
<p>查看数据透视表.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [100]: df = pd.DataFrame({&#39;A&#39; : [&#39;one&#39;, &#39;one&#39;, &#39;two&#39;, &#39;three&#39;] * 3,
   .....:                    &#39;B&#39; : [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;] * 4,
   .....:                    &#39;C&#39; : [&#39;foo&#39;, &#39;foo&#39;, &#39;foo&#39;, &#39;bar&#39;, &#39;bar&#39;, &#39;bar&#39;] * 2,
   .....:                    &#39;D&#39; : np.random.randn(12),
   .....:                    &#39;E&#39; : np.random.randn(12)})
   .....: 
In [101]: df
Out[101]: 
        A  B    C         D         E
0     one  A  foo  1.418757 -0.179666
1     one  B  foo -1.879024  1.291836
2     two  C  foo  0.536826 -0.009614
3   three  A  bar  1.006160  0.392149
4     one  B  bar -0.029716  0.264599
5     one  C  bar -1.146178 -0.057409
6     two  A  foo  0.100900 -1.425638
7   three  B  foo -1.035018  1.024098
8     one  C  foo  0.314665 -0.106062
9     one  A  bar -0.773723  1.824375
10    two  B  bar -1.170653  0.595974
11  three  C  bar  0.648740  1.167115

# End www_512pic_com
</code></pre>
<p>我们可以从此数据非常容易的产生数据透视表:</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [102]: pd.pivot_table(df, values=&#39;D&#39;, index=[&#39;A&#39;, &#39;B&#39;], columns=[&#39;C&#39;])
Out[102]: 
C             bar       foo
A     B                    
one   A -0.773723  1.418757
      B -0.029716 -1.879024
      C -1.146178  0.314665
three A  1.006160       NaN
      B       NaN -1.035018
      C  0.648740       NaN
two   A       NaN  0.100900
      B -1.170653       NaN
      C       NaN  0.536826

# End www_512pic_com
</code></pre>
<h3>时间序列</h3>
<p>pandas有易用,强大且高效的函数用于高频数据重采样转换操作(例如,转换秒数据到5分钟数据), 这是很普遍的情况，但并不局限于金融应用, 请参阅时间序列章节</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [103]: rng = pd.date_range(&#39;1/1/2012&#39;, periods=100, freq=&#39;S&#39;)
In [104]: ts = pd.Series(np.random.randint(0, 500, len(rng)), index=rng)
In [105]: ts.resample(&#39;5Min&#39;, how=&#39;sum&#39;)
Out[105]: 
2012-01-01    25083
Freq: 5T, dtype: int32

# End www_512pic_com
</code></pre>
<p>时区表示</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [106]: rng = pd.date_range(&#39;3/6/2012 00:00&#39;, periods=5, freq=&#39;D&#39;)
In [107]: ts = pd.Series(np.random.randn(len(rng)), rng)
In [108]: ts
Out[108]: 
2012-03-06    0.464000
2012-03-07    0.227371
2012-03-08   -0.496922
2012-03-09    0.306389
2012-03-10   -2.290613
Freq: D, dtype: float64
 
In [109]: ts_utc = ts.tz_localize(&#39;UTC&#39;)
In [110]: ts_utc
Out[110]: 
2012-03-06 00:00:00+00:00    0.464000
2012-03-07 00:00:00+00:00    0.227371
2012-03-08 00:00:00+00:00   -0.496922
2012-03-09 00:00:00+00:00    0.306389
2012-03-10 00:00:00+00:00   -2.290613
Freq: D, dtype: float64

# End www_512pic_com
</code></pre>
<p>转换到其它时区</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [111]: ts_utc.tz_convert(&#39;US/Eastern&#39;)
Out[111]: 
2012-03-05 19:00:00-05:00    0.464000
2012-03-06 19:00:00-05:00    0.227371
2012-03-07 19:00:00-05:00   -0.496922
2012-03-08 19:00:00-05:00    0.306389
2012-03-09 19:00:00-05:00   -2.290613
Freq: D, dtype: float64

# End www_512pic_com
</code></pre>
<p></p>
<p>转换不同的时间跨度</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [112]: rng = pd.date_range(&#39;1/1/2012&#39;, periods=5, freq=&#39;M&#39;)
In [113]: ts = pd.Series(np.random.randn(len(rng)), index=rng)
In [114]: ts
Out[114]: 
2012-01-31   -1.134623
2012-02-29   -1.561819
2012-03-31   -0.260838
2012-04-30    0.281957
2012-05-31    1.523962
Freq: M, dtype: float64
 
In [115]: ps = ts.to_period()
In [116]: ps
Out[116]: 
2012-01   -1.134623
2012-02   -1.561819
2012-03   -0.260838
2012-04    0.281957
2012-05    1.523962
Freq: M, dtype: float64
 
In [117]: ps.to_timestamp()
Out[117]: 
2012-01-01   -1.134623
2012-02-01   -1.561819
2012-03-01   -0.260838
2012-04-01    0.281957
2012-05-01    1.523962
Freq: MS, dtype: float64

# End www_512pic_com
</code></pre>
<p></p>
<p>转换时段并且使用一些运算函数, 下例中, 我们转换年报11月到季度结束每日上午9点数据</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [118]: prng = pd.period_range(&#39;1990Q1&#39;, &#39;2000Q4&#39;, freq=&#39;Q-NOV&#39;)
In [119]: ts = pd.Series(np.random.randn(len(prng)), prng)
In [120]: ts.index = (prng.asfreq(&#39;M&#39;, &#39;e&#39;) + 1).asfreq(&#39;H&#39;, &#39;s&#39;) + 9
In [121]: ts.head()
Out[121]: 
1990-03-01 09:00   -0.902937
1990-06-01 09:00    0.068159
1990-09-01 09:00   -0.057873
1990-12-01 09:00   -0.368204
1991-03-01 09:00   -1.144073
Freq: H, dtype: float64

# End www_512pic_com
</code></pre>
<h3>分类</h3>
<p>自版本0.15起, pandas可以在数据桢中包含分类. 完整的文档, 请查看分类介绍 and the API文档.</p>
<p>In [122]: df = pd.DataFrame({&quot;id&quot;:[1,2,3,4,5,6], &quot;raw_grade&quot;:[&#39;a&#39;, &#39;b&#39;, &#39;b&#39;, &#39;a&#39;, &#39;a&#39;, &#39;e&#39;]})</p>
<p></p>
<p>转换原始类别为分类数据类型.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [123]: df[&quot;grade&quot;] = df[&quot;raw_grade&quot;].astype(&quot;category&quot;)
In [124]: df[&quot;grade&quot;]
Out[124]: 
0    a
1    b
2    b
3    a
4    a
5    e
Name: grade, dtype: category
Categories (3, object): [a, b, e]

# End www_512pic_com
</code></pre>
<p>重命令分类为更有意义的名称 (分配到Series.cat.categories对应位置!)</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [125]: df[&quot;grade&quot;].cat.categories = [&quot;very good&quot;, &quot;good&quot;, &quot;very bad&quot;]

# End www_512pic_com
</code></pre>
<p>重排顺分类,同时添加缺少的分类(序列 .cat方法下返回新默认序列)</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [126]: df[&quot;grade&quot;] = df[&quot;grade&quot;].cat.set_categories([&quot;very bad&quot;, &quot;bad&quot;, &quot;medium&quot;, &quot;good&quot;, &quot;very good&quot;])
In [127]: df[&quot;grade&quot;]
Out[127]: 
0    very good
1         good
2         good
3    very good
4    very good
5     very bad
Name: grade, dtype: category
Categories (5, object): [very bad, bad, medium, good, very good]

# End www_512pic_com
</code></pre>
<p>排列分类中的顺序,不是按词汇排列.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [128]: df.sort(&quot;grade&quot;)
Out[128]: 
   id raw_grade      grade
5   6         e   very bad
1   2         b       good
2   3         b       good
0   1         a  very good
3   4         a  very good
4   5         a  very good

# End www_512pic_com
</code></pre>
<p>类别列分组,并且也显示空类别.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [129]: df.groupby(&quot;grade&quot;).size()
Out[129]: 
grade
very bad      1
bad         NaN
medium      NaN
good          2
very good     3
dtype: float64

# End www_512pic_com
</code></pre>
<h3>绘图</h3>
<p>绘图文档.</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [130]: ts = pd.Series(np.random.randn(1000), index=pd.date_range(&#39;1/1/2000&#39;, periods=1000))
In [131]: ts = ts.cumsum()
In [132]: ts.plot()
Out[132]:

# End www_512pic_com
</code></pre>
<p><img src="https://www.pythontab.com/uploadfile/2017/0929/20170929112812769.png" title="series_plot_basic.png" /></p>
<p>在数据桢中,可以很方便的绘制带标签列:</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [133]: df = pd.DataFrame(np.random.randn(1000, 4), index=ts.index,
   .....:                   columns=[&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;])
   .....: 
In [134]: df = df.cumsum()
In [135]: plt.figure(); df.plot(); plt.legend(loc=&#39;best&#39;)
Out[135]:

# End www_512pic_com
</code></pre>
<p><img src="https://www.pythontab.com/uploadfile/2017/0929/20170929112812567.png" title="frame_plot_basic.png" /><matplotlib.legend.legend 0xb01c9cac="" at=""></matplotlib.legend.legend></p>
<h3>获取数据输入/输出</h3>
<p>CSV</p>
<p>写入csv文件</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [136]: df.to_csv(&#39;foo.csv&#39;)

# End www_512pic_com
</code></pre>
<p>读取csv文件</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [137]: pd.read_csv(&#39;foo.csv&#39;)
Out[137]: 
     Unnamed: 0          A          B         C          D
0    2000-01-01   0.266457  -0.399641 -0.219582   1.186860
1    2000-01-02  -1.170732  -0.345873  1.653061  -0.282953
2    2000-01-03  -1.734933   0.530468  2.060811  -0.515536
3    2000-01-04  -1.555121   1.452620  0.239859  -1.156896
4    2000-01-05   0.578117   0.511371  0.103552  -2.428202
5    2000-01-06   0.478344   0.449933 -0.741620  -1.962409
6    2000-01-07   1.235339  -0.091757 -1.543861  -1.084753
..          ...        ...        ...       ...        ...
993  2002-09-20 -10.628548  -9.153563 -7.883146  28.313940
994  2002-09-21 -10.390377  -8.727491 -6.399645  30.914107
995  2002-09-22  -8.985362  -8.485624 -4.669462  31.367740
996  2002-09-23  -9.558560  -8.781216 -4.499815  30.518439
997  2002-09-24  -9.902058  -9.340490 -4.386639  30.105593
998  2002-09-25 -10.216020  -9.480682 -3.933802  29.758560
999  2002-09-26 -11.856774 -10.671012 -3.216025  29.369368
 
[1000 rows x 5 columns]

# End www_512pic_com
</code></pre>
<p></p>
<h3>HDF5</h3>
<p>读写HDF存储</p>
<p>写入HDF5存储</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [138]: df.to_hdf(&#39;foo.h5&#39;,&#39;df&#39;)

# End www_512pic_com
</code></pre>
<p>读取HDF5存储</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [139]: pd.read_hdf(&#39;foo.h5&#39;,&#39;df&#39;)
Out[139]: 
                    A          B         C          D
2000-01-01   0.266457  -0.399641 -0.219582   1.186860
2000-01-02  -1.170732  -0.345873  1.653061  -0.282953
2000-01-03  -1.734933   0.530468  2.060811  -0.515536
2000-01-04  -1.555121   1.452620  0.239859  -1.156896
2000-01-05   0.578117   0.511371  0.103552  -2.428202
2000-01-06   0.478344   0.449933 -0.741620  -1.962409
2000-01-07   1.235339  -0.091757 -1.543861  -1.084753
...               ...        ...       ...        ...
2002-09-20 -10.628548  -9.153563 -7.883146  28.313940
2002-09-21 -10.390377  -8.727491 -6.399645  30.914107
2002-09-22  -8.985362  -8.485624 -4.669462  31.367740
2002-09-23  -9.558560  -8.781216 -4.499815  30.518439
2002-09-24  -9.902058  -9.340490 -4.386639  30.105593
2002-09-25 -10.216020  -9.480682 -3.933802  29.758560
2002-09-26 -11.856774 -10.671012 -3.216025  29.369368
 
[1000 rows x 4 columns]

# End www_512pic_com
</code></pre>
<p></p>
<h3>Excel</h3>
<p>读写MS Excel</p>
<p>写入excel文件</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [140]: df.to_excel(&#39;foo.xlsx&#39;, sheet_name=&#39;Sheet1&#39;)

# End www_512pic_com
</code></pre>
<p>读取excel文件</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

In [141]: pd.read_excel(&#39;foo.xlsx&#39;, &#39;Sheet1&#39;, index_col=None, na_values=[&#39;NA&#39;])
Out[141]: 
                    A          B         C          D
2000-01-01   0.266457  -0.399641 -0.219582   1.186860
2000-01-02  -1.170732  -0.345873  1.653061  -0.282953
2000-01-03  -1.734933   0.530468  2.060811  -0.515536
2000-01-04  -1.555121   1.452620  0.239859  -1.156896
2000-01-05   0.578117   0.511371  0.103552  -2.428202
2000-01-06   0.478344   0.449933 -0.741620  -1.962409
2000-01-07   1.235339  -0.091757 -1.543861  -1.084753
...               ...        ...       ...        ...
2002-09-20 -10.628548  -9.153563 -7.883146  28.313940
2002-09-21 -10.390377  -8.727491 -6.399645  30.914107
2002-09-22  -8.985362  -8.485624 -4.669462  31.367740
2002-09-23  -9.558560  -8.781216 -4.499815  30.518439
2002-09-24  -9.902058  -9.340490 -4.386639  30.105593
2002-09-25 -10.216020  -9.480682 -3.933802  29.758560
2002-09-26 -11.856774 -10.671012 -3.216025  29.369368
 
[1000 rows x 4 columns]

# End www_512pic_com
</code></pre>
<p>陷阱</p>
<p>如果尝试这样操作可能会看到像这样的异常:</p>
<pre><code class="python">
# @param 十分钟搞定pandas
# @author php教程|www.512PiC.com 

&gt;&gt;&gt; if pd.Series([False, True, False]):
    print(&quot;I was true&quot;)
Traceback
    ...
ValueError: The truth value of an array is ambiguous. Use a.empty, a.any() or a.all().

# End www_512pic_com
</code></pre>

<p>注：关于Python搞定pandas入门实例的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/116570.html'>php 正确显示utf8中文的解决办法</a><a>下一篇</a><a href='/php/biji/116572.html'>python fork()函数生成子进程的完整代码</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>