<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>通过实例深入学习Java的Struts框架中的OGNL表达式使用_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="Struts 2默认的表达式语言是OGNL，原因是它相对其它表达式语言具有下面几大优势：<br />
<br />
1. 支持对象方法调用，如xxx.doSomeSpecial()； <br />
<br />
2. 支持类静态的方法调用和值访问，表达式的格式" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">通过实例深入学习Java的Struts框架中的OGNL表达式使用</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>Struts 2默认的表达式语言是OGNL，原因是它相对其它表达式语言具有下面几大优势：<br />
<br />
1. 支持对象方法调用，如xxx.doSomeSpecial()； <br />
<br />
2. 支持类静态的方法调用和值访问，表达式的格式</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>Struts 2默认的表达式语言是OGNL，原因是它相对其它表达式语言具有下面几大优势：<br />
1. 支持对象方法调用，如xxx.doSomeSpecial()； <br />
2. 支持类静态的方法调用和值访问，表达式的格式为@[类全名（包括包路径）]@[方法名 | 值名]，例如：@java.lang.String@format('foo %s', 'bar')或@tutorial.MyConstant@APP_NAME； <br />
3. 支持赋值操作和表达式串联，如price=100, discount=0.8, calculatePrice()，这个表达式会返回80； <br />
4. 访问OGNL上下文（OGNL context）和ActionContext； <br />
5. 操作集合对象。<br />
下面我们来看OGNL使用的几个例子：</p>
<p><strong>示例：上下文环境中使用OGNL</strong></p>
<div class="phpstudycode">
<pre class="brush:java;">
public class OGNL1 
{ 
  public static void main(String[] args) 
  { 
    /* 创建一个上下文Context对象，它是用保存多个对象一个环境 对象 */ 
    Map&lt;String , Object&gt; context = new HashMap&lt;String , Object&gt;(); 
 
    Person person1 = new Person(); 
    person1.setName("zhangsan"); 
     
    Person person2 = new Person(); 
    person2.setName("lisi"); 
 
    Person person3 = new Person(); 
    person3.setName("wangwu"); 
 
    /* person4不放入到上下文环境中 */ 
    Person person4 = new Person(); 
    person4.setName("zhaoliu"); 
 
    /* 将person1、person2、person3添加到环境中（上下文中） */ 
    context.put("person1", person1); 
    context.put("person2", person2); 
    context.put("person3", person3); 
 
    try 
    { 
      /* 获取根对象的"name"属性值 */ 
      Object value = Ognl.getValue("name", context, person2); 
      System.out.println("ognl expression \"name\" evaluation is : " + value); 
 
      /* 获取根对象的"name"属性值 */ 
      Object value2 = Ognl.getValue("#person2.name", context, person2); 
      System.out.println("ognl expression \"#person2.name\" evaluation is : " + value2); 
 
      /* 获取person1对象的"name"属性值 */ 
      Object value3 = Ognl.getValue("#person1.name", context, person2); 
      System.out.println("ognl expression \"#person1.name\" evaluation is : " + value3); 
 
      /* 将person4指定为root对象，获取person4对象的"name"属性，注意person4对象不在上下文中 */ 
      Object value4 = Ognl.getValue("name", context, person4); 
      System.out.println("ognl expression \"name\" evaluation is : " + value4); 
 
      /* 将person4指定为root对象，获取person4对象的"name"属性，注意person4对象不在上下文中 */ 
      Object value5 = Ognl.getValue("#person4.name", context, person4); 
      System.out.println("ognl expression \"person4.name\" evaluation is : " + value5); 
 
      /* 获取person4对象的"name"属性，注意person4对象不在上下文中 */ 
      // Object value6 = Ognl.getValue("#person4.name", context, person2); 
      // System.out.println("ognl expression \"#person4.name\" evaluation is : " + value6); 
 
    } 
    catch (OgnlException e) 
    { 
      e.printStackTrace(); 
    } 
  } 
} 
 
class Person 
{ 
  private String name; 
 
  public String getName() 
  { 
    return name; 
  } 
 
  public void setName(String name) 
  { 
    this.name = name; 
  } 
} 
</pre>
</div>
<p>控制台输出：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
ognl expression "name" evaluation is : lisi 
ognl expression "#person2.name" evaluation is : lisi 
ognl expression "#person1.name" evaluation is : zhangsan 
ognl expression "name" evaluation is : zhaoliu 
ognl.OgnlException: source is null for getProperty(null, "name") 
  at ognl.OgnlRuntime.getProperty(OgnlRuntime.java:2296) 
  at ognl.ASTProperty.getValueBody(ASTProperty.java:114) 
  at ognl.SimpleNode.evaluateGetValueBody(SimpleNode.java:212) 
  at ognl.SimpleNode.getValue(SimpleNode.java:258) 
  at ognl.ASTChain.getValueBody(ASTChain.java:141) 
  at ognl.SimpleNode.evaluateGetValueBody(SimpleNode.java:212) 
  at ognl.SimpleNode.getValue(SimpleNode.java:258) 
  at ognl.Ognl.getValue(Ognl.java:494) 
  at ognl.Ognl.getValue(Ognl.java:596) 
  at ognl.Ognl.getValue(Ognl.java:566) 
  at com.beliefbetrayal.ognl.OGNL1.main(OGNL1.java:53) 
</pre>
</div>
<p>对于使用上下文的OGNL，若不指定从哪一个对象中查找"name"属性，则OGNL直接从根对象(root)查找，若指定查找对象(使用'#'号指定，如#person1),则从指定的对象中查找，若指定对象不在上下文中则会抛出异常，换句话说就是是#person1.name形式指定查找对象则必须要保证指定对象在上下文环境中。</p>
<p><strong>示例：使用OGNL调用方法</strong></p>
<div class="phpstudycode">
<pre class="brush:java;">
public class OGNL2 
{ 
  public static void main(String[] args) 
  { 
    /* OGNL提供的一个上下文类，它实现了Map接口 */ 
    OgnlContext context = new OgnlContext(); 
 
    People people1 = new People(); 
    people1.setName("zhangsan"); 
 
    People people2 = new People(); 
    people2.setName("lisi"); 
 
    People people3 = new People(); 
    people3.setName("wangwu"); 
 
    context.put("people1", people1); 
    context.put("people2", people2); 
    context.put("people3", people3); 
     
    context.setRoot(people1); 
 
    try 
    { 
      /* 调用 成员方法 */ 
      Object value = Ognl.getValue("name.length()", context, context.getRoot()); 
      System.out.println("people1 name length is :" + value); 
       
      Object upperCase = Ognl.getValue("#people2.name.toUpperCase()", context, context.getRoot()); 
      System.out.println("people2 name upperCase is :" + upperCase); 
 
      Object invokeWithArgs = Ognl.getValue("name.charAt(5)", context, context.getRoot()); 
      System.out.println("people1 name.charAt(5) is :" + invokeWithArgs); 
 
      /* 调用静态方法 */ 
      Object min = Ognl.getValue("@java.lang.Math@min(4,10)", context, context.getRoot()); 
      System.out.println("min(4,10) is :" + min); 
 
      /* 调用静态变量 */ 
      Object e = Ognl.getValue("@java.lang.Math@E", context, context.getRoot()); 
      System.out.println("E is :" + e); 
    } 
    catch (OgnlException e) 
    { 
      e.printStackTrace(); 
    } 
  } 
} 
 
class People 
{ 
  private String name; 
 
  public String getName() 
  { 
    return name; 
  } 
 
  public void setName(String name) 
  { 
    this.name = name; 
  } 
} 
</pre>
</div>
<p>控制台输出：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
people1 name length is :8 
people2 name upperCase is :LISI 
people1 name.charAt(5) is :s 
min(4,10) is :4 
E is :2.718281828459045 
</pre>
</div>
<p>使用OGNL调用方法也十分简单，对于成员方法调用，只需要给出方法的名称+()，若有参数，直接写在括号内，与一般调用Java方法一致。对于静态方法的调用，需要使用如下格式：@ClassName@method，对于静态变量需要使用如下格式：@ClassName@field。</p>
<p><strong>示例：使用OGNL操作集合</strong></p>
<div class="phpstudycode">
<pre class="brush:java;">
public class OGNL3 
{ 
  public static void main(String[] args) throws Exception 
  { 
    OgnlContext context = new OgnlContext(); 
     
    Classroom classroom = new Classroom(); 
    classroom.getStudents().add("zhangsan"); 
    classroom.getStudents().add("lisi"); 
    classroom.getStudents().add("wangwu"); 
    classroom.getStudents().add("zhaoliu"); 
    classroom.getStudents().add("qianqi"); 
     
    Student student = new Student(); 
    student.getContactWays().put("homeNumber", "110"); 
    student.getContactWays().put("companyNumber", "119"); 
    student.getContactWays().put("mobilePhone", "112"); 
     
    context.put("classroom", classroom); 
    context.put("student", student); 
    context.setRoot(classroom); 
 
    /* 获得classroom的students集合 */ 
    Object collection = Ognl.getValue("students", context, context.getRoot()); 
    System.out.println("students collection is ：" + collection); 
 
    /* 获得classroom的students集合 */ 
    Object firstStudent = Ognl.getValue("students[0]", context, context.getRoot()); 
    System.out.println("first student is : " + firstStudent); 
 
    /* 调用集合的方法 */ 
    Object size = Ognl.getValue("students.size()", context, context.getRoot()); 
    System.out.println("students collection size is :" + size); 
 
    System.out.println("--------------------------飘逸的分割线--------------------------"); 
     
    Object mapCollection = Ognl.getValue("#student.contactWays", context, context.getRoot()); 
    System.out.println("mapCollection is :" + mapCollection); 
 
    Object firstElement = Ognl.getValue("#student.contactWays['homeNumber']", context, context.getRoot()); 
    System.out.println("the first element of contactWays is :" + firstElement); 
 
    System.out.println("--------------------------飘逸的分割线--------------------------"); 
 
    /* 创建集合 */ 
    Object createCollection = Ognl.getValue("{'aa','bb','cc','dd'}", context, context.getRoot()); 
    System.out.println(createCollection); 
 
    /* 创建Map集合 */ 
    Object createMapCollection = Ognl.getValue("#{'key1':'value1','key2':'value2'}", context, context.getRoot()); 
    System.out.println(createMapCollection); 
 
  } 
} 
 
class Classroom 
{ 
  private List&lt;String&gt; students = new ArrayList&lt;String&gt;(); 
 
  public List&lt;String&gt; getStudents() 
  { 
    return students; 
  } 
 
  public void setStudents(List&lt;String&gt; students) 
  { 
    this.students = students; 
  } 
} 
 
class Student 
{ 
  private Map&lt;String , Object&gt; contactWays = new HashMap&lt;String , Object&gt;(); 
 
  public Map&lt;String , Object&gt; getContactWays() 
  { 
    return contactWays; 
  } 
 
  public void setContactWays(Map&lt;String , Object&gt; contactWays) 
  { 
    this.contactWays = contactWays; 
  } 
} 
</pre>
</div>
<p>控制台的输出：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
students collection is ：[zhangsan, lisi, wangwu, zhaoliu, qianqi] 
first student is : zhangsan 
students collection size is :5 
--------------------------飘逸的分割线-------------------------- 
mapCollection is :{homeNumber=110, mobilePhone=112, companyNumber=119} 
the first element of contactWays is :110 
--------------------------飘逸的分割线-------------------------- 
[aa, bb, cc, dd] 
{key1=value1, key2=value2} 
</pre>
</div>
<p>OGNL不仅可以操作集合对象，还可以创建集合对象，对集合操作与对属性的操作没什么不同，需要注意的是OGNL认为List与Array是一样的。使用OGNL创建List集合时使用{}，创建Map对象时使用#{}。</p>
<p><strong>示例：使用OGNL过滤集合与投影集合</strong></p>
<div class="phpstudycode">
<pre class="brush:java;">
public class OGNL4 
{ 
  public static void main(String[] args) throws Exception 
  { 
    OgnlContext context = new OgnlContext(); 
 
    Humen humen = new Humen(); 
    humen.setName("qiuyi"); 
    humen.setSex("n"); 
    humen.setAge(22); 
    humen.getFriends().add(new Humen("zhangsan" , "n" , 22)); 
    humen.getFriends().add(new Humen("lisi" , "f" , 21)); 
    humen.getFriends().add(new Humen("wangwu" , "n" , 23)); 
    humen.getFriends().add(new Humen("zhaoliu" , "n" , 22)); 
    humen.getFriends().add(new Humen("qianqi" , "n" , 22)); 
    humen.getFriends().add(new Humen("sunba" , "f" , 20)); 
    humen.getFriends().add(new Humen("yangqiu" , "f" , 25)); 
     
    context.put("humen", humen); 
    context.setRoot(humen); 
 
    /* OGNL过滤集合的语法为：collection.{&#63; expression} */ 
    Object filterCollection = Ognl.getValue("friends.{&#63; #this.name.length() &gt; 7}", context, context.getRoot()); 
    System.out.println("filterCollection is :" + filterCollection); 
 
    System.out.println("--------------------------飘逸的分割线--------------------------"); 
 
    /* OGNL投影集合的语法为：collection.{expression} */ 
    Object projectionCollection = Ognl.getValue("friends.{name}", context, context.getRoot()); 
    System.out.println("projectionCollection is :" + projectionCollection); 
  } 
} 
 
class Humen 
{ 
  private String name; 
  private String sex; 
  private int age; 
  private List&lt;Humen&gt; friends = new ArrayList&lt;Humen&gt;(); 
 
  public Humen() 
  { 
 
  } 
 
  public Humen(String name , String sex , int age) 
  { 
    this.name = name; 
    this.sex = sex; 
    this.age = age; 
  } 
 
  public String getName() 
  { 
    return name; 
  } 
 
  public void setName(String name) 
  { 
    this.name = name; 
  } 
 
  public String getSex() 
  { 
    return sex; 
  } 
 
  public void setSex(String sex) 
  { 
    this.sex = sex; 
  } 
 
  public int getAge() 
  { 
    return age; 
  } 
 
  public void setAge(int age) 
  { 
    this.age = age; 
  } 
 
  public List&lt;Humen&gt; getFriends() 
  { 
    return friends; 
  } 
 
  public void setFriends(List&lt;Humen&gt; friends) 
  { 
    this.friends = friends; 
  } 
 
  @Override 
  public String toString() 
  { 
    return "Humen [name=" + name + ", sex=" + sex + ", age=" + age + "]"; 
  } 
} 

</pre>
</div>
<p>控制台输出：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
filterCollection is :[Humen [name=zhangsan, sex=n, age=22]] 
--------------------------飘逸的分割线-------------------------- 
projectionCollection is :[zhangsan, lisi, wangwu, zhaoliu, qianqi, sunba, yangqiu] 
</pre>
</div>
<p>OGNL可以对集合进行过滤与投影操作，过滤的语法为collection.{&#63; expression}，其中使用"#this"表示集合当前对象（可以与for-each循环比较）。投影的语法为collection.{expression}。投影和过滤可以看做是数据库中对表取列和取行的操作。</p>
<p><strong>一些常见问题<br />
</strong>平时使用Struts2标签时会出现一些很奇特的问题，对于OGNL不了解的人可能对问题的出现无能为力或者就算解决了问题也不知道是如何解决的。下面总结一些使用Struts2标签容易出现的困惑：</p>
<p><strong>问题一：#,%{},$符号</strong></p>
<p>在Struts2标签属性中经常会出现"#"或者"%{}"的符号出现，通过上面OGNL表达式基础的介绍，知道了OGNL上下文中有且仅有一个根对象。Struts2为我们定义了许多明明对象，他们分别是"ValueStack"，"Parameters"，"Session"，"Request"， "Appliction"，"Attr"，其中"ValueStack"被设置为上下文的根对象。访问非根对象必须加上"#"号，这就是出现"#"的原因。Struts2中的标的处理类，并不是所有都将标签的属性作为OGNL表达式来看待，有时候我们需要设置动态地值，则必须告诉标签的处理类该字符串按照OGNL表达式来处理，%{}符号的作用就是告诉标签的处理类将它包含的字符串按照OGNL表达式处理。 "$"符号用于XML文件中用于获取动态值，与%{}作用类似。</p>
<p><strong>问题二：%{}符号的影响</strong></p>
<p>Struts2的标签几十几百个，要记住哪一个标签的处理类将标签的属性作为OGNL表达式是一件很困难的事情，在不清楚处理类的处理方式时怎么办，%{}对于标签处理类来说，若处理类将属性值作为普通字符串则%{}符号包含的字符串当做OGNL表达式，若处理类将属性值作为OGNL表达式来处理，则直接忽略%{}符号。换句话说，不清楚处理方式的话，可以都使用%{}符号。</p>
<p><strong>问题三：标签是如何获得数据</strong></p>
<p>下面是ValueStack的官方描述：</p>
<p>ValueStack allows multiple beans to be pushed in and dynamic EL expressions to be evaluated against it. When evaluating an expression, the stack will be searched down the stack, from the latest objects pushed in to the earliest, looking for a bean with a getter or setter for the given property or a method of the given name (depending on the expression being evaluated).</p>
<p>大致意思：ValueStack允许保存多个bean（也就是Action），并且可以使用表达式语言获得他们。当评估一个表达式，ValueStack将会从栈顶到栈底的方向被搜索一遍，对于给定的属性名称寻找bean的getter或setter方法或寻找给定的方法。</p>
<p></p>
<p>每当一个请求到达Action时，Struts2会将Action对象推入ValueStack中。</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;body&gt;  
  username:&lt;s:property value="username"/&gt;&lt;br /&gt; 
  -------------------诡异的分割线-------------------&lt;br /&gt; 
  username:&lt;%= ((HelloWorldAction)ActionContext.getContext().getValueStack().peek()).getUsername() %&gt;&lt;br /&gt; 
 &lt;/body&gt; 
</pre>
</div>
<p>页面显示结果：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
username:zhangsan 
-------------------诡异的分割线------------------- 
username:zhangsan 
</pre>
</div>
<p>可以看到标签取值与用Java代码取值的结果相同，明显标签的取值方式更简练简洁。OGNL表达式"username"表示了从根对象ValueStack中取出属性username的值。它会从栈顶到栈底遍历ValueStack，直到找某一个Action中的"username"属性。</p>
<p><br />
<strong>总结OGNL的使用方法：</strong></p>
<p><strong>1.访问属性<br />
</strong>名字属性获取:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="user.username"/&gt;&lt;br&gt;</pre>
</div>
<p>地址属性获取:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="user.address.addr"/&gt;&lt;br&gt;
</pre>
</div>
<p><strong>2.访问方法<br />
</strong>调用值栈中对象的普通方法：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="user.get()"/&gt;&lt;br&gt;
</pre>
</div>
<p><strong>3.访问静态属性和方法<br />
</strong>调用Action中的静态方法：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="@struts.action.LoginAction@get()"/&gt;
</pre>
</div>
<p>调用JDK中的类的静态方法：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="@java.lang.Math@floor(44.56)"/&gt;&lt;br&gt;
</pre>
</div>
<p>调用JDK中的类的静态方法(同上)：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
 &lt;s:property value="@@floor(44.56)"/&gt;&lt;br&gt;
</pre>
</div>
<p>调用JDK中的类的静态方法：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="@java.util.Calendar@getInstance()"/&gt;&lt;br&gt;
</pre>
</div>
<p>调用普通类中的静态属性：</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="@struts.vo.Address@TIPS"/&gt;&lt;br&gt;
</pre>
</div>
<p>访问构造方法<br />
调用普通类的构造方法:&nbsp;</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="new struts.vo.Student('李晓红' , '美女' , 3 , 25).username"/&gt;
</pre>
</div>
<p>&nbsp;</p>
<p><strong>4.访问数组<br />
</strong>获取List:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="testList"/&gt;&lt;br&gt;
</pre>
</div>
<p>获取List中的某一个元素(可以使用类似于数组中的下标获取List中的内容):</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="testList[0]"/&gt;&lt;br&gt;

</pre>
</div>
<p>获取Set:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="testSet"/&gt;&lt;br&gt;
</pre>
</div>
<p>获取Set中的某一个元素(Set由于没有顺序，所以不能使用下标获取数据):</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="testSet[0]"/&gt;&lt;br&gt; ×

</pre>
</div>
<p>获取Map:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="testMap"/&gt;&lt;br&gt;
</pre>
</div>
<p>获取Map中所有的键:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="testMap.keys"/&gt;&lt;br&gt;
</pre>
</div>
<p>获取Map中所有的值:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="testMap.values"/&gt;&lt;br&gt;
</pre>
</div>
<p>获取Map中的某一个元素(可以使用类似于数组中的下标获取List中的内容):</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="testMap['m1']"/&gt;&lt;br&gt;

</pre>
</div>
<p>获取List的大小:&nbsp;</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="testSet.size"/&gt;&lt;br&gt;
</pre>
</div>
<p>&nbsp;</p>
<p><strong>5.访问集合 – 投影、选择(&#63; ^ $)<br />
</strong>利用选择获取List中成绩及格的对象:&lt;s:property value="stus.{&#63;#this.grade&gt;=60}"/&gt;&lt;br&gt;</p>
<p>利用选择获取List中成绩及格的对象的username:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="stus.{&#63;#this.grade&gt;=60}.{username}"/&gt;&lt;br&gt;

</pre>
</div>
<p>利用选择获取List中成绩及格的第一个对象的username:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="stus.{&#63;#this.grade&gt;=60}.{username}[0]"/&gt;&lt;br&gt;

</pre>
</div>
<p>利用选择获取List中成绩及格的第一个对象的username:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="stus.{^#this.grade&gt;=60}.{username}"/&gt;&lt;br&gt;

</pre>
</div>
<p>利用选择获取List中成绩及格的最后一个对象的username:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="stus.{$#this.grade&gt;=60}.{username}"/&gt;&lt;br&gt;

</pre>
</div>
<p>利用选择获取List中成绩及格的第一个对象然后求大小:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="stus.{^#this.grade&gt;=600}.{username}.size"/&gt;&lt;br&gt;

</pre>
</div>
<p>集合的伪属性<br />
OGNL能够引用集合的一些特殊的属性,这些属性并不是JavaBeans模式,例如size(),length()等等. 当表达式引用这些属性时,OGNL会调用相应的方法,这就是伪属性.<br />
</p>
<p></p>
<p><strong>6.Lambda&nbsp;&nbsp; :[…]<br />
</strong>格式：:[…]<br />
使用Lambda表达式计算阶乘:</p>
<div class="phpstudycode">
<pre class="brush:plain;">
&lt;s:property value="#f = :[#this==1&#63;1:#this*#f(#this-1)] , #f(4)"/&gt;&lt;br&gt;

</pre>
</div>
<p><strong>7.OGNL中#的使用<br />
</strong>#可以取出堆栈上下文中的存放的对象.<br />
</p>
<p></p>
<p>获取Paraments对象的属性：&lt;s:property value="#parameters.username"/&gt;</p>
<p><strong>8.OGNL中%的使用<br />
</strong>用%{}可以取出存在值堆栈中的Action对象,直接调用它的方法.</p>
<p>例如你的Action如果继承了ActionSupport .那么在页面标签中，用%{getText('key')}的方式可以拿出国际化信息.</p>
<p><strong>9.OGNL中$的使用</strong></p>
<p>“$”有两个主要的用途</p>
<ol>
<li>用于在国际化资源文件中，引用OGNL表达式</li>
<li>在Struts 2配置文件中，引用OGNL表达式</li>
</ol>
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/99093.html'>C#写日志类实例</a><a>下一篇</a><a href='/php/biji/99095.html'>Oracle SQL中实现indexOf和lastIndexOf功能的思路及代码</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>