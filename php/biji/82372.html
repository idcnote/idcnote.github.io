<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>探讨Java验证码制作(下篇)_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="接着上篇java验证码制作(上篇)给大家介绍有关java验证码的相关知识！<br />
方法三：<br />
<br />
用开源组件Jcaptcha实现，与Spring组合使用可产生多种形式的验证码，JCaptcha 即为Java版本的 CAPTC" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">探讨Java验证码制作(下篇)</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>接着上篇java验证码制作(上篇)给大家介绍有关java验证码的相关知识！<br />
方法三：<br />
<br />
用开源组件Jcaptcha实现，与Spring组合使用可产生多种形式的验证码，JCaptcha 即为Java版本的 CAPTC</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>接着上篇java验证码制作(上篇)给大家介绍有关java验证码的相关知识！</p>
<p><span style="color: #ff0000"><strong>方法三：</strong></span></p>
<p style="text-align: center"></p>
<p>用开源组件Jcaptcha实现，与Spring组合使用可产生多种形式的验证码，JCaptcha 即为Java版本的 CAPTCHA 项目，其是一个开源项目，支持生成图形和声音版的验证码，在生成声音版的验证码时，需要使用到 FreeTTS。而CAPTCHA 全称 Completely Automated Public Turing Test to Tell Computers and Humans Apart，最早作为卡内基梅隆大学的一个科研项目，用于生成一个人类容易通过而计算机难以通过的测试，目前广泛应用于网络应用，用于阻止机器人发布垃圾信息。目前，JCaptcha 官方网站显示有 2.0 版本，但二进制版只有 1.0 版可供下载。</p>
<p>首先我们需准备相应的jar包</p>
<p>JCaptcha 项目在实现中，还引用了 commons-collections 和 commons-logging 两个开源项目，再加上 JCaptcha 本身的实现，我们共需要三个包，具体信息如下：</p>
<p>jcaptcha-2.0-all.jarcommons-logging-1.1.1.jarcommons-collections-3.2.jar</p>
<p>其次我们看下面web.xml中的关键配置信息：除配置了Jcaptcha组件的具体class路径外，还配置了SubmitActionServlet这个用于比对验证码的servlet，并且都为二者做了映射，可理解为换了名字，分别为/jcaptcha.jpg和/submit.action调用组件或servlet时直接用这个映射名即可。</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;servlet&gt;
    &lt;servlet-name&gt;jcaptcha&lt;/servlet-name&gt;
    &lt;servlet-class&gt;com.octo.captcha.module.servlet.image.SimpleImageCaptchaServlet&lt;/servlet-class&gt;
  &lt;/servlet&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;submit&lt;/servlet-name&gt;
    &lt;servlet-class&gt;com.octo.captcha.module.servlet.image.sample.SubmitActionServlet&lt;/servlet-class&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;jcaptcha&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/jcaptcha.jpg&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;submit&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/submit.action&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;</pre>
</div>
<p><strong>web.xml</strong></p>
<p>然后来看SubmitActionServlet怎么实现：由于导入了jcaptcha的组件包，所以直接调用其中封装好的方法SimpleImageCaptchaServlet.validateResponse(request, userCaptchaResponse)来判断验证码中的信息是否与提交的匹配，而不需要去考虑具体的实现过程。</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class SubmitActionServlet extends HttpServlet
{
 protected void doPost(HttpServletRequest request, HttpServletResponse response)
 throws ServletException, IOException
 {
 String userCaptchaResponse = request.getParameter("japtcha");
 boolean captchaPassed = SimpleImageCaptchaServlet.validateResponse(request, userCaptchaResponse);
 if (captchaPassed)
  response.getWriter().write("captcha passed");
 else {
  response.getWriter().write("captcha failed");
 }
 response.getWriter().write("&lt;br/&gt;&lt;a href='index.jsp'&gt;Try again&lt;/a&gt;");
 }
}
SubmitActionServlet</pre>
</div>
<p>最后我们看一下简单的前台调用：<br />
</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;html&gt;
 &lt;body&gt;
 &lt;h&gt;Simple Captcha Servlet sample&lt;/h&gt;
 &lt;form action="submit.action" method="post"&gt;
  &lt;img src="jcaptcha.jpg" /&gt; &lt;input type="text" name="japtcha" value="" /&gt;
  &lt;input type="submit"/&gt;
 &lt;/form&gt;
 &lt;/body&gt;
 &lt;/html&gt;</pre>
</div>
<p>实现图例：</p>
<p style="text-align: center"></p>
<p><span style="color: #ff0000"><strong>方法四：</strong></span></p>
<p>用开源组件kaptcha实现，同样使用kaptcha需要下载其jar组件包，kaptcha 是一个非常实用的验证码生成工具。有了它，你可以生成各种样式的验证码，因为它是可配置的。kaptcha工作的原理是调用 com.google.code.kaptcha.servlet.KaptchaServlet（可以看出他是谷歌的一个开源项目），生成一个图片。同时将生成的验证码字符串放到 HttpSession中。</p>
<p>使用kaptcha可以方便的配置：</p>
<p>验证码的字体验证码字体的大小验证码字体的字体颜色验证码内容的范围(数字，字母，中文汉字！)验证码图片的大小，边框，边框粗细，边框颜色验证码的干扰线(可以自己继承com.google.code.kaptcha.NoiseProducer写一个自定义的干扰线)验证码的样式(鱼眼样式、3D、普通模糊……当然也可以继承com.google.code.kaptcha.GimpyEngine自定义样式)</p>
<p>……</p>
<p>对kaptcha的配置信息同样的是放在了web.xml中：&lt;init-param&gt;标签中即初始化的配置信息</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;servlet&gt;
   &lt;servlet-name&gt;Kaptcha&lt;/servlet-name&gt;
   &lt;servlet-class&gt;
    com.google.code.kaptcha.servlet.KaptchaServlet
   &lt;/servlet-class&gt;
   &lt;init-param&gt;
    &lt;description&gt;图片边框，合法值：yes , no&lt;/description&gt;
    &lt;param-name&gt;kaptcha.border&lt;/param-name&gt;
    &lt;param-value&gt;yes&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;
     边框颜色，合法值： r,g,b (and optional alpha) 或者
     white,black,blue.
    &lt;/description&gt;
    &lt;param-name&gt;kaptcha.border.color&lt;/param-name&gt;
    &lt;param-value&gt;black&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;边框厚度，合法值：&gt;&lt;/description&gt;
    &lt;param-name&gt;kaptcha.border.thickness&lt;/param-name&gt;
    &lt;param-value&gt;&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;图片宽 &lt;/description&gt;
    &lt;param-name&gt;kaptcha.image.width&lt;/param-name&gt;
    &lt;param-value&gt;&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;图片高 &lt;/description&gt;
    &lt;param-name&gt;kaptcha.image.height&lt;/param-name&gt;
    &lt;param-value&gt;&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;图片实现类&lt;/description&gt;
    &lt;param-name&gt;kaptcha.producer.impl&lt;/param-name&gt;
    &lt;param-value&gt;
     com.google.code.kaptcha.impl.DefaultKaptcha
    &lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;文本实现类&lt;/description&gt;
    &lt;param-name&gt;kaptcha.textproducer.impl&lt;/param-name&gt;
    &lt;param-value&gt;
     com.google.code.kaptcha.text.impl.DefaultTextCreator
    &lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;文本集合，验证码值从此集合中获取&lt;/description&gt;
    &lt;param-name&gt;kaptcha.textproducer.char.string&lt;/param-name&gt;
    &lt;param-value&gt;&lt;/param-value&gt;
    &lt;!--&lt;param-value&gt;abcdegfynmnpwx&lt;/param-value&gt;--&gt;
    &lt;!--&lt;param-value&gt;慕课网教程验证码实例&lt;/param-value&gt; --&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;验证码长度 &lt;/description&gt;
    &lt;param-name&gt;kaptcha.textproducer.char.length&lt;/param-name&gt;
    &lt;param-value&gt;&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;字体 Arial, Courier&lt;/description&gt;
    &lt;param-name&gt;kaptcha.textproducer.font.names&lt;/param-name&gt;
    &lt;param-value&gt;Arial, Courier&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;字体大小 px.&lt;/description&gt;
    &lt;param-name&gt;kaptcha.textproducer.font.size&lt;/param-name&gt;
    &lt;param-value&gt;&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;
     字体颜色，合法值： r,g,b 或者 white,black,blue.
    &lt;/description&gt;
    &lt;param-name&gt;kaptcha.textproducer.font.color&lt;/param-name&gt;
    &lt;param-value&gt;black&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;文字间隔 &lt;/description&gt;
    &lt;param-name&gt;kaptcha.textproducer.char.space&lt;/param-name&gt;
    &lt;param-value&gt;&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;干扰实现类&lt;/description&gt;
    &lt;param-name&gt;kaptcha.noise.impl&lt;/param-name&gt;
    &lt;param-value&gt;
     &lt;!-- com.google.code.kaptcha.impl.NoNoise --&gt;
     com.google.code.kaptcha.impl.DefaultNoise
    &lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;
     干扰颜色，合法值： r,g,b 或者 white,black,blue.
    &lt;/description&gt;
    &lt;param-name&gt;kaptcha.noise.color&lt;/param-name&gt;
    &lt;param-value&gt;black&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;
     图片样式： 水纹com.google.code.kaptcha.impl.WaterRipple
     鱼眼com.google.code.kaptcha.impl.FishEyeGimpy
     阴影com.google.code.kaptcha.impl.ShadowGimpy
    &lt;/description&gt;
    &lt;param-name&gt;kaptcha.obscurificator.impl&lt;/param-name&gt;
    &lt;param-value&gt;
     com.google.code.kaptcha.impl.WaterRipple
    &lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;背景实现类&lt;/description&gt;
    &lt;param-name&gt;kaptcha.background.impl&lt;/param-name&gt;
    &lt;param-value&gt;
     com.google.code.kaptcha.impl.DefaultBackground
    &lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;背景颜色渐变，开始颜色&lt;/description&gt;
    &lt;param-name&gt;kaptcha.background.clear.from&lt;/param-name&gt;
    &lt;param-value&gt;green&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;背景颜色渐变，结束颜色&lt;/description&gt;
    &lt;param-name&gt;kaptcha.background.clear.to&lt;/param-name&gt;
    &lt;param-value&gt;white&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;文字渲染器&lt;/description&gt;
    &lt;param-name&gt;kaptcha.word.impl&lt;/param-name&gt;
    &lt;param-value&gt;
     com.google.code.kaptcha.text.impl.DefaultWordRenderer
    &lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;
     session中存放验证码的key键
    &lt;/description&gt;
    &lt;param-name&gt;kaptcha.session.key&lt;/param-name&gt;
    &lt;param-value&gt;KAPTCHA_SESSION_KEY&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
    &lt;description&gt;
     The date the kaptcha is generated is put into the
     HttpSession. This is the key value for that item in the
     session.
    &lt;/description&gt;
    &lt;param-name&gt;kaptcha.session.date&lt;/param-name&gt;
    &lt;param-value&gt;KAPTCHA_SESSION_DATE&lt;/param-value&gt;
   &lt;/init-param&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
   &lt;servlet-name&gt;Kaptcha&lt;/servlet-name&gt;
   &lt;url-pattern&gt;/randomcode.jpg&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;</pre>
</div>
<p>前台调用：验证码图片的路径用了映射名randomcode.jpg，点击事件onclick()调用了js函数，js函数中同样的用当前时间使浏览器缓存失效来刷新验证码图片。</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;html&gt;
 &lt;head&gt;
 &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-"&gt;
 &lt;title&gt;randomcode&lt;/title&gt;
 &lt;script type="text/javascript"&gt;
  function changeR(node){
   // 用于点击时产生不同的验证码
   node.src = "randomcode.jpg&#63;time="+new Date().getTime() ; 
  }
 &lt;/script&gt;
 &lt;/head&gt;
 &lt;body&gt;
 &lt;img alt="random" src="randomcode.jpg" onclick="changeR(this)" style="cursor: pointer;"&gt;
  &lt;form action="check.jsp"&gt;
   &lt;input type="text" name="r"&gt;
   &lt;input type="submit" value="s"&gt;
  &lt;/form&gt; 
 &lt;/body&gt;
 &lt;/html&gt;</pre>
</div>
<p>验证码的比对check.jsp:通过(String) session.getAttribute(com.google.code.kaptcha.Constants.KAPTCHA_SESSION_KEY);得到验证码图片中字符串信息。</p>
<div class="phpstudycode">
<pre class="brush:java;">
 &lt;html&gt;
 &lt;head&gt;
 &lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-"&gt;
 &lt;title&gt;check&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
  &lt;%
   // 检查是否是正确的验证码
   String k = (String) session
     .getAttribute(com.google.code.kaptcha.Constants.KAPTCHA_SESSION_KEY);
   String str = request.getParameter("r");
   if (k.equals(str))
    out.print("true");
   out.print(k + "---" + str);
  %&gt;
 &lt;/body&gt;
 &lt;/html&gt;</pre>
</div>
<p>实现图例：</p>
<p style="text-align: center"></p>
<p>可以发现我们的验证码变得越来越来丰富多彩了，但是还停留在一个只验证英文字母和数字的阶段，那么还能不能玩点高端的呢，答案是肯定的。接下来我们来看一下中文验证码和算术运算验证码怎么实现。都只需基于以上kaptcha的使用进行修改即可。</p>
<p>中文验证码的实现：</p>
<p style="text-align: center"></p>
<p>首先我们找到kaptcha.jar包下有个DefaultTextCreator.class字节码文件，顾名思义，他是来产生验证码中文本的一个类，我们可以通过自己实现一个继承于他的类，并通过配置来使用自己的实现类来使验证码中的文本变为中文。经过如下反编译后得到的类我们可以看到其是那样实现的，其中的getText()函数用于产生getConfig()配置器将要渲染的验证码文本，所以我们只需继承配置类并实现文本产生接口后重写getText()方法即可。</p>
<div class="phpstudycode">
<pre class="brush:java;">
 public class DefaultTextCreator
 extends Configurable
 implements TextProducer
 {
 public String getText()
 {
  int length = getConfig().getTextProducerCharLength();
  char[] chars = getConfig().getTextProducerCharString();
  int randomContext = chars.length - ;
  Random rand = new Random();
  StringBuffer text = new StringBuffer();
  for (int i = ; i &lt; length; i++) {
  text.append(chars[(rand.nextInt(randomContext) + )]);
  }
  return text.toString();
 }
 }</pre>
</div>
<p>如下为ChineseText.java的具体实现：其中程序只执行getText()中的代码，原来代码写到了getText1()中，不执行，大家可以做一个比较。</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class ChineseText extends Configurable implements TextProducer {
  public String getText() {
   int length = getConfig().getTextProducerCharLength();
   //char[] charS = getConfig().getTextProducerCharString();
   String[] s = new String[]{"我","爱","扎","瓦","和","卖","塞","扣"};
   Random rand = new Random();
   StringBuffer sb = new StringBuffer();
   for(int i = ; i &lt; length; i++){
    int ind = rand.nextInt(s.length);
    sb.append(s[ind]);
   }
   return sb.toString();
  }
  /**
  * 中午实例
  * @return
  */
  public String getText() {
   int length = getConfig().getTextProducerCharLength();
   String finalWord = "", firstWord = "";
   int tempInt = ;
   String[] array = { "", "", "", "", "", "", "", "", "", "",
     "a", "b", "c", "d", "e", "f" };
   Random rand = new Random();
   for (int i = ; i &lt; length; i++) {
    switch (rand.nextInt(array.length)) {
    case :
     tempInt = rand.nextInt() + ;
     firstWord = String.valueOf((char) tempInt);
     break;
    case :
     int r,
     r,
     r,
     r;
     String strH,
     strL;// high&low
     r = rand.nextInt() + ; // 前闭后开[,)
     if (r == ) {
      r = rand.nextInt();
     } else {
      r = rand.nextInt();
     }
     r = rand.nextInt() + ;
     if (r == ) {
      r = rand.nextInt() + ;
     } else if (r == ) {
      r = rand.nextInt();
     } else {
      r = rand.nextInt();
     }
     strH = array[r] + array[r];
     strL = array[r] + array[r];
     byte[] bytes = new byte[];
     bytes[] = (byte) (Integer.parseInt(strH, ));
     bytes[] = (byte) (Integer.parseInt(strL, ));
     firstWord = new String(bytes);
     break;
    default:
     tempInt = rand.nextInt() + ;
     firstWord = String.valueOf((char) tempInt);
     break;
    }
    finalWord += firstWord;
   }
   return finalWord;
  }
 }</pre>
</div>
<p>最后一步就是去web.xml中改文本实现类的值，使组件调用自己写的那个类产生中文验证码。</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;init-param&gt;
    &lt;description&gt;文本实现类&lt;/description&gt;
    &lt;param-name&gt;kaptcha.textproducer.impl&lt;/param-name&gt;
    &lt;param-value&gt;
     ChineseText
    &lt;/param-value&gt;
   &lt;/init-param&gt; </pre>
</div>
<p>实现图例：</p>
<p style="text-align: center"></p>
<p>算数运算验证码的实现：</p>
<p>和上述中文验证码相同，我们需要通过继承类和接口来实现自己的类，并改写其中的函数，然后通过改配置信息来使组件调用自己实现的类从而实现验证码形式的多样化。</p>
<p style="text-align: center"></p>
<p>KaptchaServlet字节码文件经过反编译后的代码如下：</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class KaptchaServlet
 extends HttpServlet
 implements Servlet
 {
 private Properties props = new Properties();
 private Producer kaptchaProducer = null;
 private String sessionKeyValue = null;
 public void init(ServletConfig conf)
  throws ServletException
 {
  super.init(conf);
  ImageIO.setUseCache(false);
  Enumeration&lt;&#63;&gt; initParams = conf.getInitParameterNames();
  while (initParams.hasMoreElements())
  {
  String key = (String)initParams.nextElement();
  String value = conf.getInitParameter(key);
  this.props.put(key, value);
  }
  Config config = new Config(this.props);
  this.kaptchaProducer = config.getProducerImpl();
  this.sessionKeyValue = config.getSessionKey();
 }
 public void doGet(HttpServletRequest req, HttpServletResponse resp)
  throws ServletException, IOException
 {
  resp.setDateHeader("Expires", L);
  resp.setHeader("Cache-Control", "no-store, no-cache, must-revalidate");
  resp.addHeader("Cache-Control", "post-check=, pre-check=");
  resp.setHeader("Pragma", "no-cache");
  resp.setContentType("image/jpeg");
  String capText = this.kaptchaProducer.createText();
  req.getSession().setAttribute(this.sessionKeyValue, capText);
  BufferedImage bi = this.kaptchaProducer.createImage(capText);
  ServletOutputStream out = resp.getOutputStream();
  ImageIO.write(bi, "jpg", out);
  try
  {
  out.flush();
  }
  finally
  {
  out.close();
  }
 }
 }</pre>
</div>
<p>然后自己实现的KaptchaServlet.java代码如下：在原来的字节码文件上增加了实现加法验证码的逻辑，通过比对即可发现。</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class KaptchaServlet extends HttpServlet implements Servlet {
  private Properties props;
  private Producer kaptchaProducer;
  private String sessionKeyValue;
  public KaptchaServlet() {
   this.props = new Properties();
   this.kaptchaProducer = null;
   this.sessionKeyValue = null;
  }
  public void init(ServletConfig conf) throws ServletException {
   super.init(conf);
   ImageIO.setUseCache(false);
   Enumeration initParams = conf.getInitParameterNames();
   while (initParams.hasMoreElements()) {
    String key = (String) initParams.nextElement();
    String value = conf.getInitParameter(key);
    this.props.put(key, value);
   }
   Config config = new Config(this.props);
   this.kaptchaProducer = config.getProducerImpl();
   this.sessionKeyValue = config.getSessionKey();
  }
  public void doGet(HttpServletRequest req, HttpServletResponse resp)
    throws ServletException, IOException {
   resp.setDateHeader("Expires", L);
   resp.setHeader("Cache-Control", "no-store, no-cache, must-revalidate");
   resp.addHeader("Cache-Control", "post-check=, pre-check=");
   resp.setHeader("Pragma", "no-cache");
   resp.setContentType("image/jpeg");
   String capText = this.kaptchaProducer.createText();
   String s = capText.substring(, );
   String s = capText.substring(, );
   int r = Integer.valueOf(s).intValue() + Integer.valueOf(s).intValue();
   req.getSession().setAttribute(this.sessionKeyValue, String.valueOf(r));
   BufferedImage bi = this.kaptchaProducer.createImage(s+"+"+s+"=&#63;");
   ServletOutputStream out = resp.getOutputStream();
   ImageIO.write(bi, "jpg", out);
   try {
    out.flush();
   } finally {
    out.close();
   }
  }
 }</pre>
</div>
<p>我们还需在web.xml开头进行更改配置使组件来调用自己实现的servlet：</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;servlet-name&gt;Kaptcha&lt;/servlet-name&gt;
   &lt;servlet-class&gt;
    KaptchaServlet
   &lt;/servlet-class&gt;</pre>
</div>
<p>实现图例：</p>
<p style="text-align: center"></p>
<p style="text-align: left"><span style="color: #ff0000"><strong>总结：</strong></span></p>
<p>这里只是简单实现了验证码，但要用到商业项目上还是远远不够的，验证码想要不被破解还要加上各种加密算法，即使这样，也可以随处搜索到某某验证码被破解的情况。在网络上有一个地下数据库，里面存储的是我们的个人信息，那些信息都是一条条整理好的，这十分可怕，但这样一个数据库是客观存在的，验证码作为保护账户密码的重要一环，已变得越来越不安全，因为个人信息的泄露，别人掌握了你足够的信息就可以对你实行诈骗，其中验证码是重要一环，近日就有一毕业生被骗取验证码后，几个小时内所有财富都被转走的事件发生。所以请保护好你的验证码，不要轻易泄露给他人。</p>
<p>当然我们也不会坐以待毙，目前的验证码种类繁多也越来越难以破解，像语音识别、面部识别这些都是耳熟能详的就不多说了。</p>
<p>这里我们引入一个验证码“新”概念：双因素认证。</p>
<p>双因素认证是一种采用时间同步技术的系统，采用了基于时间、事件和密钥三变量而产生的一次性密码来代替传统的静态密码。每个动态密码卡都有一个唯一的密钥，该密钥同时存放在服务器端，每次认证时动态密码卡与服务器分别根据同样的密钥，同样的随机参数（时间、事件）和同样的算法计算了认证的动态密码，从而确保密码的一致性，从而实现了用户的认证。因每次认证时的随机参数不同，所以每次产生的动态密码也不同。由于每次计算时参数的随机性保证了每次密码的不可预测性，从而在最基本的密码认证这一环节保证了系统的安全性。解决因口令欺诈而导致的重大损失，防止恶意入侵者或人为破坏，解决由口令泄密导致的入侵问题。</p>
<p>简单来说，双因素身份认证就是通过你所知道再加上你所能拥有的这二个要素组合到一起才能发挥作用的身份认证系统。例如，在ATM上取款的银行卡就是一个双因素认证机制的例子，需要知道取款密码和银行卡这二个要素结合才能使用。目前主流的双因素认证系统是基于时间同步型，市场占有率高的有<em>DKEY双因素认证系统</em>、<em>RSA双因素认证系统</em>等，由于DKEY增加对短信密码认证及短信+令牌混合认证支持，相比RSA，DKEY双因素认证系统更具竞争力。</p>
<p>以上所述是小编给大家介绍的Java验证码制作的相关内容，希望对大家有所帮助！</p>
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/82371.html'>Win10预览版10056细节变动小汇总</a><a>下一篇</a><a href='/php/biji/82373.html'>MySQL学习笔记5：修改表(alter table)</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>