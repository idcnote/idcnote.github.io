<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>C语言中函数的声明、定义及使用的入门教程_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="对函数的“定义”和“声明”不是一回事。函数的定义是指对函数功能的确立，包括指定函数名，函数值类型、形参及其类型以及函数体等，它是一个完整的、独立的函数单位。而函数的声" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">C语言中函数的声明、定义及使用的入门教程</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>对函数的“定义”和“声明”不是一回事。函数的定义是指对函数功能的确立，包括指定函数名，函数值类型、形参及其类型以及函数体等，它是一个完整的、独立的函数单位。而函数的声</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>对函数的“定义”和“声明”不是一回事。函数的定义是指对函数功能的确立，包括指定函数名，函数值类型、形参及其类型以及函数体等，它是一个完整的、独立的函数单位。而函数的声明的作用则是把函数的名字，函数类型以及形参的类型、个数和顺序通知编译系统，以便在调用该函数时进行对照检查（例如，函数名是否正确，实参与形参的类型和个数是否一致），它不包括函数体。——谭浩强 ，《C程序设计》（第四版），清华大学出版社，2010年6月，p182</p>
<p>这段论述包含了许多概念性错误，这些概念错误在许多C语言书中都同样普遍存在。为了说明这些错误，首先来回顾一下C语言演变和发展的一些情况。</p>
<p>最早，C语言的代码可以这样写：<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
main()
{
 printf("hello,world!\n");
}
</pre>
</div>
<p>注意，这段代码对标识符printf没有进行任何说明。这是因为printf()函数的返回值为int类型。当时的C语言规定，对于没有任何说明的函数名，编译器会默认为返回值为int类型，因此对这样的函数名可以不做任何说明。那个时期的C语言，很多情况下int可以不写。例如main()函数返回值的类型为int就可以不写。</p>
<p>但是需要特别说明的是，这种“省劲”的写法已经过时，从C90标准起，这种写法就步入了被逐步抛弃的过程（尽管当时还没有完全立即废止）。C99废除了隐式函数声明法则（remove implicit function declaration），另外，省略main()前面的int也已经不再容许了。</p>
<p>在C语言早期，尽管有时不需要对函数名进行说明，但有些情况下对函数名进行说明还是必须的，比如：</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
double sqrt();
int main()
{
 printf("%f\n" , sqrt(9.) );
}

</pre>
</div>
<p>这是因为函数sqrt()返回值的类型不是int类型而是double类型，编译器编译时需要知道sqrt(9.)这个表达式的类型。</p>
<p>不难注意到这种对函数名的说明非常简单，这是最早期的一种函数类型说明的形式。这种说明只着重说明函数名是一个函数及其返回值类型，如果程序员在调用函数时存在参数类型或个数方面的错误编译器是无法察觉的，因为函数类型说明中“()”内没有任何信息。</p>
<p>这种办法只说明了函数名与()进行运算的结果也就是函数返回值的数据类型，无法进一步检查参数方面的错误是这种写法的不足之处。</p>
<p>如果不写函数类型说明，也可以把函数定义写在函数调用之前：</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
double square ( double x) 
{
 return x * x ;
}
int main(void)
{
 printf("%f\n" , square(3.) );
 return 0;
}

</pre>
</div>
<p>这表明函数定义也具有对函数名的类型加以说明的效果，因此从这个意义上来说，函数定义也是一种对函数类型的说明。这种办法可以检查出函数调用时在参数个数和类型方面的错误。</p>
<p>但是，用这种办法说明函数名并不好，因为这样做在编程时还需要考虑应该把哪个函数定义写在前面，哪个写在后面的问题。假如函数A调用函数B，函数B调用函数C，函数C又调用函数A，究竟如何安排函数定义的顺序就会让人感到无所适从。此外这种办法也不利于代码的组织，在由多个源文件组成的源程序时，这种写法就更会捉襟见肘、漏洞百出。因此，在1990年，C标准借鉴C++语言规定了一种新的说明函数名的方法，这就是函数原型（Function Propotype）式说明函数类型的方法：</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
double square ( double ); //或 double square ( double x)
int main(void)
{
  printf("%f\n" , square(3.) );
  return 0;
}
double square ( double x) 
{
  return x * x ;
}

</pre>
</div>
<p>使用这种办法，不但可以检查函数调用时参数类型和个数方面的错误，同时解决了源代码的组织问题，因为程序员不必再考虑该把哪个函数写在前面、哪个写在后面这种无聊的问题了。这种办法全面地说明了函数名的数据类型。此外要说明的是，把形参及其数据类型写在“()”内形式的函数定义也属于函数原型（Function Propotype）的范畴。</p>
<p>由此可见，古老的、不对参数进行任何说明的函数类型说明方式、函数定义以及函数原型式的函数类型说明方式都具有说明函数名意义的效用。从这个意义上讲它们都是函数声明。在C语言中，声明（Declaration）这个词的本义就是指定标识符的意义和性质（A declaration specifies the interpretation and attributes of a set of identifiers.），某个标识符的定义（Definition）同时也是这个标志符的“声明”（Declaration）。函数定义（Function definition）则意指包括函数体。(A definition of an identifier is a declaration for that identifier that: ……for a function, includes the function body;)。函数原型则特指包括说明参数类型的函数声明，它同样包含用这种方式写出的函数定义。</p>
<p>现在回过头来看样本中的第一句话：“对函数的“定义”和“声明”不是一回事”。由于函数定义本身就是一种函数声明，怎么可以说它们不是一回事呢？这句话的逻辑就如同说“男人”和“人”不是一回事。你可以说男人和女人不是一回事，因为他们没有交集。但没法说男人和人不是一回事，因为男人是人的子集，男人就是人的一种，怎么可以说男人和人不是一回事呢？</p>
<p>那么，不带函数体的函数声明应该如何称呼呢？在C语言中，它们叫被做“函数类型声明”（Function type declaration）。函数类型声明最主要的特点是声明了函数名是一个函数及其返回值的类型，如果也声明了参数的类型，则是函数原型式的函数类型声明。</p>
<p>样本中的“而函数的声明的作用则是把函数的名字，函数类型以及形参的类型、个数和顺序通知编译系统，以便在调用该函数时进行对照检查（例如，函数名是否正确，实参与形参的类型和个数是否一致），它不包括函数体”这句话同样不通。其主要错误是它混淆了“函数原型式类型声明”与“函数声明”这两个概念，前一个概念只是后一个概念的子集。函数声明中不但包含“函数类型声明”，也包含“函数定义”和老式的“函数类型声明”。由于函数定义本身就是一种函数声明，所以无法断定函数的声明是否包括函数体；而且老式的函数类型声明（例如double sqrt();）也属于函数声明，这种函数声明并不检查参数类型及个数方面的错误。此外函数声明也并没有检查“函数名”正确与否的功能。</p>
<p>这段文字中的“函数类型”这个概念也有错误，函数类型所描述的不但包括函数返回值类型，也可能一并描述参数的个数和类型（如果是函数原型），因此不能与“形参的类型、个数”相提并论。</p>
<p>现代的C语言的函数定义和函数类型声明都采用函数原型式的风格，C99把旧的非原型形式视为过时，这意味着非原型形式以后可能被禁止。</p>
<p><strong>main()函数<br />
</strong>在各种C语言书上，能看到各式各样main()函数的写法，简直令人无所适从，这是这么回事？原因主要有两个：一个是随着C语言的发展和演化，main()函数的写法也在不断变化；另外，某些书籍写法不规范或误导的现象也同时存在。</p>
<p>最初main()函数的写法非常简洁，那个时候的C程序员哪怕一个字符似乎都不肯多写。不知道是因为当时键盘质量不好还是因为编辑器太糟糕的缘故，那个时代的C程序员似乎惊人地一致崇尚“简约”——甚至可以说是“至简”。<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
main()
{
 printf("hello,world\n");
}
</pre>
</div>
<p>这就是main()函数最古老的写法，K&R在他们的经典名著《The C Programming Language》中的第一个C语言源程序（1978）。这种写法是那个时代的主流。</p>
<p>简直和裸体差不多，连#include&lt;stdio.h&gt;也没有么？在《The C Programming Language》的第一版中确实没有。那个时代的C语言，返回值类型为int的函数不用声明。不过在该书的第二版（1988）中这个程序被改成了：<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
#include &lt;stdio.h&gt;
main()
{
 printf("hello,world\n");
}
</pre>
</div>
<p>返回值类型为int的函数不用声明的规则改变了吗？规则没有改变。改变了的是观念，人们已经不再倾向于代码的“至简”，而开始倾向于在代码中交代清楚每一个标识符的来龙去脉。从C89开始倡导在函数调用之前一定要有函数声明，但并没有强求，而在C99这已经是强制性的要求了。由于《The C Programming Language》第二版正值ANSI C标准颁布（1989）前夕出版，所以这种变化也应该视为ANSI C标准的倾向性以及K&R对新标准的认同。尽管这个例子没有完全反映出来这种认同。</p>
<p>为什么说没有完全反映出来这种认同呢？因为这个main()的定义并没有按照函数原型(Function prototype)的方式来写，C90中规定不带参数的main()函数应该这样写：<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
int main(void) { /*. . .*/}
</pre>
</div>
<p>但同时规定那个int可以省略。C90把()内不写任何内容视为过时的写法，尽管C90无奈地容忍了它(The use of function declarators with empty parentheses (not prototype-format parameter type declarators) is an obsolescent feature.)。</p>
<p>为什么要容忍？因为有许多老式的代码还在用。</p>
<p>如果以C99的标准看这个main()写得如何呢？C99不容许省略int。但同样只把()内不写任何内容视为过时，而没有完全禁止，可见习惯力量的顽固。</p>
<p>那又为什么说K&R对新标准的认同呢？《The C Programming Language》第二版中的其他函数定义和函数类型声明基本上都改成了函数原型风格。比如，在讲解main()函数的参数时，K&R把原来的main()函数<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
#include &lt;stdio.h&gt;
main(argc,argv)
int argc;char *argv[];
{
 /*…… */
 return 0;
}
</pre>
</div>
<p>改成了：<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
#include &lt;stdio.h&gt;
main(int argc, char *argv[])
{
 /*…… */
 return 0;
}
</pre>
</div>
<p>前一个写法今天已经差不多绝迹，后一个main()以今天的眼光来看有些奇怪，main()的参数是用函数原型风格写的，但却没有写main()返回值的类型，给人有点半新半旧的感觉。尽管不能说它违背C90（因为C90容许不写main()前面的int），但如果写上了返回值的类型int，就同时满足现代C99标准的要求了。</p>
<p>这里出现的“return 0;”是怎么回事？这在现代C语言中已经是司空见惯了，它返回给操作系统一个值以表明程序是在何种状态下结束的。但在另一段代码中，K&R似乎又走得太远：<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
#include &lt;stdio.h&gt;
main(int argc,char *argv[])
{
 int found = 0 ;
 /*……计算found的值 */
 return found;
}
</pre>
</div>
<p>这个实在有些“标新立异”，居然把计算结果返回给了操作系统，颇有突破常规之嫌。</p>
<p>那前面几个没有“return 0;”的main()函数会怎么样？按照C90标准，会返回一个不确定的int类型的值，如果确实不关心这个返回值是多少，不写确实可以。但C99却要求编译器在编译的时候帮忙给补上这个“return 0;”，C99在必须写int这个问题上没有迁就懒人，但在这里却对偷懒的做法给予了迁就。 问：如果确实不关心main()函数的返回值，把main()的返回值定义为void类型如何？我看到许多书上都这样写的。<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
#include &lt;stdio.h&gt;
void main()
{
 printf("This is a C program.\n");
}
</pre>
</div>
<p>这在C99之前是一种野路子写法，究竟从哪里冒出来的，无据可考。但前几年的主流教科书中这种写法很常见。K&R（C语言的发明者）没有这样写过，C90国际标准也不承认这种写法。Bjarne Stroustrup（C++语言的创始人）在他的关于C++的FAQ中，在回答是否可以写“void main()”时愤怒地回答说这种写法在C++和C中都不曾有过。事实上，很多C语言专家都认为“void main()”非常邪恶。</p>
<p>因此，在C99之前，这是不符合标准的写法。尽管这段代码的功能似乎是输出“This is a C program.”，但其实却不是一个“C program”。</p>
<p>但是有时这样写并没有产生错误啊？首先，C语言的错误不一定反应在编译、链接或运行过程中。你输出一个垃圾值也可能一路通过编译、链接或运行，但这不说明你的代码没有错误，更不能说明这样的代码正确、有意义。其次，这样的写法在有些编译器下程序会产生崩溃或得到警告。这说明这种写法至少不普遍性适用的。可以说，如果不是C99标准，这种写法根本没有立锥之地。</p>
<p>C99给了这种写法以立足之地么？从某种意义上也许可以这样理解。因为K&R没承认过这种写法，C90根本不承认这种写法，C99虽然没有正式承认这种写法，但为这种写法留了一个后门：“It shall be defined ……or in some other implementation-defined manner”。这意思就是说，如果编译器明确声称允许void main()这种写法的话，那么C99不再象C90那样简单认为这种写法违背C标准。</p>
<p>但是不管怎么说，这种写法最多是某些编译器的一种“方言土语”，如果没有特殊理由，比如仅仅是工作在某个特殊环境，且仅仅使用特定的编译器而根本不考虑程序的可移植性，为什么不写普遍适用的形式呢？</p>
<p>既然很多C语言专家都认为“void main()”非常邪恶，C99为什么包容这种写法呢？很难确定C99是否就是打算专门想把这种写法也“收容”在标准之列。因为除了void main()，还有另外一些main()函数的写法被C90排除在标准之外了。而现在，这些写法在理论上也具备了符合C99标准的可能性。</p>
<p>还有什么样的main()函数？很多编译器都支持下面的main()的写法：<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
int main(int argc, char *argv[], char *env[])
{
 /* */
 return 0;
}
</pre>
</div>
<p>居然有3个形参，那个env是做什么用的？那个参数可以使程序获得环境变量。</p>
<p>什么叫环境变量？简单地讲可以理解为操作系统记录的一些数据，比如计算机的名字，操作系统放在哪里等等。应用程序在运行时可能要用到这些信息，这时可以通过env这个参数来获得。</p>
<p>如果编译器不支持main()的第三个参数怎么办？标准库函数也可以达到同样的目的。<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
#include &lt;stdlib.h&gt;
char *getenv(const char *name);
</pre>
</div>
<p>是否可以说void main()和int main(int argc, char *argv[], char *env[])也符合C99标准呢？恐怕还不能这么说，现在只是不能说这两种写法一定不符合C99标准。但这两种写法不符合C90标准是确定的，这两种写法的可移植性很差也是确定无疑的。C99标准在这里写的很模糊，没有进一步界定“implementation-defined manner”的含义。除非编译器声明遵守C99标准，且容许这两种写法，否则断言这两种写法符合C99标准属于空穴来风。</p>
<p>有人说“C99建议把main函数指定为int型”，这种说法对吗？显然不对。因为C99并非绝对不包容返回值非int类型的main()。正确的说法是，C90要求main()函数的返回值一定得是int型。但C90容许不写那个int，而C99则要求必须写上这个“int”。</p>
<p>下面这种风格如何？<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
#include &lt;stdio.h&gt;
int main()
{
 printf("This is a C program.\n");
 return 0;
}
</pre>
</div>
<p>这个写法有点不伦不类。返回值的类型int写了，这个和C89的倡导或C99的要求一致，但是()里面什么都不写，又与标准的所倡导的风格不符，所以说不伦不类。这种写法目前的标准依然容许，但属于标准目前尚能容忍的但即将过时的（obsolescent）写法，被抛弃只是早晚的问题。这种写法就如同古代的函数形参的写法一样：<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
main(argc,argv)
int argc;char *argv[];
{
 /*…… */
 return 0;
}
</pre>
</div>
<p>都属于历史的垃圾。</p>
<p>见过在main()的函数体的“}”之前前写一句getch();，这个是怎么回事？这个是时代的产物。在PC从DOS时代转变为Windows时代的过程中，DOS时代开发的IDE（主要是TC）无法在运行程序后显示输出结果，为了在运行后从容仔细地观察一下运行结果再返回IED界面，加上了这么一句，人为地延长程序运行时间（因为getch()会等待用户输入一个字符）。但这与main()本身的结构无关。这条语句不具备普遍意义，只是将就过时的IDE的一种权宜之计而已。所谓不具备普遍意义是指，第一，真正的程序往往不需要这条语句，就是说这条语句与程序功能无关；第二，getch()这个函数并不是标准函数，只有个别的编译器才支持它，在其他编译器上写这条语句，很可能行不通。</p>
<p>为什么不用getchar()这个标准库函数呢？getchar()的功能和getch()有点区别，前者会在标准输出设备上显示用户键入的字符，这显得很不利索，而后者则不会显示用户所键入的字符，更接近“Press Any Key to continue……”的效果。</p>
<p>有的代码在main()函数结束前写system("PAUSE");，是否也是这个意思？是的。这也是一种人工制造的“请按任意键继续. . .”，与程序功能结构无关，只是为了方便地观察输出结果。但是这种写法比调用getch()要好，因为system()函数是标准库函数，各个编译器都提供支持。</p>
<p>有一种说法，“在最新的C99标准中，只有以下两种定义方式是正确的：”<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
int main( void )
{ 
 /* */
 return 0;
}
</pre>
</div>
<p>和<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
int main( int argc, char *argv[] )
{
 /* */
  return 0;
}
</pre>
</div>
<p>这种说法对吗？</p>
<p>这种说法显然不对。但可以确认的是这两种定义方式一定正确。不但在C99来说是正确的，以C89来说也是正确的。</p>
<p>还有一种写法：<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
int main( void )
{
 return EXIT_SUCCESS;
}
</pre>
</div>
<p>那个EXIT_SUCCESS是怎么回事？</p>
<p>return EXIT_SUCCESS;是与return 0;等价的一种文雅的写法。EXIT_SUCCESS是在stdlib.h中定义了的符号常量，返回这个值表示程序任务完成后程序退出。在stdlib.h定义的另一个符号常量EXIT_FAILURE，通常用于程序无法完成任务而退出。</p>
<p>实在太眼花缭乱了，需要记住这么多吗？显然没必要。很多东西都是历史原因遗留下的垃圾。</p>
<p>如果学习C语言，应该记住或使用哪种呢？显然是：<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
int main( void )
{ 
 /* */
  return 0;
}
</pre>
</div>
<p>和<br />
</p>
<div class="phpstudycode">
<pre class="brush:cpp;">
int main( int argc, char *argv[] )
{
 /* */
  return 0;
}
</pre>
</div>
<p>第一，他们普遍适用，不存在可移植性的问题；</p>
<p>第二，就目前看，他们不存在任何过时或即将过时的成分。当然，如果喜欢文雅，不写return 0;而写EXIT_SUCCESS也可以。 顺便说一句，有的学习者记不住带参数main()函数两个形参的名字。其实这两个形参的名字也可以自己取，不一定用那两个名字，只要记住类型就可以了。第二个参数的类型也可以是char **，这和原来的是等价的。</p>
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/89268.html'>Win10系统画图工具怎么放大缩小图片?</a><a>下一篇</a><a href='/php/biji/89270.html'>一个判断抢购时间是否到达的简单的js函数</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>