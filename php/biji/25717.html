<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>JavaScript基本对象_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="作者：excelence转贴 整理日期：2004年6月15日 <br />
<br />
本文不只是关于JavaScript的，它是关于Notes/Domino中的JavaScript的！ 虽然如是说，不过还是值得一看！ 希望你有所收获！ <br />
<br />
亲密接触单" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/122.html"></a></li><li><a href="/php/phpbiji/123.html"></a></li><li><a href="/php/phpbiji/124.html"></a></li><li><a href="/php/phpbiji/125.html"></a></li><li><a href="/php/phpbiji/126.html"></a></li><li><a href="/php/phpbiji/127.html"></a></li><li><a href="/php/phpbiji/128.html"></a></li><li><a href="/php/phpbiji/129.html"></a></li><li><a href="/php/phpbiji/130.html"></a></li><li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">JavaScript基本对象</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>作者：excelence转贴 整理日期：2004年6月15日 <br />
<br />
本文不只是关于JavaScript的，它是关于Notes/Domino中的JavaScript的！ 虽然如是说，不过还是值得一看！ 希望你有所收获！ <br />
<br />
亲密接触单</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span>作者：excelence转贴 整理日期：2004年6月15日 <br><br>本文不只是关于JavaScript的，它是关于Notes/Domino中的JavaScript的！ <BR>虽然如是说，不过还是值得一看！ <BR>希望你有所收获！ <br><br>亲密接触单选按钮、复选框和JavaScript的一些有趣的事情 <br><br>我将以对象模型和一些常用对象开始，因为JavaScript里的一切都是从对象展开的。记住，本文不只是关于JavaScript的，它是关于Notes/Domino中的JavaScript的。 <br><br>窗口 <BR>窗口是对象模型的顶端对象。通常来说，窗口就是你的浏览器。如果你的窗口里有帧结构，那么每个帧结构都依次是一个小窗口，包含在顶层窗口——浏览器中。我会在另一篇文章里谈帧结构，现在，我们来看浏览器里只有一个Web页面的情况。 <br><br>窗口有它的属性，比如它的地址（也就是它的URL），浏览器底部的状态条上的文字等等；它也有方法，比如打开和关闭。通常来说，因为窗口在对象层次的顶层，JavaScript就假设Window已经存在了，你不必去刻意写上它，也就是说“window.location”和“location”的作用是相同的。 <br><br>窗口里是Web页面，它的对象层次从文档（document）开始。你可以用Window.document来引用它，或者就是简单的document。每个窗口只有一个文档（document）。依据你的浏览器的不同，文档（document）有几个变化多样的选项。在MSIE中，document.all数组包含了文档（document）中所有的对象。在Netscape Navigator的某些版本中，你可以访问document.layers数组。每一种浏览器关于对象的解释都不一样，但是表单数组（forms array）在所有的浏览器中都是可以访问的。 <br><br>理论上讲，每个文档（document）包含至少一个表单（form），但是可以包含多个。然而，在Notes中，除非明确写出用来完成特定功能的HTML代码（我从来没那么做过），通常只有一个表单。但是，因为可以有多个表单，所以你在引用表单时，还是得通过数组元素来引用表单，下标从0开始。不像LotusScript那样，用圆括号来括住下标数字，比如doc.CompanyName(0)，在JavaScript中你通常会看到引用数组下标的数字是括在方括号中的。因此，你应该用下面的方式引用表单： <br><br><br><br>window.document.forms[0]; <br><br><BR>或者简写成： <br><br><br><br>document.forms[0]; <br><br><BR>严格来说，上面的方法并不是唯一引用表单的方式，下面都是引用表单的合法的表达式： <br><br><br><br>document.forms[0]; <br><br>document.forms(0); <br><br>document.forms.0; <br><br><BR>然而，你经常看到的还是带方括号的方式。注意，我在每行语句的末尾加了分号，这是在JavaScript中和公式语言的相似之处之一。你应该在每一条语句的末尾加上分号。和公式语言不同的是，在JavaScript中分号并不总是必需的。有些浏览器和其他浏览器比起来，它们可以运行没有分号的JavaScript语句，所以，尽管有时你可以不用加分号，但是你最好养成每一条语句都加分号的习惯。 <br><br>当你接触到表单后，你就已经为访问你最关心的元素做好了准备。表单是域、按钮、文本、图像和其他元素的容器，你将在表单中用JavaScript来处理这些元素。 <br><br>简单的几个元素 <BR>对于LotusScript，有件事值得一提：除了Rich-Text域外的元素，如文本、单选框、列表框、复选框等，你可以用几乎相同的代码取得它们的值。例如：如果有一个“Location”域，不论它是何种类型，你都可以用下面的LotusScript代码取得它的值： <br><br><br><br>fieldVals = doc.Location <br><br><BR>或者这样： <br><br><br><br>fieldVals = doc.GetItemValue("Location") <br><br><BR>在LotusScript中，域的类型对于你要取值（值数组）的代码并不重要。不幸的是，这对于JavaScript并不适用。在JavaScript中，不同类型的域除了显示选项（比如单选框、复选框或者文本）外，并不像在Notes里那样，它们是不同的类型的对象，每一个都要用不同的方式去引用。其实，那也不是绝对的，有些对象是相似的，但是引用过程并不像在LotusScript里那么流畅。你会发现，你将花费很多时间手动寻找你的代码中的域（名）错误来使它们正常运行，那看起来很糟糕。 <br><br>你首先要知道的一点是：在JavaScript中，没有所谓的Rich-Text域，在HTML中更没有。Notes里提供了一个可以放在浏览器里的富文本Java（不是JavaScript）小程序，从而可以得到富文本的一些功能，但是你并不能用JavaScript来对它编程，而且它也不是一个真正的HTML对象类型。 <br><br>更让Notes开发人员惊讶的是，在Web上还没有数字型或时间型的域。HTML的域都是文本型的。尽管你能用它们来收集数字信息，如数量或单价，而保存的数据依然是文本。为了像数字一样使用它，你必须把它转换成数字类型。我将在后面详细讲解它。现在，要意识到一切都是文本，就像你在Notes的@Prompt对话框里输入的信息一样。 <br><br><BR>图 1 <br><br>建立表单 <BR>为了理解得更深入，你将在我的帮助下做一个小实验。打开Domino Designer，创建一个新表单，在表单上创建一个名为“Get editable field value”的按钮和一个名为“CreatedBy”的文本域，把此域的缺省值设成：@V3UserName（如图1）。 <br><br>如果你用R5的设计器（Designer），请把触发按钮的语言改成JavaScript。如果你像我一样用R6的设计器（Designer），就要稍微麻烦一些。在Notes/Domino6（ND6）中，你可以像在浏览器中使用JavaScript一样在Notes客户端中使用JavaScript。更重要的是，同一个按钮在不同的客户端里能运行不同的代码。在图2中，你将会看到一些选项，你将决定所写的代码是在Notes（“客户端”）还是在浏览器（“Web”）里运行。 <br><br><BR>图 2 <br><br><BR>图 3 <br><br>这个功能当你在不同的环境里运行不同的代码时非常有用，但是当你要在两种环境里运行同样的代码时怎么办呢？当然有比拷贝按钮代码更好的方法，你可以在右边的下拉列表中选择最下面的Common JavaScript来为两种环境同时编写代码（如图3）。 <br><br>在本例中，选择“Common JavaScript”。 <br><br>在按钮脚本中，输入提示用户CreatedBy域值的代码。如果你看过前一篇文章，你就知道可以用点来分隔JavaScript里的各个层级元素。你的按钮脚本应该如下所示： <br><br><br><br>alert(document.forms[0].CreatedBy.value); <br><br><BR>需要注意的是，JavaScript区分大小写。这个规则不只对JavaScript元素（文档、表单等）有效（首字母小写），对域的名字同样有效。你在域中用的什么大小写效果，在代码中必须如实反映。在浏览器中试验一下按钮的功能[Design&gt;Preview in Web Browser&gt;Internet Explorer（或者你自己的浏览器）]。如果你使用Domino R6的设计器（Designer），你可以在Notes客户端中进行试验（Design&gt;Preview in Notes）。 <br><br><BR>图 4 <br><br>如果你在用一个本地数据库进行试验（对应的是在服务器上），在浏览器中你看到的用户名将是“Anonymous”，而不是你的名字，然而在Notes客户端中却是你的名字。原因是当你用Web页面的方式访问本地数据库时，你没有登录到服务器，浏览器不知道你是谁。但是在Notes中，不论是本地还是服务器，你必须登录才能使用系统。这就是两种客户端之间微妙的差别。 <br><br>另一个区别是在Web上没有计算域，但并不意味着你不能在你的表单里加入计算域。你可以加入计算域，计算值将会在Web页中显示，除非域是隐藏的。关键是即使域就在那里显示，而HTML通常的处理是没有定义域。如果你把CreatedBy域改成计算域而不是可编辑的，在重新测试时你就会明白我所说的意思，你会得到和图4类似的提示信息。 <br><br>但是当你在Notes客户端（R6）里运行时，即使是计算域也没有任何错误。坦白地说，我还没有对这个功能是好还是坏下结论，但那就是我们所得到的结果。 <br><br>这里产生的错误非常重要，你要开始理解JavaScript里产生的错误，因为它对你的代码调试有很大的用处。那么当它提示你“document.forms.0.CreatedBy.value”为null值或不是对象时，意味着没有得到你想要的数据。 <br><br>当你返回到浏览器里，在背景上单击右键，选择“查看源文件”时，你会看到隐藏在Web页面下的HTML代码。你简单浏览代码时，会看到对按钮和计算域的引用，如下所示： <br><br><br><br>&lt;input type="button" onclick="alert(document.forms[0].CreatedBy.value);" value="Get editable field value"&gt; <br><br>&lt;p&gt;Created By:Anonymous <br><br><BR>当你对页面进行过排版的话，你的代码里可能会有字体、段落或其他的标记混杂在按钮和计算域的代码里。那些是格式化文档用的，在此处的讨论中可以略过不看。注意看“Anonymous”是表单上的另一个单词，它没有任何的标记在两旁来提示你它是从域产生的。在源代码中，Anonymous和“Created By”没有任何区别：两个在域前面的静态文本（如果你已经登录，你将看到你的名字而不是Anonymous）。 <br><br>为了比较一下，把CreatedBy域改回可编辑文本，保存表单，回到浏览器并刷新页面，再看页面的源文件，将会如下所示： <br><br><br><br>&lt;input type="button" onclick="alert(document.forms[0].CreatedBy.value);" value="Get editable field value"&gt; <br><br>&lt;p&gt;Created by:&lt;input name="CreatedBy" value="Anonymous"&gt; <br><br><BR>代替单词Anonymous（或是你的名字）的是域的HTML代码（或者严格地讲，是HTML的文本输入框）。它的名字是“CreatedBy”，值是“Anonymous”。这些是通过JavaScript能取得的属性，而普通的文本却没有这些属性。所以你不能用JavaScript来引用计算域，至少在浏览器中如此。还有一点令人迷惑的就是当文档在非编辑状态下时，即使是可编辑域，也不能用JavaScript来引用它。换句话说，当你保存了文档再次打开，但没有把它设置成编辑模式时，页面的HTML代码将和CreatedBy域是计算域时相同。另外一个关于JavaScript的有趣的现象是：在Domino以外，我们没有太多的机会去处理表单的编辑和非编辑状态，而对于我们Domino开发者来说，这可是个大问题。 <br><br>你注意到按钮和域都转换成输入对象了吗？那就是HTML的工作方式。使人迷惑的是两个对象都有value这个属性。对于按钮，value是“Get editable field value”，我想应该是按钮的标签，但是域的value值却是它的实际值。一些其他类型的对象同时有value属性和text属性。如果你像我一样，那么你有时就会搞不清楚什么是什么！就我的经验而谈，最简单的办法是读Web页面的HTML代码。 <br><br>多值 <BR>HTML的域没有Notes的域那样的多值属性。可以试一下：在表单上加入第二个按钮和第二个域。把域命名为“Letters”，类型为可编辑文本，选中“允许多值（Allow multiple values）”复选框。将默认值写成如下的字母列表： <br><br><br><br>"A":"B":"C":"D":"E":"F":"G" <br><br><BR>把按钮命名为“Get multiple values”并键入如下的JavaScript代码： <br><br><br><br>alert(document.forms[0].Letters.value); <br><br><BR>你可以用不同的分隔符来改变此域的值，但是当你单击按钮时，你会注意到，不论你用什么分隔符，提示你的总是域的所有值。这和在Notes客户端中运行的@Formulas和LotusScript形成了对比。用@Prompt，你得到的提示只是域的第一个值：“A”。你用LotusScript同样也只能显示一个值，但是你要指定数组下标，否则将得到一个错误提示。公式和LotusScript都不能在提示语句中得到多值域的所有值。 <br><br>原因就是，在Notes的语言中，确实有多个值在域中。对于HTML和JavaScript来说，只有一个值。再次看Web页面的源代码你会发现和下面类似的代码： <br><br><br><br>&lt;input name="Letters" value="A;B;C;D;E;F;G"&gt; <br><br><BR>注意它的值是用“一对”双引号引起来的带分隔符的值。以后将会详细讨论如何分隔单独的值，但现在，你应该意识到多值在Web上并不是确切的多值（至少对于文本输入框是如此）。其他类型域的处理方式和文本域将会不同。 <br><br>单选按钮 <BR>另一个有趣的地方是单选按钮，就Notes和Web页面而言，Notes里的单选按钮是一个有多个值的单个域，在Web上是同名的输入文本框的数组。为了理解以上所述，请看下面的例子： <br><br>在表单上，加入另一个新域，名字为“RadioButtn”。正像它的名字一样，把它改成单选框类型的域。在域属性窗口的第二个标签中，输入下列选项和别名（图5）： <br><br><BR>图 5 <br><br><br><br>One | A <br><br>Two | B <br><br>Three | C <br><br>Four | D <br><br><BR>把此域的缺省值设成第一个选项的别名，也就是带引号的字母“A”。现在在浏览器里预览表单，再看源文件，你会看到单选按钮的代码和正常域的代码有很大区别。HTML代码看起来将和下面的类似： <br><br><br><br>&lt;input type="radio" name="RadioButtn" value="A" checked&gt;One&lt;br&gt; <br><br>&lt;input type="radio" name="RadioButtn" value="B"&gt;Two&lt;br&gt; <br><br>&lt;input type="radio" name="RadioButtn" value="C"&gt;Three&lt;br&gt; <br><br>&lt;input type="radio" name="RadioButtn" value="D"&gt;Four <br><br><BR>在这里你要注意一些要点。首先，所有的4个单选按钮对象有同一个名字：RadioButtn，这样一来，HTML和JavaScript就知道它们是同一个数组里的对象。其次，每个选项的值是选项的别名，并不是看到的文字（例如“One”、“Two”等）。这和在Notes中保存的是别名是一样的，保存的不是看到的文本（当然如果没有别名的话，保存的值和文本就是一样的了）。最后，你选中第一个选项的方法是在HTML语句中用的“checked”单词，它被加在了第一个单选按钮的语句里。 <br><br>如果你再加入另外的一个按钮，用和取其他两个域值同样的方法来取RadioButtn的值的话，你会得到一个奇怪的错误，也就是用下面的代码： <br><br><br><br>alert(document.forms[0].RadioButtn.value); <br><br><BR>你将会看到一个提示“undefined”的错误对话框（如图6）。 <br><br><BR>图 6 <br><br>这里的问题并不是没有定义它的值。毕竟如上面所示，单选按钮的代码中共有4个值。也就是说，问题出在RadioButtn本身，至少是现在用在这里的那个。单选按钮是一个输入选项的数组，如果你想要知道其中一个元素的值，必须指定是哪一个，试试下面的代码： <br><br><br><br>alert(document.forms[0].RadioButtn[0].value); <br><br><BR>好，返回的是当前域的值“A”，但是当你选择其他的选项时再单击按钮，你得到的依然是“A”，而不是你所选择的值，还是不太妙。 <br><br>为了得到选择的选项的值，首先要知道哪个选项被选中了，然后在alert语句中，用那个选中的选项的下标值来正确地引用当前选项的值。也就是说，如果第一个选项被选中，你应该取RadioButtn[0].value，如果第二个选项被选中，你就应该取RadioButtn[1].value，依此类推。 <br><br>在JavaScript中，某些类型的域具有selectedIndex属性，代表当前选中选项的数组下标值。然而单选按钮并不是那么幸运，同样，复选框也没能逃脱厄运。要想得到当前选中的单选按钮的值，你必须在RadioButtn数组元素中查找“checked”属性。和LotusScript相比，LotusScript就能像操作其他类型的域一样来取得单选按钮当前被选中的值。这是一件非常麻烦的事，但是，它就是那样的。 <br><br>下面是按钮的代码： <br><br><br><br>var doc = document.forms[0]; <br><br>for(i = 0; i &lt; <br><br>doc.RadioButtn.length; i++){ <br><br>if(doc.RadioButtn.checked){ <br><br>alert(doc.RadioButtn.value); <br><br>break; <br><br>} <br><br>} <br><br><BR>这里马上就出现了几个新概念，让我花点儿时间来解释一下。首先，如果你读过前面那篇文章，你就会知道“var”是在JavaScript里用来声明变量或给变量赋值用的，就好比LotusScript里的“Dim”和“Set”。既然这样，为了避免一遍一遍地输入document.forms[0]，我就把document.forms[0]赋给变量doc以备后用： <br><br><br><br>var doc = document.forms[0]; <br><br><BR>下面是循环，循环体中没有代码时的样子如下： <br><br><br><br>for(i = 0; i &lt; doc.RadioButtn.length; i++){ <br><br>　　} <br><br><BR>你是不是有点眼花缭乱？我以前每次看到类似这样的代码就眼晕，但是它并不像它看起来那么糟。首先，花括号只是用来包含循环体的。JavaScript的for循环有三个选项： <br><br>1. 计数变量以及它的初始值（i=0)； <br><br>2. 如何知道继续循环（i &lt; doc.RadioButtn.length)； <br><br>3. 如何累计计数变量（i++）。 <br><br>首先是i=0，很简单，我使用了变量i并且它的初始值为0。 <br><br>第二部分：i&lt;doc.RadioButtn.length，它可有点儿不太直观。JavaScript的length属性具有不同的使用环境，如果你要检查一个普通文本域的length，比如在表单上的CreatedBy域（document.forms[0].CreatedBy.length)，你会发现length是域中文本的字符个数。比如Anonymous，length就是9。对于数组，比如RadioButtn数组，length是数组中元素的个数。不像数组下标那样从0开始，length从1开始。因此，如果RadioButtn数组的最后一个元素下标是3，length的值就是4。在循环中，我让i从0开始计数循环，直到它小于4为止。因此，循环体共循环4次，i的值分别是0，1，2，3，以数组的最后一个元素的下标结束（我承认有点儿混乱）。 <br><br>循环体中的第三个参数：i++，对于LotusScript开发人员来说是一个低级错误。这是在JavaScript中的简写方式，i++的值和i=i+1的值是一样的。实际上，你可以在循环中用两种形式的任何一种，所以下面这种写法和上面的写法是等价的： <br><br><br><br>for(i = 0; i &lt; doc.RadioButtn.length; i = i + 1){ <br><br>} <br><br><BR>i=i+1同样可以正常运行，但是问题是没有人那么做，因为你习惯i++后，它更短小、更简单。它的价值在于，你还可以写i--，和i=i-1是一样的，当然，在这个循环里它不能运行。用i++你还可以做许多看起来很有趣的事情，但那是以后的事了。 <br><br>再来看循环：三个参数用分号分隔并由圆括号包围，循环体代码用花括号包围，循环体中是一个if语句： <br><br><br><br>if(doc.RadioButtn.checked){ <br><br>} <br><br><BR>这里的判断真假的语句同样也用圆括号包围。试验中的doc.RadioButtn.checked看起来没有提供充足的信息，但它和循环一起构成了一个JavaScript的简写方式。如果用LotusScript的方式呢？我首先会去检查当前的RadioButton元素是不是等于checked，像下面的方式： <br><br><br><br>doc.RadioButton[0] = "checked" <br><br><BR>由于checked是一个属性而不是一个值，所以上面的代码不能正确运行。你还会注意到在HTML中它并没有用引号引起来。其实，checked是一种"是"或者"不是"的东西。更准确一点说，它不是真就是假，所以那个if语句的意思就是：如果RadioButtn的这个元素是checked（被选中的），即：为真，那么就做下面的事情……这里的试验看起来有点奇怪，因为始终没有提到真假。如果那让你感到不舒服，你还可以很轻松地这样写if语句： <br><br><br><br>if(doc.RadioButtn.checked == true){ <br><br>} <br><br><BR>注意这里的true全部是小写而且有两个等号。和LotusScript中不同，JavaScript里的等号（=）只是用来把一个值赋给另一个什么东西： <br><br><br><br>var doc = document.forms[0]; <br><br><BR>为了比较两个项目是否相等，你必须使用两个等号。在我的头脑里，我想它的意思是：doc.RadioButtn.checked等于true，这样来帮我记住要用两个等号。双符号标记同样适用于&符号（使用一个时用来追加或连接字符；使用两个时表示“and”，比如在一个if语句里用两个判断条件时）。 <br><br>最后，在if语句里是一个alert语句，紧跟着一个break。break就是JavaScript里的Exit For。它终止循环，因为一个单选按钮只能有一个选项被选中。 <br><br>如果你把所有的代码都放入按钮里，你就会看到无论你选择单选按钮的哪个选项，单击按钮后都能正确的显示出选项的值。非常棒，现在你对JavaScript已经入门了。 <br><br>复选框 <br><br>复选框和单选按钮类似。在表单上，复制单选按钮域并改名为"CheckBx"，更改域的类型为"CheckBox（复选框）"，保存表单，刷新Web页面并查看源文件。你将看到复选框的HTML代码和RadioButtn的几乎一模一样： <br><br><br><br>&lt;input type="checkbox" name="CheckBx" value="A" checked&gt;One&lt;br&gt; <br><br>&lt;input type="checkbox" name="CheckBx" value="B"&gt;Two&lt;br&gt; <br><br>&lt;input type="checkbox" name="CheckBx" value="C"&gt;Three&lt;br&gt; <br><br>&lt;input type="checkbox" name="CheckBx" value="D"&gt;Four <br><br><BR>真正的区别不是域名，而是类型是复选框，不是单选按钮。另外一个区别就是你可以选择复选框中的多个值，尽管你还要像操作单选按钮那样遍历整个复选框来确定哪个选项被选中，但是你不能在全部检查完是否选中之前停止遍历动作。按钮中用来检查复选框选中的代码会像下面的样子： <br><br><br><br>var doc = document.forms[0]; <br><br>for(i = 0; i &lt; doc.CheckBx.length; i++){ <br><br>if(doc.CheckBx.checked){ <br><br>alert(doc.CheckBx.value); <br><br>} <br><br>} <br><br><BR>我确信到现在为止，你应该多多少少熟悉这些代码了，因为这和单选按钮基本一样，除了域名的改变和去掉了"bread"语句。在一个实用的程序中，这些代码所做的工作比我做的要多得多，但是首先我希望你很舒服地学完这些基本内容。 <br><br>等待更多的对象 <BR>你还有几个类型的域需要了解，每一种都有自己的特性，但那是另一篇文章的素材。现在，你可能要用自己的试验来熟悉这里的例子了。你也可能要向表单中加入更多的、我还没有涉及到的域，并查看它们的HTML源文件，那是我们下次的开始部分，再见。 <br><br>参考资源 <br><br>本文摘自 2003.6 《Lotus Magazine 简体中文版》：《Lotus Magazine 简体中文版》作为国内第一个专注于IBM Lotus技术的刊物，其内容主要源自美国Lotus方面的相关顶级技术刊物，面向广大Lotus管理及开发人员，向您展示最新最前沿的Lotus相关技术。欢迎 申请赠阅。 <BR>Lotus相关专题 ：如果您是对Lotus感兴趣的开发人员，想进一步了解Lotus产品家族，熟悉Lotus产品是如何和IBM其他的产品一起协同工作的，Lotus是如何支持诸如XML、Web服务等等业界的开放标准的，如何用Lotus进行J2EE的开发，即刻访问 IBM developerWorks 中国网站的 Lotus相关专题 。在这里，我们为您精心收集了相关的文章、教程、红皮书，相信对您的开发会有所帮助。<BR>关于活动下拉列表框和模糊查询的问题 <br><br><BR>我欲在下拉列表框中输入部分文字,再将从数据表class中模糊查询的结果在下拉项中显示出来,写了如下代码,但&lt;select&gt;中不让自己输入内容,请教高手们应该如何解决?&lt;% dim tianjian <BR>%&gt; <BR>&lt;script language = "JAVAscript"&gt; <BR>var onecount; <BR>coecount=0; <BR>function changelocation(locationid) <BR>{ <BR> var locationid=this.classid.text; <BR> tiaojian=locationid; <BR> &lt;% <BR>strConnString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Server.MapPath("Database/bgxt.mdb") <BR>set db = Server.CreateObject("ADODB.Connection") <BR>db.open strConnString <BR>Set rs= Server.CreateObject("ADODB.Recordset") <BR>sql="select * from class where Nclass like '"&tiaojian&"'" <BR> rs.open sql,db,1,1 <BR> count=0 <BR> do while not rs.eof <BR> %&gt; <BR> subcat[&lt;%=count%&gt;]=new array("&lt;%=trim(rs("Nclass"))%&gt;","&lt;%= trim(rs("classid"))%&gt;","&lt;%= trim(rs("Nclassid"))%&gt;"); <BR> &lt;% rs.movenext <BR> loop <BR> rs.close <BR> %&gt; <BR> onecount=&lt;%=count%&gt;; <BR> document.myfrom.classid.length=0; <BR> var locationid=locationid; <BR> var i; <BR> for(i=0;i&lt;onecount;i++) <BR> { <BR> document.myform.classid.options[document.myform.classid.length]=new option(subcat[i][0],subcat[i][1]); <BR> document.myform.classid.length=documen.myform.classid.lenght+1; <BR> } <BR>&lt;/script&gt; <br><br>&lt;form name="myform" method="post" action="temp1.asp"&gt; <BR> &lt;table width="75%" border="1"&gt; <BR> &lt;tr&gt; <BR> &lt;td width="55%"&gt;&lt;div align="center"&gt; <br><br> &lt;select name="classid" size="1" onchange=changelocation(this)&gt; <br><br><BR> &lt;/select&gt; &lt;/div&gt;&lt;/td&gt; <br><br> &lt;/tr&gt; <BR> &lt;/table&gt;
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/25716.html'>IIS常见问题及解答</a><a>下一篇</a><a href='/php/biji/25718.html'>PHP设计模式 注册表模式</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>