<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>Android中Textview超链接实现方式_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="TextView中的超链接可以通过几种方式实现：<br />
<br />
一、Html.fromHtml方式<br />
TextView，本身就支持部分的Html格式标签。这其中包括常用的字体大小颜色设置，文本链接等。使用起来也比较方" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">Android中Textview超链接实现方式</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>TextView中的超链接可以通过几种方式实现：<br />
<br />
一、Html.fromHtml方式<br />
TextView，本身就支持部分的Html格式标签。这其中包括常用的字体大小颜色设置，文本链接等。使用起来也比较方</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>TextView中的超链接可以通过几种方式实现：<br />
<strong>一、Html.fromHtml方式</strong></p>
<p>TextView，本身就支持部分的Html格式标签。这其中包括常用的字体大小颜色设置，文本链接等。使用起来也比较方便，只需要使用Html类转换一下即可： textView.setText(Html.fromHtml(str));</p>
<p>代码如下：</p>
<div class="phpstudycode">
<pre class="brush:java;">
 public class Test10Activity extends Activity {
  TextView textView ;
  @Override
  protected void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
   setContentView(R.layout.activity_test10);
   textView = (TextView) findViewById(R.id.text);
   String webLinkText = "&lt;a href='https://souly.cn'&gt; html超链接测试&lt;/a&gt;" ;
   textView.setText(Html.fromHtml(webLinkText));
  }
 }
 
</pre>
</div>
<p>这时候点击超链接并没有跳转效果，需要加上</p>
<p><span style="color: #333333"><strong>textView.setMovementMethod(LinkMovementMethod.getInstance());<br />
</strong></span>之后才会跳转。 这样点击之后会用默认浏览器打开url。</p>
<p>现在字体颜色和下划线是默认样式，修改字体颜色比较简单，可以直接用标签：</p>
<div class="phpstudycode">
<pre class="brush:java;">
 String webLinkText =
   "&lt;font color='#333333'&gt;&lt;a href='https://souly.cn' style='text-decoration:none; color:#0000FF'&gt;
   html超链接测试&lt;/a&gt;" ;
  
</pre>
</div>
<p>但是想不借助其他类去掉下划线就没有办法了。</p>
<p>还有一种更简单的方法就是在TextView的xml布局中加入autoLink自动识别，这样做操作最简单，但是也不能修改样式：</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;TextView
   android:id="@+id/text"
   android:layout_width="wrap_content"
   android:layout_height="wrap_content"
   android:textSize="20sp"
   android:text="souly.cn"
   android:autoLink="email|phone|web"
   /&gt;  

</pre>
</div>
<p><strong>二、Spannable方式</strong></p>
<p>在xml中设置了android:autoLink="email|phone|web"后，url文字下面会有一条下划线,我们可以看URLSpan所继承的类ClickableSpan 类的源码，如下：</p>
<div class="phpstudycode">
<pre class="brush:java;">
public abstract class ClickableSpan extends CharacterStyle implements UpdateAppearance {

   /
   * Performs the click action associated with this span.
   */

   public abstract void onClick(View widget);

   /
   * Makes the text underlined and in the link color.
   */

   @Override

   public void updateDrawState(TextPaint ds) {

    ds.setColor(ds.linkColor);

    ds.setUnderlineText(true);

   }

  }

</pre>
</div>
<p>它调用ds.setUnderlineText(true); 设置了下划线。我们再设置一个没有下划线的Spannable对象就可以了。 我们重写一个类继承UnderlineSpan，和ClickableSpan一样，都是CharacterStyle的子类。</p>
<p>使用方法如下：</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class Test10Activity extends Activity {
 TextView textView ;
 @Override
 protected void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_test10);
  textView = (TextView) findViewById(R.id.text);
  String webLinkText = "我的博客--&gt;https://souly.cn" ;
  textView.setText(webLinkText);
  NoUnderlineSpan mNoUnderlineSpan = new NoUnderlineSpan();
  if (textView.getText() instanceof Spannable) {
   Spannable s = (Spannable) textView.getText();
   s.setSpan(mNoUnderlineSpan, 0, s.length(), Spanned.SPAN_MARK_MARK);
  }
 }
 public static class NoUnderlineSpan extends UnderlineSpan {
  public NoUnderlineSpan() {}
  public NoUnderlineSpan(Parcel src) {}
  @Override
  public void updateDrawState(TextPaint ds) {
   super.updateDrawState(ds);
   ds.setUnderlineText(false);
  }
 }
}
</pre>
</div>
<p>这样textview在界面上就不会有下划线了，但却保留着autolink的功能。 这个超链接是默认颜色，如果需要改变颜色可以在xml中设置android:textColorLink="#1e84fb"， 或者在java代码中设置tv.setLinkTextColor(color);</p>
<p>上面的例子是在autoLink设置的情况下自动识别超链接的，如果不需要自动识别，而是自己手动设置需要跳转的网址， 可以使用以下方法，首先删除xml中的android:autoLink="email|phone|web"</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class Test10Activity extends Activity {
 TextView textView ;
 @Override
 protected void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_test10);
  textView = (TextView) findViewById(R.id.text);
  String webLinkText = "我的博客" ;
  SpannableString text = new SpannableString(webLinkText);
  NoUnderlineSpan mNoUnderlineSpan = new NoUnderlineSpan("https://souly.cn") ;
  text.setSpan(mNoUnderlineSpan,0,text.length(),Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);
  textView.setText(text);
  textView.setMovementMethod(LinkMovementMethod.getInstance());
 }
 public static class NoUnderlineSpan extends URLSpan {
  public NoUnderlineSpan(String url) {
   super(url);
  }
  @Override
  public void updateDrawState(TextPaint ds) {
   super.updateDrawState(ds);
   ds.setUnderlineText(false);
  }
 }
}
</pre>
</div>
<p>这里的NoUnderlineSpan继承了URLSpan而不是UnderlineSpan，URLSpan是ClickableSpan的子类。</p>
<p>有的时候我们需要自定义超链接点击事件，例如弹一个Toast，那么重写ClickableSpan：</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class Test10Activity extends Activity {
 TextView textView;
 @Override
 protected void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.activity_test10);
  textView = (TextView) findViewById(R.id.text);
  String webLinkText = "我的博客";
  SpannableString spStr = new SpannableString(webLinkText);
  ClickableSpan clickSpan = new NoLineClickSpan(spStr.toString()); //设置超链接
  spStr.setSpan(clickSpan, 0, spStr.length(), Spanned.SPAN_INCLUSIVE_EXCLUSIVE);
  textView.append(spStr);
  textView.setMovementMethod(LinkMovementMethod.getInstance());
 }
 private class NoLineClickSpan extends ClickableSpan {
  String text;
  public NoLineClickSpan(String text) {
   super();
   this.text = text;
  }
  @Override
  public void updateDrawState(TextPaint ds) {
   ds.setColor(ds.linkColor);
   ds.setUnderlineText(false); //去掉下划线
  }
  @Override
  public void onClick(View widget) {
   processHyperLinkClick(text); //点击超链接时调用
  }
 }
 private void processHyperLinkClick(String text){
  Toast.makeText(this,text,Toast.LENGTH_SHORT).show();
 }
}
</pre>
</div>
<p><strong>三、Linkify.addLinks方式</strong></p>
<p>除了使用默认的web等模式之外，我们还可以通过Linkify类的addLinks方法来添加自定义模式。Linkify.addLinks也是功能最 强大的一种方式。</p>
<p>在讲这种方式之前先科普一下Intent Filters的知识。</p>
<p>android中的activity,service,Broadcast Receivers都可以设置intent过滤器，它们可以有一个或多个intent过滤器。 每个过滤器描述组件的一种能力，即告知系统能够处理哪些隐式intent。个显式intent总是能够传递到它的目标组件，不管它包含什么； 不考虑过滤器。但是一个隐式intent，仅当它能够通过组件的过滤器之一才能够传递给它。</p>
<p>一个intent过滤器是一个IntentFilter类的实例。因为Android系统在启动一个组件之前必须知道它的能力，但是intent过滤器通常不在java 代码中设置，而是在应用程序的清单文件（AndroidManifest.xml）中以元素设置。但有一个例外， 广播接收者的过滤器通过调用Context.registerReceiver()动态地注册，它直接创建一个IntentFilter对象。</p>
<p>一个过滤器有对应于Intent对象的动作、数据、种类的字段。过滤器要检测隐式intent的所有这三个字段，其中任何一个失败， Android系统都不会传递intent给组件。然而，因为一个组件可以有多个intent过滤器，一个intent通不过组件的过滤器检测， 其它的过滤器可能通过检测。</p>
<p><span style="color: #800000"><strong>*动作检测</strong></span></p>
<p>清单文件中的元素以子元素列出动作，例如：</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;intent-filter&gt;
 &lt;action android:name="com.example.project.SHOW_CURRENT" /&gt;
 &lt;action android:name="com.example.project.SHOW_RECENT" /&gt;
 &lt;action android:name="com.example.project.SHOW_PENDING" /&gt;
 . . .
&lt;/intent-filter&gt;
</pre>
</div>
<p>像例子所展示，虽然一个Intent对象仅是单个动作，但是一个过滤器可以列出不止一个。这个列表不能够为空，一个过滤器必须至少包含一个 子元素，否则它将阻塞所有的intents。</p>
<p>要通过检测，Intent对象中指定的动作必须匹配过滤器的动作列表中的一个。如果对象或过滤器没有指定一个动作，结果将如下：</p>
<p>如果过滤器没有指定动作，没有一个Intent将匹配，所有的intent将检测失败，即没有intent能够通过过滤器。 如果Intent对象没有指定动作，将自动通过检查（只要过滤器至少有一个子元素，否则就是上面的情况了）</p>
<p><span style="color: #800000"><strong>*种类检测</strong></span></p>
<p>类似的，清单文件中的元素以子元素列出种类，例如：</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;intent-filter&gt;
 &lt;category android:name="android.intent.category.DEFAULT" /&gt;
 &lt;category android:name="android.intent.category.BROWSABLE" /&gt;
 . . .
&lt;/intent-filter&gt;
</pre>
</div>
<p>对于一个intent要通过种类检测，intent对象中的每个种类必须匹配过滤器中的一个。即过滤器能够列出额外的种类，但是intent对象中的种类都必须能够在过滤器中找到， 只要一个种类在过滤器列表中没有，就算种类检测失败！</p>
<p>因此，原则上如果一个intent对象中没有种类（即种类字段为空）应该总是通过种类测试，而不管过滤器中有什么种类。但是有个例外， Android对待所有传递给Context.startActivity()的隐式intent好像它们至少包含"android.intent.category.DEFAULT" （对应CATEGORY_DEFAULT常量）。因此，activity想要接收隐式intent必须要在intent过滤器中包含"android.intent.category.DEFAULT"。</p>
<p>注意："android.intent.action.MAIN" 和 "android.intent.category.LAUNCHER"设置，它们分别标记活动开始新的任务和带到启动列表界面。 它们可以包含"android.intent.category.DEFAULT"到种类列表，也可以不包含。</p>
<p><span style="color: #800000"><strong>*数据检测</strong></span></p>
<p>类似的，清单文件中的元素以子元素列出数据，例如：<br />
</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;intent-filter&gt;
  &lt;data android:mimeType="video/mpeg" android:scheme="http" /&gt;
  &lt;data android:mimeType="audio/mpeg" android:scheme="http" /&gt;
  . . .
&lt;/intent-filter&gt;
</pre>
</div>
<p>每个元素指定一个URI和数据类型（MIME类型）。它有几个属性scheme、host、port、path、query、fragment对应于URI的每个部分： scheme://host:port/path&#63;query#fragment或者scheme://userInfo@host:port/path&#63;query#fragment。</p>
<p>scheme是content，host是"com.example.project"，port是200，path是"folder/subfolder/etc"。host和port一起构成URI的凭据 （authority），如果host没有指定，port也被忽略。 这几个属性都是可选的，但它们之间并不都是完全独立的。要让authority有意义， scheme必须也要指定。要让path有意义，scheme和authority也都必须要指定。</p>
<p>当比较intent对象和过滤器的URI时，仅仅比较过滤器中出现的URI属性。例如，如果一个过滤器仅指定了scheme，所有有此scheme的URIs都匹配过滤器； 如果一个过滤器指定了scheme和authority，但没有指定path，所有匹配scheme和authority的URIs都通过检测，而不管它们的path； 如果几个属性都指定了，要都匹配才能算是匹配。然而，过滤器中的path可以包含通配符来要求匹配path中的一部分。</p>
<p>元素的type属性指定数据的MIME类型。Intent对象和过滤器都可以用""通配符匹配子类型字段，例如"text/"，"audio/*"表示任何子类型。</p>
<p>数据检测既要检测URI，也要检测数据类型。规则如下：</p>
<p>1.一个Intent对象既不包含URI，也不包含数据类型：仅当过滤器也不指定任何URIs和数据类型时，才不能通过检测；否则都能通过。 2.一个Intent对象包含URI，但不包含数据类型：仅当过滤器也不指定数据类型，同时它们的URI匹配，才能通过检测。例如，mailto:和tel:都不指定实际数据。 3.一个Intent对象包含数据类型，但不包含URI：仅当过滤也只包含数据类型且与Intent相同，才通过检测。 4.一个Intent对象既包含URI，也包含数据类型（或数据类型能够从URI推断出）：数据类型部分，只有与过滤器中之一匹配才算通过；URI部分，它的URI要出现在过滤器中，或者它有content :或file: URI，又或者过滤器没有指定URI。换句话说，如果它的过滤器仅列出了数据类型，组件假定支持content:和file: 。 如果一个Intent能够通过不止一个活动或服务的过滤器，用户可能会被问那个组件被激活。如果没有目标找到，会产生一个异常。</p>
<p>下面写一个例子来通过定义Scheme接收特定URI开启Activity</p>
<p>首先在AndroidManifast.xml要给被指定Scheme的Activity下设置如下参数</p>
<div class="phpstudycode">
<pre class="brush:java;">
    &lt;intent-filter&gt;

        &lt;category android:name="android.intent.category.DEFAULT"&gt;&lt;/category&gt;

        &lt;action android:name="android.intent.action.VIEW"&gt;&lt;/action&gt;

        &lt;data android:host="profile" android:scheme="mxn"/&gt;
    &lt;/intent-filter&gt;

</pre>
</div>
<p>这样即指定了接收Uri的Scheme为“mxn”,host为“profile” 且 Action为View的Intent。 可以利用如下Intent调用Activity： startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse("mxn://profile&#63;uid=1"))); 传递一个参数uid=1.</p>
<p>在设置了filter的activity中接受参数：</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class Test9Activity extends Activity {
  private String uid;
  private static final Uri PROFILE_URI = Uri.parse("mxn://profile");
  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_test8);
    extractUidFromUri();
  }
  private void extractUidFromUri() {
    Uri uri = getIntent().getData();
    if (uri != null && PROFILE_URI.getScheme().equals(uri.getScheme())) {
      uid = uri.getQueryParameter("uid");
      Log.d("=====", "uid from url: " + uid);
    }
  }
}
</pre>
</div>
<p>下面借助Linkify实现超链接，实现微博中@的超链接功能，布局文件如下<br />
</p>
<div class="phpstudycode">
<pre class="brush:java;">
&lt;RelativeLayout
     xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
     android:gravity="center"
     &gt; 

       &lt;TextView
         android:id="@+id/text"
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:textSize="20sp"
         android:text="【谷歌母公司Alphabet市值超苹果：全球第一】据外媒报道，@谷歌 母公司 @Alphabet
         通过公司分拆以及搜索广告业务的持续强势，股价继续攀升。美国时间周一，Alphabet的公司市值已超过了 @苹果 ，
         成为全世界市值最大的公司. www.google.com"
         /&gt;
   &lt;/RelativeLayout&gt;

</pre>
</div>
<p>当需要使自定义模式和内置模式web，phone等一起被识别时，一定要先声明内置模式，然后再声明自定义模式，而且不能在xml中通过autoLink属性声明， 否则自定义模式不起作用。因为在设置内置模式时，会先删除已有模式。 下面使用正则匹配带“@”的用户名，然后作为uid传递到下一个页面：<br />
</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class Test10Activity extends Activity {
  TextView textView ;
  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_test10);
    textView = (TextView) findViewById(R.id.text);
    Pattern p = Pattern.compile("@(\w+&#63;)(&#63;=\W|$)(.)");
    Linkify.addLinks(textView, p, "mxn://profile&#63;uid=");
  }
}
</pre>
</div>
<p>接收的时候跟上面一样：</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class Test9Activity extends Activity {
  private String uid;
  private static final Uri PROFILE_URI = Uri.parse("mxn://profile");
  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_test8);
    extractUidFromUri();
  }
  private void extractUidFromUri() {
    Uri uri = getIntent().getData();
    if (uri != null && PROFILE_URI.getScheme().equals(uri.getScheme())) {
      uid = uri.getQueryParameter("uid");
      Log.d("=====", "uid from url: " + uid);
    }
  }
}
</pre>
</div>
<p>效果如下：</p>
<p>其实在上面的图上可以看到，www.google.com并没有被识别为链接（因为我们没有设置web模式）。需要注意的是，当需要使自定义 模式和内置模式web，phone等一起被识别时，一定要先声明内置模式，然后再声明自定义模式，而且不能在xml中通过autoLink属性声明， 否则自定义模式不起作用。因为在设置内置模式时，会先删除已有模式。</p>
<p>将上面的Java代码改为：</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class Test10Activity extends Activity {
  TextView textView ;
  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_test10);
    textView = (TextView) findViewById(R.id.text);
    Pattern p = Pattern.compile("@(\w+&#63;)(&#63;=\W|$)(.)");
    Linkify.addLinks(textView, Linkify.WEB_URLS);
    Linkify.addLinks(textView, p, "mxn://profile&#63;uid=");
  }
} 

</pre>
</div>
<p>现在就可以同时识别web以及自定义模式了。</p>
<p>同样的，这个超链接是默认颜色，如果需要改变颜色可以在xml中设置android:textColorLink="#1e84fb"，或者在java代码中 设置tv.setLinkTextColor(color);</p>
<p>这时超链接还是带下划线的，如果想去掉，还是使用上面的思路，重写URLSpan，</p>
<div class="phpstudycode">
<pre class="brush:java;">
public class Test10Activity extends Activity {
  TextView textView ;
  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_test10);
    textView = (TextView) findViewById(R.id.text);
    Pattern mentionsPattern = Pattern.compile("@(\w+&#63;)(&#63;=\W|$)(.)");
    String mentionsScheme = String.format("%s/&#63;%s=", "mxn://profile", "uid");
    Linkify.addLinks(textView, Linkify.WEB_URLS);
    Linkify.addLinks(textView, mentionsPattern, mentionsScheme) ;
    stripUnderlines(textView) ;
  }
  private class URLSpanNoUnderline extends URLSpan {
    public URLSpanNoUnderline(String url) {
      super(url);
    }
    @Override public void updateDrawState(TextPaint ds) {
      super.updateDrawState(ds);
      ds.setUnderlineText(false);
    }
  }
  private void stripUnderlines(TextView textView) {
    Spannable s = (Spannable)textView.getText();
    URLSpan[] spans = s.getSpans(0, s.length(), URLSpan.class);
    for (URLSpan span: spans) {
      int start = s.getSpanStart(span);
      int end = s.getSpanEnd(span);
      s.removeSpan(span);
      span = new URLSpanNoUnderline(span.getURL());
      s.setSpan(span, start, end, 0);
    }
    textView.setText(s);
  }
}
</pre>
</div>
<p>Linkify还支持TranformFilter和MatchFilter接口。它们提供一些对目标URI的额外控制和定义匹配字符串，它们的使用如下的框架代码所示： Linkify.addLinks(myTextView, pattern, prefixWith, new MyMatchFilter(), new MyTransformFilter());</p>
<p>使用Match Filter</p>
<p>在你定义的MatchFilter中实现acceptMatch方法，来为RegEx样式匹配添加额外的条件。当一个潜在的匹配发现时，acceptMatch被触发， 匹配的开始点和结束点（包括被查找的整个文本）以参数的形式传入。接下来的代码显示了一个MatchFilter的实现，它取消任何之前已“.”结尾的匹配。</p>
<div class="phpstudycode">
<pre class="brush:java;">
class MyMatchFilter implements MatchFilter {
     public boolean acceptMatch(CharSequence s, int start, int end) {
      return s.charAt(end-1) != '.';
     }
  }
</pre>
</div>
<p><span style="color: #800000"><strong>使用Transform Filter</strong></span></p>
<p>Transform Filter为格式化文本字符串提供了更大的自由度，允许你修改由链接文本自动生成的隐式URI。 减少链接文本和目标URI的耦合能更加自由地决定如何显示数据字符串给用户。</p>
<p>使用Transform Filter，在你定义的TransformFilter中实现transformUrl方法。当Linkify找到正确的匹配后，它会调用transformUrl， 传入使用的RegEx样式和它创建的默认URI字符串。你可以修改匹配的字符串，然后返回一个适合给其它Android应用程序的URI。 利用Transform Filter的修改功能可以实现点击用户名，传递的是用户id的功能，在transformUrl中返回你需要传递的内容</p>
<p>下面的TransformFilter实现将匹配的文本转换成小写的URI：</p>
<div class="phpstudycode">
<pre class="brush:java;">
class MyTransformFilter implements TransformFilter {
    public String transformUrl(Matcher match, String url) {
      return url.toLowerCase();
  }
}
</pre>
</div>
<p>现在我们加上Match Filter和Transform Filter，上面的代码可以修改成如下的样子：</p>
<p></p>
<div class="phpstudycode">
<pre class="brush:java;">
public class Test10Activity extends Activity {
  TextView textView ;
  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_test10);
    textView = (TextView) findViewById(R.id.text);
    Pattern mentionsPattern = Pattern.compile("@(\w+&#63;)(&#63;=\W|$)(.)");
    String mentionsScheme = String.format("%s/&#63;%s=", "mxn://profile", "uid");
    Linkify.addLinks(textView, Linkify.WEB_URLS);
//    Linkify.addLinks(textView, mentionsPattern, mentionsScheme) ;
    Linkify.addLinks(textView, mentionsPattern, mentionsScheme, new Linkify.MatchFilter() {
      @Override
      public boolean acceptMatch(CharSequence s, int start, int end) {
        return s.charAt(end-1) != '.';
      }
    }, new Linkify.TransformFilter() {
      @Override
      public String transformUrl(Matcher match, String url) {
        return url.toLowerCase();
      }
    });
    stripUnderlines(textView) ;
  }
  private class URLSpanNoUnderline extends URLSpan {
    public URLSpanNoUnderline(String url) {
      super(url);
    }
    @Override public void updateDrawState(TextPaint ds) {
      super.updateDrawState(ds);
      ds.setUnderlineText(false);
    }
  }
  private void stripUnderlines(TextView textView) {
    Spannable s = (Spannable)textView.getText();
    URLSpan[] spans = s.getSpans(0, s.length(), URLSpan.class);
    for (URLSpan span: spans) {
      int start = s.getSpanStart(span);
      int end = s.getSpanEnd(span);
      s.removeSpan(span);
      span = new URLSpanNoUnderline(span.getURL());
      s.setSpan(span, start, end, 0);
    }
    textView.setText(s);
  }
}

</pre>
</div>
<p>以上就是本文的全部内容，希望对大家的学习有所帮助。</p>
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/90002.html'>c#网站WebConfig中域名引用示例介绍</a><a>下一篇</a><a href='/php/biji/90004.html'>Android画个时钟玩玩</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>