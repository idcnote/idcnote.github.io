<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>解读ASP.NET 5 & MVC6系列教程（2）：初识项目_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="初识项目<br />
打开VS2015，创建Web项目，选择ASP.NET Web Application，在弹出的窗口里选择ASP.NET 5 Website模板创建项目，图示如下：<br />
<br />
我们可以看到，此时Web Forms\MVC\Web API复选框都" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">解读ASP.NET 5 & MVC6系列教程（2）：初识项目</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>初识项目<br />
打开VS2015，创建Web项目，选择ASP.NET Web Application，在弹出的窗口里选择ASP.NET 5 Website模板创建项目，图示如下：<br />
<br />
我们可以看到，此时Web Forms\MVC\Web API复选框都</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p><b>初识项目</b></p>
<p>打开VS2015，创建Web项目，选择ASP.NET Web Application，在弹出的窗口里选择ASP.NET 5 Website模板创建项目，图示如下：</p>
<p></p>
<p>我们可以看到，此时Web Forms\MVC\Web API复选框都选择不了，原有是因为在ASP.NET 5中做了大量更改，移除了Web Forms功能，将MVC、Web API、Web Pages这些功能合在了一起，所以自然就不需要这些复选框了。另外由于是CTP版，所以目前还没有提供单元测试项目的创建。</p>
<p>新创建的项目在VS的解决方案目录结构和实际文件夹的目录结构分别如下：</p>
<p></p>
<p></p>
<p><span style="color: #ff0000">注意：上图是在VS 预览版中的截图，在新版的RC版本中，默认的客户端构建工具变成了gulp（即配置文件是gulpfile.js），而非原来的grunt了。</span></p>
<p>两个图的差异非常大，我们来一一分析一下这些差异。</p>
<p><b>项目结构差异</b></p>
<p>通过图示，我们可以看到，在根目录中，不仅项目文件从从csproj变成了xproj，还少了很多之前的文件（如web.config），但也多了很多不同的文件以及文件夹，我们先列出这些不同的文件盒文件夹，再来一一讲解这些内容。</p>
<table class="jbboder">
<thead>
<tr>
<th>文件/文件夹</th>
<th>功能描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>config.json</td>
<td>程序的配置文件，类似于web.config。</td>
</tr>
<tr>
<td>project.json</td>
<td>该项目的主要配置，主要是负责程序集、项目部署等方面。部分功能类似于之前的package.config。</td>
</tr>
<tr>
<td>package.json</td>
<td>npm的配置文件，npm是基于Nodejs的包管理器。</td>
</tr>
<tr>
<td>bower.json</td>
<td>Bower管理器的配置文件，Bower是专门用于管理前端项目的包管理器。</td>
</tr>
<tr>
<td>gulpfile.js</td>
<td>是gulp的配置文件，gulp是基于Nodejs的Javascript任务管理器，在ASP.NET5中主要是用于管理NPM和Bower中的内容。</td>
</tr>
<tr>
<td>Stratup.cs</td>
<td>程序启动入口，类似于Global.asax。</td>
</tr>
<tr>
<td>Project_Readme.html</td>
<td>项目说明文件，没啥用。</td>
</tr>
<tr>
<td>wwwroot</td>
<td>静态资源文件（如css、图片、js）的存放目录。</td>
</tr>
<tr>
<td>Dependencies</td>
<td>Bower和NPM的依赖管理包。</td>
</tr>
<tr>
<td>References</td>
<td>程序集引用，和以前的类似，但现在有了版本之分（如ASP.NET 5.0和ASP.NET Core 5.0）。</td>
</tr>
</tbody>
</table>
<p><b>project.json</b></p>
<p>project.json是项目的核心配置文件，示例如下：</p>
<div class="phpstudycode">
<pre class="brush:js;">
{
 "webroot": "wwwroot",
 "version": "1.0.0-*",
 "dependencies": {
 "Microsoft.AspNet.Diagnostics": "1.0.0-beta4",
 "Microsoft.AspNet.Mvc": "6.0.0-beta4",
 "Microsoft.AspNet.Mvc.TagHelpers": "6.0.0-beta4",
 "Microsoft.AspNet.Server.IIS": "1.0.0-beta4",
 "Microsoft.AspNet.Server.WebListener": "1.0.0-beta4",
 "Microsoft.AspNet.StaticFiles": "1.0.0-beta4",
 "Microsoft.AspNet.Tooling.Razor": "1.0.0-beta4",
 "Microsoft.Framework.ConfigurationModel.Json": "1.0.0-beta4",
 "Microsoft.Framework.CodeGenerators.Mvc": "1.0.0-beta4",
 "Microsoft.Framework.Logging": "1.0.0-beta4",
 "Microsoft.Framework.Logging.Console": "1.0.0-beta4",
 "Microsoft.VisualStudio.Web.BrowserLink.Loader": "14.0.0-beta4",
 "Microsoft.Framework.ConfigurationModel.UserSecrets": "1.0.0-beta4"
 },
 "commands": {
 "web": "Microsoft.AspNet.Hosting --server Microsoft.AspNet.Server.WebListener --server.urls http://localhost:5000",
 "gen": "Microsoft.Framework.CodeGeneration"
 },
 "frameworks": {
 "dnx451": { },
 "dnxcore50": { }
 },
 "exclude": [
 "wwwroot",
 "node_modules",
 "bower_components"
 ],
 "publishExclude": [
 "node_modules",
 "bower_components",
 "**.xproj",
 "**.user",
 "**.vspscc"
 ],
 "scripts": {
 "postrestore": [ "npm install", "bower install" ],
 "prepare": [ "gulp copy" ]
 }
}</pre>
</div>
<p>由于该文件的详细参数非常多，具体详细内容请参考http://go.microsoft.com/fwlink/&#63;LinkID=517074 ，在这里我们主要讲解如下3个类型的内容。</p>
<p><b>webroot</b></p>
<p>webroot是指定该web项目的静态文件存放地址，目前是用于在发布的时候讲该目录中的内部发布的正确的位置（详细内容可以在部署发布章节中找到）。注意BookStore解决方案中带有地球图标的<code>wwwroot</code>目录是真实的文件夹路径，我们可以对其进行修改，比如将其修改为<code>wwwroot1</code>，那么相应的webroot的值也应该修改为<code>wwwroot1</code>，因为gulpfile.js里代码要通过<code>project.webroot</code>来使用该目录，以便能够将bower管理的前端库都复制到正确的目录。</p>
<p><b>程序集管理</b></p>
<p>在解决方案的References节点点，我们看到有两个分类，分别是：DNX 4.5.1和DNX Core 5.0，其中DNX Core 5.0就是我们所说的云优化版（即可以在其它操作系统下部署的跨平台版），而DNX 4.5.1则是和之前版本一样的全功能版，这两个版本的程序集是通过<code>dependencies</code>节点进行管理的。</p>
<p>在一级<code>dependencies</code>节点，主要是定义该项目的通用程序集引用以及版本，而不同的版本的程序集则在<code>framworks</code>下的各版本下的<code>dependencies</code>节点进行维护，比如：</p>
<div class="phpstudycode">
<pre class="brush:js;">
"frameworks": {
 "dnx451": {
 "dependencies": {"log4net": "2.0.3"} /* 只在全功能版中引入log4net程序集*/

 },
 "dnxcore50": { }
}</pre>
</div>
<p>上述两种类型的程序集在维护的时候，都有智能提示（包括程序集名称以及版本号），在当定义完自己要用的程序集并保持之后，系统会自动从Nuget上下载所需要的程序集，你也可以通过右键References选择Restore Packages来更新所有的程序集引用。同时你依然可以通过右键References的形式通过Nuget来管理这些程序集。</p>
<p><b>脚本事件</b></p>
<p>新版的VS2015允许我们在build解决方案之前、之后、过程；下载程序集之前、之后；更新程序集之前、之后自定义一些基于Nodejs的自定义事件来执行。该事件在project.json中的定义节点是scripts，示例如下：</p>
<div class="phpstudycode">
<pre class="brush:js;">
"scripts": {
 "postrestore": [ "npm install" ], // 在更新所有的程序集之前执行npm install事件
 "prepare": [ "gulp copy" ]
 // 在打开解决方案之前，执行gulp任务，调用bower的install方法。
}</pre>
</div>
<p>具体的事件名称如下：</p>
<table class="jbboder">
<thead>
<tr>
<th>时机</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>prebuild</td>
<td>构建之前执行</td>
</tr>
<tr>
<td>postbuild</td>
<td>构建之后执行</td>
</tr>
<tr>
<td>prepack</td>
<td>packing之前执行</td>
</tr>
<tr>
<td>postpack</td>
<td>packing之后执行</td>
</tr>
<tr>
<td>prerestore</td>
<td>restoring packages之前执行</td>
</tr>
<tr>
<td>postrestore</td>
<td>restoring packages之后执行</td>
</tr>
</tbody>
</table>
<p><b>package.json</b></p>
<p><code>package.json</code>是<code>NPM</code>管理器的配置文件，由于在VS2015默认就深度集成了<code>Nodejs</code>，而<code>NPM</code>又是<code>Nodejs</code>的默认包管理器，所以所有基于<code>Nodejs</code>的包都要在这里进行配置。该配置文件的默认配置如下：</p>
<div class="phpstudycode">
<pre class="brush:js;">
{
 "name": "ASP.NET",
 "version": "0.0.0",
 "devDependencies": {
 "gulp": "3.8.11",//gulp任务管理器
 "rimraf": "2.2.8" // 递归删除文件的nodejs包
 }
}</pre>
</div>
<p>上述代码中的<code>rimraf</code>是一个递归删除文件的nodejs包，我们也可以引用其他插件，像<code>project.json</code>文件中管理程序集一样，在<code>package.json</code>文件中来管理前端程序的各种包，例如jquery，bootstrap等等，比如我们要安装一个express包，只需要在json文件中添加一个express字符串键，并选择器版本就可以了，系统会自动下载该NPM包并显示在解决方案的<code>Dependencies-&gt;NPM</code>节点下。</p>
<p><span style="color: #ff0000">注意：已经安装的包不能自动移除（即不能通过在JSON中移除配置），需要右键执行该包，并手工卸载。</span></p>
<p><b>bower.json</b></p>
<p>所有的前端包都配置子bower.json文件中，比如你需要的jquery、bootstrap、angular等等，其管理方式与project.json里的程序集和package.json里的npm包一样，都是通过在dependencies节点下声明包的名称和版本来实现的。</p>
<p>我们可以在此声明一个angular包，保存以后就可以看到在解决方案Dependencie-&gt;Bower节点下该angular已经自动下载好了，编译项目，就可以看到在wwroot/lib也可以看到angular文件夹以及相应的文件了。</p>
<p>在bower.json还有一个exportsOverride节点非常重要，他扩展了原来bower的前端文件copy机制，默认情况下bower只会复制main节点定义的文件。但有时候我们要复制的文件可能不止这些，所以grunt-bower-task插件就扩展了该功能，定义了这个exportsOverride节点，其使用规则如下：</p>
<p>如果Bower包定义了main文件节点，就将其复制到wwwroot/lib下。如果Bower包定义了的main节点为空，则将整个包的目录都复制到wwwroot/lib下。如果定义了exportsOverride节点，则只会把该节点指定的文件复制到wwwroot/lib下。</p>
<p>注意，exportsOverride节点中定义的key/value，其中key表示要文件复制目标（即wwwroot/lib下）对应包名下的子目录，value表示源文件目录或文件。例如:</p>
<div class="phpstudycode">
<pre class="brush:js;">
"bootstrap": {
 "js": "dist/js/*.*", //将dist/js/下的所有文件，复制到wwwroot/lib/bootstrap/js目录下
 "css": "dist/css/*.*",
 "fonts": "dist/fonts/*.*"
},
"jquery": {
 "": "jquery.{js,min.js,min.map}" // 将jquery.js，jquery.min.js，jquery.min.map文件复制到wwwroot/lib/jquery目录下
},</pre>
</div>
<p><span style="color: #ff0000">注意：和NPM类似，bower.json里的配置的包，不能自动移除，需要从Bower里卸载该包，并将相关的文件从wwwroot/lib中移除。</span></p>
<p><b>gulpfile.js</b></p>
<p>gulpfile.js是gulp任务管理器的配置文件，默认情况下，该配置文件会把<code>wwwroot/lib</code>目录下的所有文件清除（clean任务），然后重新从<code>bower_components</code>目录中复制一份（copy任务）。</p>
<p>该文件配置的修改会影响到VS里的<code>Task Runner Explorer</code>的显示，如下图所示：</p>
<p></p>
<p>以默认配置为例，该配置文件在Task目录下注册了两个任务，分别是clean和copy，并默认在VS解决方案清除编译以后重新执行clean任务，但我们也可以给该任务绑定任何一个执行时间点，我们可以右键该任务-&gt;绑定-&gt;在构建之前，然后在点击面板左边的刷新按钮，这时候该绑定内容就会同步保存在gulpfile.js的第一行，代码如下：</p>
<div class="phpstudycode">
<pre class="brush:xml;">
/// &lt;binding BeforeBuild='copy' Clean='clean' /&gt;</pre>
</div>
<p>此时，删除wwwroot/lib目录下所有的文件，然后重新编译BookStore项目，就会自动在wwwroot/lib目录下生成所有需要的文件，即将Bower.json里定义的各种包按照配置需求复制到该目录下。</p>
<p><strong>clean任务</strong></p>
<p>clean任务的主要作用，是在编译之前或清理解决方案是，将lib目录下的前端文件全部删除，以便重新copy新的文件。具体分析如下：</p>
<div class="phpstudycode">
<pre class="brush:js;">
var gulp = require("gulp"), // 引用gulp
 rimraf = require("rimraf"),// 引用rimraf
 fs = require("fs"); //引用文件系统

eval("var project = " + fs.readFileSync("./project.json")); //读取project.json配置文件

var paths = {
 bower: "./bower_components/",
 lib: "./" + project.webroot + "/lib/"
};

gulp.task("clean", function (cb) { //注册clean任务
 rimraf(paths.lib, cb); // 递归删除lib目录下的所有文件
});</pre>
</div>
<p><strong>copy任务</strong></p>
<p>copy任务则很简单，将bower_components目录下符合条件的文件复制lib目录下，分析如下：</p>
<div class="phpstudycode">
<pre class="brush:js;">
gulp.task("copy", ["clean"], function () { // 注册copy任务
 var bower = { // 目录对应关系
 "bootstrap": "bootstrap/dist/**/*.{js,map,css,ttf,svg,woff,eot}",
 "bootstrap-touch-carousel": "bootstrap-touch-carousel/dist/**/*.{js,css}",
 "hammer.js": "hammer.js/hammer*.{js,map}",
 "jquery": "jquery/jquery*.{js,map}",
 "jquery-validation": "jquery-validation/jquery.validate.js",
 "jquery-validation-unobtrusive": "jquery-validation-unobtrusive/jquery.validate.unobtrusive.js"
 }

 for (var destinationDir in bower) {
 gulp.src(paths.bower + bower[destinationDir]) // 读取源目录
 .pipe(gulp.dest(paths.lib + destinationDir)); //复制到目标文件夹
 }
});</pre>
</div>
<p><b>Grunt任务</b></p>
<p>VS2015中，虽然默认支持的是Gulp构建工具，但其实还支持Grunt构建工具，使用方式和Gulp类似，要使用Grunt，也需要引用类似的依赖包，示例如下：</p>
<div class="phpstudycode">
<pre class="brush:js;">
{
 "version": "0.0.0",
 "name": "",
 "devDependencies": {
 "grunt": "0.4.5", //grunt任务管理器
 "grunt-bower-task": "0.4.0" // 基于grunt的bower管理插件
 }
}</pre>
</div>
<p>上述代码中的<code>grunt-bower-task</code>是一个基于<code>grunt</code>的<code>bower</code>管理插件，用于自动执行<code>bower</code>的<code>install</code>命令来安装Bower包。</p>
<p><span style="color: #ff0000">注意：已经安装的包不能自动移除（即不能通过在JSON中移除配置），需要右键执行该包，并手工卸载。</span></p>
<p>gruntfile.js是grunt任务管理器的配置文件，要使用grunt，就需要创建gruntfile.js文件，默认情况下，该配置文件只配置了grunt-bower-task插件的任务执行，该插件会读取bower.json配置信息，将相关的包通过<code>bower:install</code>命令都安装到指定的目录下（默认是通过targetDir设置的wwwroot/lib目录。</p>
<p>该文件配置的修改会影响到VS里的<code>Task Runner Explorer</code>的显示，如下图所示：</p>
<p></p>
<p>以默认配置为例，该配置文件注册了一个名为default的任务在该面板里（Alias Tasks列表中）显示，该任务也是Grunt的默认任务名称，但并没有定义该任务在什么时候执行，所以这时候我们可以给该任务绑定一个执行时间点，我们可以右键该任务-&gt;绑定-&gt;在构建之前，然后在点击面板左边的刷新按钮，这时候该绑定内容就会同步保存在gruntfile.js的第一行，代码如下：</p>
<div class="phpstudycode">
<pre class="brush:xml;">
/// &lt;binding BeforeBuild='default' /&gt;</pre>
</div>
<p>此时，删除wwwroot/lib目录下所有的文件，然后重新编译BookStore项目，就会自动在wwwroot/lib目录下生成所有需要的文件，即将Bower.json里定义的各种包按照配置需求复制到该目下。而Tasks中的任务，则是从grunt.loadNpmTasks里加载的包里分析出来的任务，如bower。<br />
我们再来练习一个例子，假设我们编译之前要对wwwroot/css/目录下的site.css文件进行压缩（压缩成site.min.css），我们则可以安装如下方式进行操作：</p>
<p>首先，在package.json里定义一个可以压缩CSS代码的grunt插件：</p>
<div class="phpstudycode">
<pre class="brush:js;">
{
 "version": "0.0.0",
 "name": "",
 "devDependencies": {
 "grunt": "0.4.5",
 "grunt-bower-task": "0.4.0",
 "grunt-contrib-cssmin": "0.12.2" /*新的插件*/
 }
}</pre>
</div>
<p>然后在grunt.initConfig下的bower同级节点下面，添加如下内容：</p>
<div class="phpstudycode">
<pre class="brush:js;">
/*压缩css*/
cssmin: {
 target: {
 options: {
  sourceMap: true,
 },
 files: {
  /*输出文件路径：原始文件路径*/
  'wwwroot/css/site.min.css': 'wwwroot/css/site.css'
 }
 }
}</pre>
</div>
<p>最后再注册此插件，代码如下：</p>
<div class="phpstudycode">
<pre class="brush:js;">
grunt.loadNpmTasks('grunt-contrib-cssmin'); /*压缩css*/</pre>
</div>
<p>这样，你就可以在Task Runner Explorer面板中看到cssmin任务，然后运行它了，当然你也可以将该任务和default任务一起添加到编译构建之前进行执行。代码如下：</p>
<div class="phpstudycode">
<pre class="brush:js;">
/// &lt;binding BeforeBuild='default, cssmin' /&gt;</pre>
</div>
<p>另外，在给一些例子，一个是用于js压缩，一个是用于less编译，代码如下：</p>
<div class="phpstudycode">
<pre class="brush:js;">
/*package.json*/
"grunt-contrib-uglify": "0.9.1",
"grunt-contrib-less": "1.0.1"

/*gruntfile.js*/
/*压缩js*/
uglify: {
 target: {
 options: {
  sourceMap: true,
 },
 files: {
  'wwwroot/Scripts/site.min.js': 'wwwroot/Scripts/site.js'
 }
 }
},
/*编译less*/
less: {
 //开发版（无压缩）
 development: {
 options: {
  sourceMap: true
 },
 files: {
  'wwwroot/Styles/site.css': 'wwwroot/Lesses/site.less'
 }
 },
 //生产版（压缩）
 production: {
 options: {
  compress: true
 },
 files: {
  'wwwroot/Styles/site.min.css': 'wwwroot/Lesses/site.less'
 }
 }
}
/*...*/
grunt.loadNpmTasks('grunt-contrib-uglify'); /*压缩js*/
grunt.loadNpmTasks('grunt-contrib-less'); /*编译less*/</pre>
</div>
<p><span style="color: #0000ff">建议：不要在多个时期都绑定同一种任务。<br />
推荐：grunt还有一个插件用于监控文件的修改，比如兼容css文件的修改，一旦修改了就调用css的压缩命令，详情请参考<code>grunt-contrib-watch</code>插件。</span></p>
<p><b>config.json</b></p>
<p>config.json就是以前的web.config，但是没有web.config拥有各种类型的配置那么强大，其中各种功能的配置都以代码的形式转移到Startup.cs文件中了；另外一部分信息配置内容，则放在config.json文件中以json的格式进行保存。</p>
<p>注意，该文件的信息默认并没有自动加载，而是需要自己手工加载该配置信息，代码如下：</p>
<div class="phpstudycode">
<pre class="brush:csharp;">
//Startup.cs类的构造函数中
Configuration = new Configuration()
  .AddJsonFile("config.json")
  .AddEnvironmentVariables();</pre>
</div>
<p>通过Configuration实例加载该配置文件，保存在Configuration属性中，以便可以在其它地方进行使用，而使用时候的key值，则是按照层级来定义的，以如下默认内容来说：</p>
<div class="phpstudycode">
<pre class="brush:js;">
{
 "AppSettings": {
 "SiteTitle": "WebDemo01"
 }
}</pre>
</div>
<p>要获取链接字符串，则需要使用如下key值：</p>
<div class="phpstudycode">
<pre class="brush:csharp;">
var connString = Configuration.Get("AppSettings:SiteTitle");</pre>
</div>
<p>使用起来，没有web.config方便了，但是为了兼容其它操作系统，只能这样了。</p>
<p><span style="color: #ff0000">注意：在ASP.NET5中，配置信息不仅支持json格式，还支持ini、xml等格式，具体详细请参考后续的配置信息管理章节。</span></p>
<p><b>Startup.cs</b></p>
<p><code>Startup.cs</code>是整个程序的启动入口，类似于Global.asax，和Global.asax文件一样，起到全局配置信息的作用。我们来分析一下该文件的几个重要作用。</p>
<p>首先在构造函数中初始化基础配置信息（关于详细的配置信息内容请参考配置信息管理章节），注意这里的初始化后的配置信息绑定到一个<code>Configuration</code>属性上了，以便另外两个方法在后期进行使用，如果你要在其它类中进行使用，则需要将该实例保存到其它地方（如静态变量）。</p>
<p><code>ConfigureServices</code>方法是依赖注入的核心，在方法的传入参数services中，首先保存了默认依赖注入里定义的类型定义，然后我们在这个方法里，可以继续注册依赖注入的类型定义，关于依赖注入的详细内容，可以阅读依赖注入章节。</p>
<p>同时一些重要的功能需要开启的话，也需要在这里开启，比如添加Mvc模块，就需要使用如下调用语句：</p>
<div class="phpstudycode">
<pre class="brush:csharp;">
services.AddMvc();</pre>
</div>
<p>原因是因为，在新版的ASP.NET 5中，除了最基础的模块以外，绝大部分模块都是纯组件化的，这里称为Middleware，而组件在使用的时候首先需要先添加该模块才能使用。再比如，添加EF模块的话，需要调用</p>
<div class="phpstudycode">
<pre class="brush:csharp;">
services.AddEntityFramework()方法。</pre>
</div>
<p>而另外一个Configure方法，顾名思义是对各种Middleware组件进行配置的地方，一般来说，配置模块的方法都是调用类似app.UseXXX()这样的方法，如使用静态文件处理流程，则调用如下语句即可：</p>
<div class="phpstudycode">
<pre class="brush:csharp;">
app.UseStaticFiles();</pre>
</div>
<p>如果要使用Mvc的功能，则需要使用app.UseMvc方法，在调用这些方法时，可以配置并传入响应的参数。</p>
<p>注意，ConfigureServices里用到的services.AddXXX()类型的方法和Configure方法里用到的app.UseXXX()类型的方法都是扩展方法，AddXXX()方法是在IServiceCollection接口上进行扩展的，而UseXXX()方法则是在IApplicationBuilder接口上扩展的。</p>
<p><span style="color: #0000ff">关于该文件中提到的依赖注入、以及Configure方法中的3个类型的参数：IApplicationBuilder、IHostingEnvironment、ILoggerFactory；我们会在后续的章节中进行详细讲解。</span></p>
<p><b>其它</b></p>
<p>通过查看，可以发现，Views目录下的web.config也被移除了，在RC版中，要统一引用命名空间，需要在 _ViewStart.cshtml 或者 _GlobalImport.cshtml 文件中，后续章节我们会讲到。</p>
<p>我们不用做任何修改，F5运行项目即可运行，由于默认使用的是IIS Express，所以会自动打开新网站首页。如果不是IIS Express，请阅读后续的编译与部署章节。</p>
<p><b>关于上述json配置文件的scheme介绍</b></p>
<p>关于上述配置文件（含global.json、project.json、config.json、package.json、bower.json）的scheme定义，以及js参数配置的定义，请访问<code>http://schemastore.org/json/</code>进行查看。</p>
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/81754.html'>使用updatepanel局部刷新实现注册时对用户名的检测示例</a><a>下一篇</a><a href='/php/biji/81756.html'>为什么win10总是重启？win10重启的原因以及解决办法</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>