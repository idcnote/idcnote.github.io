<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>YII Framework学习之request与response用法(基于CHttpRequest响应)_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="本文实例讲述了YII Framework学习之request与response用法。分享给大家供大家参考，具体如下：<br />
YII中提供了CHttpRequest，封装了请求常用的方法。具体代码如下：<br />
<br />
<br />
class CHttpRequ" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">YII Framework学习之request与response用法(基于CHttpRequest响应)</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>本文实例讲述了YII Framework学习之request与response用法。分享给大家供大家参考，具体如下：<br />
YII中提供了CHttpRequest，封装了请求常用的方法。具体代码如下：<br />
<br />
<br />
class CHttpRequ</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>本文实例讲述了YII Framework学习之request与response用法。分享给大家供大家参考，具体如下：</p>
<p>YII中提供了CHttpRequest，封装了请求常用的方法。具体代码如下：</p>
<div class="phpstudycode">
<pre class="brush:php;">
class CHttpRequest extends CApplicationComponent
{
  public $enableCookieValidation=false;
  public $enableCsrfValidation=false;
  public $csrfTokenName='YII_CSRF_TOKEN';
  public $csrfCookie;
  private $_requestUri;
  private $_pathInfo;
  private $_scriptFile;
  private $_scriptUrl;
  private $_hostInfo;
  private $_baseUrl;
  private $_cookies;
  private $_preferredLanguage;
  private $_csrfToken;
  private $_deleteParams;
  private $_putParams;
  public function init()
  {
    parent::init();
    $this-&gt;normalizeRequest();
  }
  protected function normalizeRequest()
  {
    // normalize request
    if(function_exists('get_magic_quotes_gpc') && get_magic_quotes_gpc())
    {
      if(isset($_GET))
        $_GET=$this-&gt;stripSlashes($_GET);
      if(isset($_POST))
        $_POST=$this-&gt;stripSlashes($_POST);
      if(isset($_REQUEST))
        $_REQUEST=$this-&gt;stripSlashes($_REQUEST);
      if(isset($_COOKIE))
        $_COOKIE=$this-&gt;stripSlashes($_COOKIE);
    }
    if($this-&gt;enableCsrfValidation)
      Yii::app()-&gt;attachEventHandler('onBeginRequest',array($this,'validateCsrfToken'));
  }
  public function stripSlashes(&$data)
  {
    return is_array($data)&#63;array_map(array($this,'stripSlashes'),$data):stripslashes($data);
  }
  public function getParam($name,$defaultValue=null)
  {
    return isset($_GET[$name]) &#63; $_GET[$name] : (isset($_POST[$name]) &#63; $_POST[$name] : $defaultValue);
  }
  public function getQuery($name,$defaultValue=null)
  {
    return isset($_GET[$name]) &#63; $_GET[$name] : $defaultValue;
  }
  public function getPost($name,$defaultValue=null)
  {
    return isset($_POST[$name]) &#63; $_POST[$name] : $defaultValue;
  }
  public function getDelete($name,$defaultValue=null)
  {
    if($this-&gt;_deleteParams===null)
      $this-&gt;_deleteParams=$this-&gt;getIsDeleteRequest() &#63; $this-&gt;getRestParams() : array();
    return isset($this-&gt;_deleteParams[$name]) &#63; $this-&gt;_deleteParams[$name] : $defaultValue;
  }
  public function getPut($name,$defaultValue=null)
  {
    if($this-&gt;_putParams===null)
      $this-&gt;_putParams=$this-&gt;getIsPutRequest() &#63; $this-&gt;getRestParams() : array();
    return isset($this-&gt;_putParams[$name]) &#63; $this-&gt;_putParams[$name] : $defaultValue;
  }
  protected function getRestParams()
  {
    $result=array();
    if(function_exists('mb_parse_str'))
      mb_parse_str(file_get_contents('php://input'), $result);
    else
      parse_str(file_get_contents('php://input'), $result);
    return $result;
  }
  public function getUrl()
  {
    return $this-&gt;getRequestUri();
  }
  public function getHostInfo($schema='')
  {
    if($this-&gt;_hostInfo===null)
    {
      if($secure=$this-&gt;getIsSecureConnection())
        $http='https';
      else
        $http='http';
      if(isset($_SERVER['HTTP_HOST']))
        $this-&gt;_hostInfo=$http.'://'.$_SERVER['HTTP_HOST'];
      else
      {
        $this-&gt;_hostInfo=$http.'://'.$_SERVER['SERVER_NAME'];
        $port=$secure &#63; $this-&gt;getSecurePort() : $this-&gt;getPort();
        if(($port!==80 && !$secure) || ($port!==443 && $secure))
          $this-&gt;_hostInfo.=':'.$port;
      }
    }
    if($schema!=='')
    {
      $secure=$this-&gt;getIsSecureConnection();
      if($secure && $schema==='https' || !$secure && $schema==='http')
        return $this-&gt;_hostInfo;
      $port=$schema==='https' &#63; $this-&gt;getSecurePort() : $this-&gt;getPort();
      if($port!==80 && $schema==='http' || $port!==443 && $schema==='https')
        $port=':'.$port;
      else
        $port='';
      $pos=strpos($this-&gt;_hostInfo,':');
      return $schema.substr($this-&gt;_hostInfo,$pos,strcspn($this-&gt;_hostInfo,':',$pos+1)+1).$port;
    }
    else
      return $this-&gt;_hostInfo;
  }
  public function setHostInfo($value)
  {
    $this-&gt;_hostInfo=rtrim($value,'/');
  }
  public function getBaseUrl($absolute=false)
  {
    if($this-&gt;_baseUrl===null)
      $this-&gt;_baseUrl=rtrim(dirname($this-&gt;getScriptUrl()),'\\/');
    return $absolute &#63; $this-&gt;getHostInfo() . $this-&gt;_baseUrl : $this-&gt;_baseUrl;
  }
  public function setBaseUrl($value)
  {
    $this-&gt;_baseUrl=$value;
  }
  public function getScriptUrl()
  {
    if($this-&gt;_scriptUrl===null)
    {
      $scriptName=basename($_SERVER['SCRIPT_FILENAME']);
      if(basename($_SERVER['SCRIPT_NAME'])===$scriptName)
        $this-&gt;_scriptUrl=$_SERVER['SCRIPT_NAME'];
      else if(basename($_SERVER['PHP_SELF'])===$scriptName)
        $this-&gt;_scriptUrl=$_SERVER['PHP_SELF'];
      else if(isset($_SERVER['ORIG_SCRIPT_NAME']) && basename($_SERVER['ORIG_SCRIPT_NAME'])===$scriptName)
        $this-&gt;_scriptUrl=$_SERVER['ORIG_SCRIPT_NAME'];
      else if(($pos=strpos($_SERVER['PHP_SELF'],'/'.$scriptName))!==false)
        $this-&gt;_scriptUrl=substr($_SERVER['SCRIPT_NAME'],0,$pos).'/'.$scriptName;
      else if(isset($_SERVER['DOCUMENT_ROOT']) && strpos($_SERVER['SCRIPT_FILENAME'],$_SERVER['DOCUMENT_ROOT'])===0)
        $this-&gt;_scriptUrl=str_replace('\\','/',str_replace($_SERVER['DOCUMENT_ROOT'],'',$_SERVER['SCRIPT_FILENAME']));
      else
        throw new CException(Yii::t('yii','CHttpRequest is unable to determine the entry script URL.'));
    }
    return $this-&gt;_scriptUrl;
  }
  public function setScriptUrl($value)
  {
    $this-&gt;_scriptUrl='/'.trim($value,'/');
  }
  public function getPathInfo()
  {
    if($this-&gt;_pathInfo===null)
    {
      $pathInfo=$this-&gt;getRequestUri();
      if(($pos=strpos($pathInfo,'&#63;'))!==false)
        $pathInfo=substr($pathInfo,0,$pos);
      $pathInfo=urldecode($pathInfo);
      $scriptUrl=$this-&gt;getScriptUrl();
      $baseUrl=$this-&gt;getBaseUrl();
      if(strpos($pathInfo,$scriptUrl)===0)
        $pathInfo=substr($pathInfo,strlen($scriptUrl));
      else if($baseUrl==='' || strpos($pathInfo,$baseUrl)===0)
        $pathInfo=substr($pathInfo,strlen($baseUrl));
      else if(strpos($_SERVER['PHP_SELF'],$scriptUrl)===0)
        $pathInfo=substr($_SERVER['PHP_SELF'],strlen($scriptUrl));
      else
        throw new CException(Yii::t('yii','CHttpRequest is unable to determine the path info of the request.'));
      $this-&gt;_pathInfo=trim($pathInfo,'/');
    }
    return $this-&gt;_pathInfo;
  }
  public function getRequestUri()
  {
    if($this-&gt;_requestUri===null)
    {
      if(isset($_SERVER['HTTP_X_REWRITE_URL'])) // IIS
        $this-&gt;_requestUri=$_SERVER['HTTP_X_REWRITE_URL'];
      else if(isset($_SERVER['REQUEST_URI']))
      {
        $this-&gt;_requestUri=$_SERVER['REQUEST_URI'];
        if(isset($_SERVER['HTTP_HOST']))
        {
          if(strpos($this-&gt;_requestUri,$_SERVER['HTTP_HOST'])!==false)
            $this-&gt;_requestUri=preg_replace('/^\w+:\/\/[^\/]+/','',$this-&gt;_requestUri);
        }
        else
          $this-&gt;_requestUri=preg_replace('/^(http|https):\/\/[^\/]+/i','',$this-&gt;_requestUri);
      }
      else if(isset($_SERVER['ORIG_PATH_INFO'])) // IIS 5.0 CGI
      {
        $this-&gt;_requestUri=$_SERVER['ORIG_PATH_INFO'];
        if(!empty($_SERVER['QUERY_STRING']))
          $this-&gt;_requestUri.='&#63;'.$_SERVER['QUERY_STRING'];
      }
      else
        throw new CException(Yii::t('yii','CHttpRequest is unable to determine the request URI.'));
    }
    return $this-&gt;_requestUri;
  }
  public function getQueryString()
  {
    return isset($_SERVER['QUERY_STRING'])&#63;$_SERVER['QUERY_STRING']:'';
  }
  public function getIsSecureConnection()
  {
    return isset($_SERVER['HTTPS']) && !strcasecmp($_SERVER['HTTPS'],'on');
  }
  public function getRequestType()
  {
    return strtoupper(isset($_SERVER['REQUEST_METHOD'])&#63;$_SERVER['REQUEST_METHOD']:'GET');
  }
  public function getIsPostRequest()
  {
    return isset($_SERVER['REQUEST_METHOD']) && !strcasecmp($_SERVER['REQUEST_METHOD'],'POST');
  }
  public function getIsDeleteRequest()
  {
    return isset($_SERVER['REQUEST_METHOD']) && !strcasecmp($_SERVER['REQUEST_METHOD'],'DELETE');
  }
  public function getIsPutRequest()
  {
    return isset($_SERVER['REQUEST_METHOD']) && !strcasecmp($_SERVER['REQUEST_METHOD'],'PUT');
  }
  public function getIsAjaxRequest()
  {
    return isset($_SERVER['HTTP_X_REQUESTED_WITH']) && $_SERVER['HTTP_X_REQUESTED_WITH']==='XMLHttpRequest';
  }
  public function getServerName()
  {
    return $_SERVER['SERVER_NAME'];
  }
  public function getServerPort()
  {
    return $_SERVER['SERVER_PORT'];
  }
  public function getUrlReferrer()
  {
    return isset($_SERVER['HTTP_REFERER'])&#63;$_SERVER['HTTP_REFERER']:null;
  }
  public function getUserAgent()
  {
    return isset($_SERVER['HTTP_USER_AGENT'])&#63;$_SERVER['HTTP_USER_AGENT']:null;
  }
  public function getUserHostAddress()
  {
    return isset($_SERVER['REMOTE_ADDR'])&#63;$_SERVER['REMOTE_ADDR']:'127.0.0.1';
  }
  public function getUserHost()
  {
    return isset($_SERVER['REMOTE_HOST'])&#63;$_SERVER['REMOTE_HOST']:null;
  }
  public function getScriptFile()
  {
    if($this-&gt;_scriptFile!==null)
      return $this-&gt;_scriptFile;
    else
      return $this-&gt;_scriptFile=realpath($_SERVER['SCRIPT_FILENAME']);
  }
  public function getBrowser($userAgent=null)
  {
    return get_browser($userAgent,true);
  }
  public function getAcceptTypes()
  {
    return isset($_SERVER['HTTP_ACCEPT'])&#63;$_SERVER['HTTP_ACCEPT']:null;
  }
  private $_port;
  public function getPort()
  {
    if($this-&gt;_port===null)
      $this-&gt;_port=!$this-&gt;getIsSecureConnection() && isset($_SERVER['SERVER_PORT']) &#63; (int)$_SERVER['SERVER_PORT'] : 80;
    return $this-&gt;_port;
  }
  public function setPort($value)
  {
    $this-&gt;_port=(int)$value;
    $this-&gt;_hostInfo=null;
  }
  private $_securePort;
  public function getSecurePort()
  {
    if($this-&gt;_securePort===null)
      $this-&gt;_securePort=$this-&gt;getIsSecureConnection() && isset($_SERVER['SERVER_PORT']) &#63; (int)$_SERVER['SERVER_PORT'] : 443;
    return $this-&gt;_securePort;
  }
  public function setSecurePort($value)
  {
    $this-&gt;_securePort=(int)$value;
    $this-&gt;_hostInfo=null;
  }
  public function getCookies()
  {
    if($this-&gt;_cookies!==null)
      return $this-&gt;_cookies;
    else
      return $this-&gt;_cookies=new CCookieCollection($this);
  }
  public function redirect($url,$terminate=true,$statusCode=302)
  {
    if(strpos($url,'/')===0)
      $url=$this-&gt;getHostInfo().$url;
    header('Location: '.$url, true, $statusCode);
    if($terminate)
      Yii::app()-&gt;end();
  }
  public function getPreferredLanguage()
  {
    if($this-&gt;_preferredLanguage===null)
    {
      if(isset($_SERVER['HTTP_ACCEPT_LANGUAGE']) && ($n=preg_match_all('/([\w\-_]+)\s*(;\s*q\s*=\s*(\d*\.\d*))&#63;/',$_SERVER['HTTP_ACCEPT_LANGUAGE'],$matches))&gt;0)
      {
        $languages=array();
        for($i=0;$i&lt;$n;++$i)
          $languages[$matches[1][$i]]=empty($matches[3][$i]) &#63; 1.0 : floatval($matches[3][$i]);
        arsort($languages);
        foreach($languages as $language=&gt;$pref)
          return $this-&gt;_preferredLanguage=CLocale::getCanonicalID($language);
      }
      return $this-&gt;_preferredLanguage=false;
    }
    return $this-&gt;_preferredLanguage;
  }
  public function sendFile($fileName,$content,$mimeType=null,$terminate=true)
  {
    if($mimeType===null)
    {
      if(($mimeType=CFileHelper::getMimeTypeByExtension($fileName))===null)
        $mimeType='text/plain';
    }
    header('Pragma: public');
    header('Expires: 0');
    header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
    header("Content-type: $mimeType");
    if(ini_get("output_handler")=='')
      header('Content-Length: '.(function_exists('mb_strlen') &#63; mb_strlen($content,'8bit') : strlen($content)));
    header("Content-Disposition: attachment; filename=\"$fileName\"");
    header('Content-Transfer-Encoding: binary');
    if($terminate)
    {
      // clean up the application first because the file downloading could take long time
      // which may cause timeout of some resources (such as DB connection)
      Yii::app()-&gt;end(0,false);
      echo $content;
      exit(0);
    }
    else
      echo $content;
  }
  public function xSendFile($filePath, $options=array())
  {
    if(!is_file($filePath))
      return false;
    if(!isset($options['saveName']))
      $options['saveName']=basename($filePath);
    if(!isset($options['mimeType']))
    {
      if(($options['mimeType']=CFileHelper::getMimeTypeByExtension($filePath))===null)
        $options['mimeType']='text/plain';
    }
    if(!isset($options['xHeader']))
      $options['xHeader']='X-Sendfile';
    header('Content-type: '.$options['mimeType']);
    header('Content-Disposition: attachment; filename="'.$options['saveName'].'"');
    header(trim($options['xHeader']).': '.$filePath);
    if(!isset($options['terminate']) || $options['terminate'])
      Yii::app()-&gt;end();
    return true;
  }
  public function getCsrfToken()
  {
    if($this-&gt;_csrfToken===null)
    {
      $cookie=$this-&gt;getCookies()-&gt;itemAt($this-&gt;csrfTokenName);
      if(!$cookie || ($this-&gt;_csrfToken=$cookie-&gt;value)==null)
      {
        $cookie=$this-&gt;createCsrfCookie();
        $this-&gt;_csrfToken=$cookie-&gt;value;
        $this-&gt;getCookies()-&gt;add($cookie-&gt;name,$cookie);
      }
    }
    return $this-&gt;_csrfToken;
  }
  protected function createCsrfCookie()
  {
    $cookie=new CHttpCookie($this-&gt;csrfTokenName,sha1(uniqid(mt_rand(),true)));
    if(is_array($this-&gt;csrfCookie))
    {
      foreach($this-&gt;csrfCookie as $name=&gt;$value)
        $cookie-&gt;$name=$value;
    }
    return $cookie;
  }
  public function validateCsrfToken($event)
  {
    if($this-&gt;getIsPostRequest())
    {
      // only validate POST requests
      $cookies=$this-&gt;getCookies();
      if($cookies-&gt;contains($this-&gt;csrfTokenName) && isset($_POST[$this-&gt;csrfTokenName]))
      {
        $tokenFromCookie=$cookies-&gt;itemAt($this-&gt;csrfTokenName)-&gt;value;
        $tokenFromPost=$_POST[$this-&gt;csrfTokenName];
        $valid=$tokenFromCookie===$tokenFromPost;
      }
      else
        $valid=false;
      if(!$valid)
        throw new CHttpException(400,Yii::t('yii','The CSRF token could not be verified.'));
    }
  }
}

</pre>
</div>
<p>request操作的相关方法，一目了然。</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function init()
{
  parent::init();
  $this-&gt;normalizeRequest();
}
protected function normalizeRequest()
{
  // normalize request
  if(function_exists('get_magic_quotes_gpc') && get_magic_quotes_gpc())
  {
    if(isset($_GET))
      $_GET=$this-&gt;stripSlashes($_GET);
    if(isset($_POST))
      $_POST=$this-&gt;stripSlashes($_POST);
    if(isset($_REQUEST))
      $_REQUEST=$this-&gt;stripSlashes($_REQUEST);
    if(isset($_COOKIE))
      $_COOKIE=$this-&gt;stripSlashes($_COOKIE);
  }
  if($this-&gt;enableCsrfValidation)
    Yii::app()-&gt;attachEventHandler('onBeginRequest',array($this,'validateCsrfToken'));
}
public function stripSlashes(&$data)
{
  return is_array($data)&#63;array_map(array($this,'stripSlashes'),$data):stripslashes($data);
}

</pre>
</div>
<p>可以看到yii对$_GET\$_POST\$_REQUEST\$_COOKIE进行了必要的过滤处理，所以可以放心的使用数据。</p>
<p>常用的有如下方法：</p>
<p>获取get参数</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getParam($name,$defaultValue=null)

</pre>
</div>
<p>获取get参数</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getQuery($name,$defaultValue=null)

</pre>
</div>
<p>获取post数据</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getPost($name,$defaultValue=null)

</pre>
</div>
<p>获取请求的url</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getUrl()

</pre>
</div>
<p>获取主机信息</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getHostInfo($schema='')

</pre>
</div>
<p>设置</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function setHostInfo($value)

</pre>
</div>
<p>获取根目录</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getBaseUrl($absolute=false)

</pre>
</div>
<p>获取当前url</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getScriptUrl()

</pre>
</div>
<p>获取请求的url</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getRequestUri()

</pre>
</div>
<p>获取querystring</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getQueryString()

</pre>
</div>
<p>判断是否是https</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getIsSecureConnection()

</pre>
</div>
<p>获取请求类型</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getRequestType()

</pre>
</div>
<p>是否是post请求</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getIsPostRequest()

</pre>
</div>
<p>是否是ajax请求</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getIsAjaxRequest()

</pre>
</div>
<p>获取服务器名称</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getServerName()

</pre>
</div>
<p>获取服务端口</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getServerPort()

</pre>
</div>
<p>获取引用路径</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getUrlReferrer()

</pre>
</div>
<p>获取用户ip地址</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getUserHostAddress()

</pre>
</div>
<p>获取用户主机名称</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getUserHost()

</pre>
</div>
<p>获取执行脚本名称</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getScriptFile()

</pre>
</div>
<p>获取cookie</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getCookies()

</pre>
</div>
<p>重定向</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function redirect($url,$terminate=true,$statusCode=302)

</pre>
</div>
<p>设置下载文件头</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function sendFile($fileName,$content,$mimeType=null,$terminate=true)
{
if($mimeType===null)
{
if(($mimeType=CFileHelper::getMimeTypeByExtension($fileName))===null)
$mimeType='text/plain';
}
header('Pragma: public');
header('Expires: 0');
header('Cache-Control: must-revalidate, post-check=0, pre-check=0');
header("Content-type: $mimeType");
if(ini_get("output_handler")=='')
header('Content-Length: '.(function_exists('mb_strlen') &#63; mb_strlen($content,'8bit') : strlen($content)));
header("Content-Disposition: attachment; filename=\"$fileName\"");
header('Content-Transfer-Encoding: binary');
if($terminate)
{
// clean up the application first because the file downloading could take long time
// which may cause timeout of some resources (such as DB connection)
Yii::app()-&gt;end(0,false);
echo $content;
exit(0);
}
else
echo $content;
}
public function xSendFile($filePath, $options=array())
{
if(!is_file($filePath))
return false;
if(!isset($options['saveName']))
$options['saveName']=basename($filePath);
if(!isset($options['mimeType']))
{
if(($options['mimeType']=CFileHelper::getMimeTypeByExtension($filePath))===null)
$options['mimeType']='text/plain';
}
if(!isset($options['xHeader']))
$options['xHeader']='X-Sendfile';
header('Content-type: '.$options['mimeType']);
header('Content-Disposition: attachment; filename="'.$options['saveName'].'"');
header(trim($options['xHeader']).': '.$filePath);
if(!isset($options['terminate']) || $options['terminate'])
Yii::app()-&gt;end();
return true;
}

</pre>
</div>
<p>为了防止csrf，yii提供了相应的方法<br />
（<br />
CSRF（Cross-site request forgery），中文名称：跨站请求伪造，也被称为：one click attack/session riding，缩写为：CSRF/XSRF。<br />
《CSRF的攻击方式详解 黑客必备知识》<br />
）</p>
<div class="phpstudycode">
<pre class="brush:php;">
public function getCsrfToken()
{
if($this-&gt;_csrfToken===null)
{
$cookie=$this-&gt;getCookies()-&gt;itemAt($this-&gt;csrfTokenName);
if(!$cookie || ($this-&gt;_csrfToken=$cookie-&gt;value)==null)
{
$cookie=$this-&gt;createCsrfCookie();
$this-&gt;_csrfToken=$cookie-&gt;value;
$this-&gt;getCookies()-&gt;add($cookie-&gt;name,$cookie);
}
}
return $this-&gt;_csrfToken;
}
protected function createCsrfCookie()
{
$cookie=new CHttpCookie($this-&gt;csrfTokenName,sha1(uniqid(mt_rand(),true)));
if(is_array($this-&gt;csrfCookie))
{
foreach($this-&gt;csrfCookie as $name=&gt;$value)
$cookie-&gt;$name=$value;
}
return $cookie;
}
public function validateCsrfToken($event)
{
if($this-&gt;getIsPostRequest())
{
// only validate POST requests
$cookies=$this-&gt;getCookies();
if($cookies-&gt;contains($this-&gt;csrfTokenName) && isset($_POST[$this-&gt;csrfTokenName]))
{
$tokenFromCookie=$cookies-&gt;itemAt($this-&gt;csrfTokenName)-&gt;value;
$tokenFromPost=$_POST[$this-&gt;csrfTokenName];
$valid=$tokenFromCookie===$tokenFromPost;
}
else
$valid=false;
if(!$valid)
throw new CHttpException(400,Yii::t('yii','The CSRF token could not be verified.'));
}
}

</pre>
</div>
<p>对于$_GET的使用，不仅仅可以使用$_GET和以上提供的相关方法，在action中，可以绑定到action的方法参数。</p>
<p>http://www.yiiframework.com/doc/guide/1.1/zh_cn/basics.controller</p>
<p>这里就一并罗列官方给出的说明。</p>
<p>从版本 1.1.4 开始，Yii 提供了对自动动作参数绑定的支持。 就是说，控制器动作可以定义命名的参数，参数的值将由 Yii 自动从 $_GET 填充。</p>
<p>为了详细说明此功能，假设我们需要为 PostController 写一个 create 动作。此动作需要两个参数：</p>
<p>category: 一个整数，代表帖子（post）要发表在的那个分类的ID。<br />
language: 一个字符串，代表帖子所使用的语言代码。<br />
从 $_GET 中提取参数时，我们可以不再下面这种无聊的代码了：</p>
<div class="phpstudycode">
<pre class="brush:php;">
class PostController extends CController
{
  public function actionCreate()
  {
    if(isset($_GET['category']))
      $category=(int)$_GET['category'];
    else
      throw new CHttpException(404,'invalid request');
    if(isset($_GET['language']))
      $language=$_GET['language'];
    else
      $language='en';
    // ... fun code starts here ...
  }
}

</pre>
</div>
<p>现在使用动作参数功能，我们可以更轻松的完成任务：</p>
<div class="phpstudycode">
<pre class="brush:php;">
class PostController extends CController
{
  public function actionCreate($category, $language='en')
  {
    $category=(int)$category;
    // ... fun code starts here ...
  }
}

</pre>
</div>
<p>注意我们在动作方法 actionCreate 中添加了两个参数。 这些参数的名字必须和我们想要从 $_GET 中提取的名字一致。 当用户没有在请求中指定 $language 参数时，这个参数会使用默认值 en 。 由于 $category 没有默认值，如果用户没有在 $_GET 中提供 category 参数， 将会自动抛出一个 CHttpException (错误代码 400) 异常。 Starting from version 1.1.5, Yii also supports array type detection for action parameters. This is done by PHP type hinting using the syntax like the following:</p>
<div class="phpstudycode">
<pre class="brush:php;">
class PostController extends CController
{
  public function actionCreate(array $categories)
  {
    // Yii will make sure $categories be an array
  }
}

</pre>
</div>
<p>That is, we add the keyword array in front of $categories in the method parameter declaration. By doing so, if $_GET['categories'] is a simple string, it will be converted into an array consisting of that string.</p>
<p>Note: If a parameter is declared without the array type hint, it means the parameter must be a scalar (i.e., not an array). In this case, passing in an array parameter via $_GET would cause an HTTP exception.</p>
<p>request的使用你只要保持和以前在php中的使用方式一样，在yii中是不会出错的</p>
<p>更多关于Yii相关内容感兴趣的读者可查看本站专题：《Yii框架入门及常用技巧总结》、《php优秀开发框架总结》、《smarty模板入门基础教程》、《php日期与时间用法总结》、《php面向对象程序设计入门教程》、《php字符串(string)用法总结》、《php+mysql数据库操作入门教程》及《php常见数据库操作技巧汇总》</p>
<p>希望本文所述对大家基于Yii框架的PHP程序设计有所帮助。</p>
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/104100.html'>HTML5 placeholder属性详解</a><a>下一篇</a><a href='/php/biji/104102.html'>fedora21系统怎么把英语改变中文？</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>