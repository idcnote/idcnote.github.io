<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>PHP+jQuery 注册模块开发详解_PHP教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="写了一个简单的PHP+jQuery注册模块，需要填写的栏目包括用户名、邮箱、密码、重复密码和验证码，其中每个栏目需要具备的功能和要求如下图：<br />
<br />
在做这个模块的时候，很大程度上借鉴了" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP简介			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jianjie/1.html">PHP简介</a></li><li><a href="/php/jianjie/2.html">PHP用途</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP基本语法			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yufa/3.html">分离HTML</a></li><li><a href="/php/yufa/4.html">指令分隔符</a></li><li><a href="/php/yufa/5.html">PHP注释</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类型			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpleixing/6.html">PHP类型简介</a></li><li><a href="/php/phpleixing/7.html">PHP类型之布尔类型</a></li><li><a href="/php/phpleixing/8.html">PHP类型之整型</a></li><li><a href="/php/phpleixing/9.html">PHP类型之浮点型</a></li><li><a href="/php/phpleixing/10.html">PHP类型之字符串</a></li><li><a href="/php/phpleixing/11.html">PHP类型之数组</a></li><li><a href="/php/phpleixing/12.html">PHP类型之对象</a></li><li><a href="/php/phpleixing/13.html">PHP类型之资源类型</a></li><li><a href="/php/phpleixing/14.html">PHP类型之NULL</a></li><li><a href="/php/phpleixing/15.html">PHP类型之伪类型</a></li><li><a href="/php/phpleixing/16.html">PHP类型之类型判别</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP变量			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbianliang/17.html">PHP变量之基础</a></li><li><a href="/php/phpbianliang/18.html">PHP变量之预定义变量</a></li><li><a href="/php/phpbianliang/19.html">PHP变量之变量范围</a></li><li><a href="/php/phpbianliang/20.html">PHP变量之可变变量</a></li><li><a href="/php/phpbianliang/21.html">PHP变量之外部变量</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP运算符			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yunsuanfu/22.html">PHP运算符优先级</a></li><li><a href="/php/yunsuanfu/23.html">算术运算符</a></li><li><a href="/php/yunsuanfu/24.html">赋值运算符</a></li><li><a href="/php/yunsuanfu/25.html">位运算符</a></li><li><a href="/php/yunsuanfu/26.html">比较运算符</a></li><li><a href="/php/yunsuanfu/27.html">错误控制运算符</a></li><li><a href="/php/yunsuanfu/28.html">执行运算符</a></li><li><a href="/php/yunsuanfu/29.html">递增/递减运算符</a></li><li><a href="/php/yunsuanfu/30.html">逻辑运算符</a></li><li><a href="/php/yunsuanfu/31.html">字符串运算符</a></li><li><a href="/php/yunsuanfu/32.html">数组运算符</a></li><li><a href="/php/yunsuanfu/33.html">类型运算符</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP控制结构			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/jiegou/34.html">PHP控制结构之if</a></li><li><a href="/php/jiegou/35.html">PHP控制结构之else</a></li><li><a href="/php/jiegou/36.html">PHP控制结构之elseif/else if</a></li><li><a href="/php/jiegou/37.html">PHP控制结构之替代语法</a></li><li><a href="/php/jiegou/38.html">PHP控制结构之while</a></li><li><a href="/php/jiegou/39.html">PHP控制结构之do-while</a></li><li><a href="/php/jiegou/40.html">PHP控制结构之for</a></li><li><a href="/php/jiegou/41.html">PHP控制结构之foreach</a></li><li><a href="/php/jiegou/42.html">PHP控制结构之break</a></li><li><a href="/php/jiegou/43.html">PHP控制结构之continue</a></li><li><a href="/php/jiegou/44.html">PHP控制结构之switch</a></li><li><a href="/php/jiegou/45.html">PHP控制结构之declare</a></li><li><a href="/php/jiegou/46.html">PHP控制结构之return</a></li><li><a href="/php/jiegou/47.html">PHP控制结构之require</a></li><li><a href="/php/jiegou/48.html">PHP控制结构之include</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/hanshu/52.html">用户自定义函数</a></li><li><a href="/php/hanshu/53.html">函数的参数</a></li><li><a href="/php/hanshu/54.html">返回值</a></li><li><a href="/php/hanshu/55.html">可变函数</a></li><li><a href="/php/hanshu/56.html">内部（内置）函数</a></li><li><a href="/php/hanshu/57.html">匿名函数</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpduixiang/58.html">类与对象前言</a></li><li><a href="/php/phpduixiang/59.html">基本概念</a></li><li><a href="/php/phpduixiang/60.html">属性</a></li><li><a href="/php/phpduixiang/61.html">类常量</a></li><li><a href="/php/phpduixiang/62.html">自动加载对象</a></li><li><a href="/php/phpduixiang/63.html">构造函数和析构函数</a></li><li><a href="/php/phpduixiang/64.html">访问控制</a></li><li><a href="/php/phpduixiang/65.html">对象继承</a></li><li><a href="/php/phpduixiang/66.html">Static关键字</a></li><li><a href="/php/phpduixiang/67.html">抽象类</a></li><li><a href="/php/phpduixiang/68.html">接口</a></li><li><a href="/php/phpduixiang/69.html">Traits</a></li><li><a href="/php/phpduixiang/70.html">重载</a></li><li><a href="/php/phpduixiang/71.html">对象迭代</a></li><li><a href="/php/phpduixiang/72.html">设计模式</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP异常处理			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/yichang/81.html">异常处理</a></li><li><a href="/php/yichang/82.html">扩展PHP内置的异常处理类</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> PHP函数库按分类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpku/83.html">数组</a></li><li><a href="/php/phpku/84.html">Classes/Objects</a></li><li><a href="/php/phpku/85.html">Date/Time</a></li><li><a href="/php/phpku/86.html">Directories</a></li><li><a href="/php/phpku/87.html">错误处理</a></li><li><a href="/php/phpku/88.html">Program execution</a></li><li><a href="/php/phpku/89.html">Filesystem</a></li><li><a href="/php/phpku/90.html">Filter</a></li><li><a href="/php/phpku/91.html">Function Handling</a></li><li><a href="/php/phpku/92.html">PHP 选项/信息</a></li><li><a href="/php/phpku/93.html">Mail</a></li><li><a href="/php/phpku/94.html">Math</a></li><li><a href="/php/phpku/95.html">Misc.</a></li><li><a href="/php/phpku/96.html">Network</a></li><li><a href="/php/phpku/97.html">输出控制</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> php基础			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/php/phpbiji/108377.html"></a></li><li><a href="/php/phpbiji/108376.html"></a></li><li><a href="/php/phpbiji/108380.html"></a></li><li><a href="/php/phpbiji/108379.html"></a></li><li><a href="/php/phpbiji/108378.html"></a></li><li><a href="/php/phpbiji/108381.html"></a></li><li><a href="/php/phpbiji/108382.html"></a></li><li><a href="/php/phpbiji/108384.html"></a></li><li><a href="/php/phpbiji/108383.html"></a></li><li><a href="/php/phpbiji/108385.html"></a></li><li><a href="/php/phpbiji/108386.html"></a></li><li><a href="/php/phpbiji/108388.html"></a></li><li><a href="/php/phpbiji/108387.html"></a></li><li><a href="/php/phpbiji/108389.html"></a></li><li><a href="/php/phpbiji/108391.html"></a></li>		</ul>
	</li>
		<li>
	    <a href="/php/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>PHP笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">PHP+jQuery 注册模块开发详解</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>写了一个简单的PHP+jQuery注册模块，需要填写的栏目包括用户名、邮箱、密码、重复密码和验证码，其中每个栏目需要具备的功能和要求如下图：<br />
<br />
在做这个模块的时候，很大程度上借鉴了</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>写了一个简单的PHP+jQuery注册模块，需要填写的栏目包括用户名、邮箱、密码、重复密码和验证码，其中每个栏目需要具备的功能和要求如下图：</p>
<p></p>
<p>在做这个模块的时候，很大程度上借鉴了网易注册(http://reg.163.com/reg/reg.jsp&#63;product=urs)的功能和样式。但网易对于每个栏目的判断的做法是：在输入文字时，并不给出任何实时的检测结果，而在这个栏目失去焦点时，才把检测的结果展示出来，这种做法我认为会使用户在输入时视觉上比较统一，看到的是关于该栏目要求的提示，不会出现其他信息的打扰，但同时也不会得到正在输入的字符的检测提示。所以在做这个功能的时候，我把我自认为需要实时提示的一些信息做了相应的加强，比如用户名长度超过限制和密码的长度以及强弱，并且给邮箱的大写锁定做了简单的判断。</p>
<p>注：表单的提交按钮type为button而不是submit，因此所有栏目的回车( keydown )都统一设置为将焦点移至下一个栏目，除了最后一个栏目验证码，在验证码栏目使用回车( keydown )会触发提交事件。</p>
<p>功能分析</p>
<p>用户名栏目：</p>
<p>流程</p>
<p>①页面加载完即获得焦点，获得焦点时出现初始说明文字；</p>
<p>②鼠标点击用户名输入框，出现初始说明文字；</p>
<p>③输入字符，即时提示是否符合长度要求；</p>
<p>④失去焦点时首先判断是否为空，为空时提示不能为空；非空且长度满足要求时，开始检测用户名是否被注册；</p>
<p>⑤用户名已被注册，给出提示，如果没有注册，则提示可以注册；</p>
<p>⑥再次获得焦点时，不论输入框中是否有输入，或是否输入符合规定，都出现初始说明文字</p>
<p>⑦回车时将焦点移至邮箱栏目</p>
<p>如图：</p>
<p></p>
<p>细节</p>
<p>可以使用任意字符，并且字数限制为：中文长度不超过7个汉字，英文、数字或符号长度不超过14个字母、数字或符号（类似豆瓣注册https://www.douban.com/accounts/register），即不超过14个字符</p>
<p>关于占位符（字符长度），一个汉字的占位符是2，一个英文（数字）的占位符是1，可以用php语句来计算字符的长度</p>
<div class="phpstudycode">
<pre class="brush:php;">
 &lt;&#63;php
//php.ini开启了php_mbstring.dll扩展
 $str="博客园小dee";
 
 echo (strlen($str)+mb_strlen($str,'utf-8'))/2;</pre>
</div>
<p>输出：11</p>
<p>而strlen($str) 输出的是15：4*3+3，汉字在utf-8编码下占3个字节，英文占1个，</p>
<p>mb_strlen($str,'utf-8') 输出的是7：一个汉字的长度是1，</p>
<p>如果用jquery的length来输出这个字符串，alert($("#uname").val().length)，则会得到长度7，</p>
<p>这点要注意。</p>
<p>同时用户名两端不能含有空格，在检测以及注册时，程序会自动过滤用户名两端的空格。</p>
<p>register.html 用户名栏目的HTML代码片段：</p>
<div class="phpstudycode">
<pre class="brush:xhtml;">
&lt;!-- 用户名 --&gt;    
&lt;div class="ipt fipt"&gt;
   &lt;input type="text" name="uname" id="uname" value="" placeholder="输入用户名" autocomplete="off" /&gt;
   &lt;!--提示文字--&gt;
  &lt;span id="unamechk"&gt;&lt;/span&gt;
&lt;/div&gt;</pre>
</div>
<p>register.js公用部分的js代码：</p>
<div class="phpstudycode">
<pre class="brush:js;">
$(function(){
  
  //说明文字
  function notice(showMsg,noticeMsg){      
    showMsg.html(noticeMsg).attr("class","notice");
  }
  //显示错误信息
  function error(showMsg,errorMsg){  
    showMsg.html(errorMsg).attr("class","error");
  }  
  //显示正确信息
  function success(showMsg,successMsg){  
    showMsg.html(successMsg)        
            .css("height","20px")
            .attr("class","success");
  }

  //计算字符长度
  function countLen(value){
  
    var len = 0; 
    for (var i = 0; i &lt; value.length; i++) { 
      if (value[i].match(/[^\x00-\xff]/ig) != null) 
      len += 2; 
      else 
      len += 1; 
    } 
    return len;
  }           

  //......
)};</pre>
</div>
<p>register.js用户名部分的js代码：</p>
<div class="phpstudycode">
<pre class="brush:js;">
//检测用户名长度
function unameLen(value){
  
    var showMsg = $("#unamechk");

    /* (strlen($str)+mb_strlen($str))/2 可得出限制字符长度的上限,
    * 例如:$str为7个汉字:"博客园记录生活",利用上面的语句可得出14,
    * 同样,14个英文,利用上面的语句同样能得出字符长度为14
    */
    if(countLen(value) &gt; 14){
            
      var errorMsg = '用户名长度不能超过14个英文或7个汉字';
      error(showMsg,errorMsg);    
    }else if(countLen(value) == 0){
    
      var noticeMsg = '用户名不能为空';
      notice(showMsg,noticeMsg);
    }else{

      var successMsg = '长度符合要求';
      success(showMsg,successMsg);
    }

    return countLen(value);
  }

  //用户名
  unameLen($("#uname").val());
  
  $("#uname").focus(function(){
  
          var noticeMsg = '中英文均可，最长为14个英文或7个汉字';
          notice($("#unamechk"),noticeMsg);
        })
        .click(function(){
          
          var noticeMsg = '中英文均可，最长为14个英文或7个汉字';
          notice($("#unamechk"),noticeMsg);
        })
        .keyup(function(){
  
          unameLen(this.value);
        }).keydown(function(){
        
          //把焦点移至邮箱栏目
          if(event.keyCode == 13){
            
            $("#uemail").focus();
          }
        })
        .blur(function(){
        
          if($("#uname").val()!="" && unameLen(this.value)&lt;=14 && unameLen(this.value)&gt;0){
            //检测中
            $("#unamechk").html("检测中...").attr("class","loading");
            //ajax查询用户名是否被注册
            $.post("./../chkname.php",{
            
              //要传递的数据
              uname : $("#uname").val()
            },function(data,textStatus){
              
              if(data == 0){
              
                var successMsg = '恭喜，该用户名可以注册';
                $("#unamechk").html(successMsg).attr("class","success");

                //设置参数
                nameval = true;
              }else if(data == 1){
              
                var errorMsg = '该用户名已被注册';
                error($("#unamechk"),errorMsg);
              }else{
              
                var errorMsg = '查询出错,请联系网站管理员';
                error($("#unamechk"),errorMsg);
              }
            });
          }else if(unameLen(this.value)&gt;14){
          
            var errorMsg = '用户名长度不能超过14个英文或7个汉字';
            error($("#unamechk"),errorMsg);
          }else{
          
            var errorMsg = '用户名不能为空';
            error($("#unamechk"),errorMsg);
          }
});

//加载后即获得焦点
$("#uname").focus();</pre>
</div>
<p>checkname.php代码：</p>
<div class="phpstudycode">
<pre class="brush:php;">
&lt;&#63;php

  header("charset=utf-8");

  require_once("conn/conn.php");

  if(isset($_POST['uname']) && $_POST['uname']!=""){
  
    $uname = trim(addslashes($_POST['uname']));
  }

  $sql = "select uname from user where uname='".$uname."'";
  
  if($conne-&gt;getRowsNum($sql) == 1){
  
    $state = 1;
  }else if($conne-&gt;getRowsNum($sql) == 0){
  
    $state = 0;
  }else{

    echo $conne-&gt;msg_error();
  }

  echo $state;</pre>
</div>
<p>提示文字( Chrome下 )</p>
<p>①初始获得焦点、再次获得焦点或点击时</p>
<p></p>
<p></p>
<p></p>
<p>②输入时实时检测长度</p>
<p></p>
<p>　　</p>
<p></p>
<p>③删除至空且未失去焦点时，使用蓝色图标提示不能为空——用户在输入时看起来不突兀</p>
<p></p>
<p></p>
<p>④失去焦点且不为空，检测是否被注册( 非常短暂，一闪而过 )</p>
<p></p>
<p>⑤失去焦点时为空、可以注册、已被注册时</p>
<p></p>
<p></p>
<p></p>
<p>用户名分析至此完毕。</p>
<p><strong>邮箱栏目：</strong></p>
<p>流程</p>
<p>①当栏目获得焦点或者点击时不论栏目为空、填写正确或者填写错误时都出现说明文字；</p>
<p>②用户输入时出现下拉菜单显示多种邮件后缀供用户选择；</p>
<p>③失去焦点时首先判断邮箱格式是否正确，如果正确则检测邮箱是否被注册 ；</p>
<p>④在使用回车选择下拉菜单时，将自动填充邮箱栏目；没有出现下拉菜单时，将焦点移至密码栏目</p>
<p>如图：</p>
<p></p>
<p>register.html邮箱栏目HTML代码片段：</p>
<div class="phpstudycode">
<pre class="brush:xhtml;">
&lt;!-- email --&gt;      
 &lt;div class="ipt"&gt;
   &lt;input type="text" name="uemail" id="uemail" value="" placeholder="常用邮箱地址" /&gt;
   &lt;span id="uemailchk"&gt;&lt;/span&gt;
   &lt;ul class="autoul"&gt;&lt;/ul&gt;
 &lt;/div&gt;  </pre>
</div>
<p>下拉功能emailup.js同之前的博文《jQuery实现下拉提示且自动填充的邮箱》，略有修改，注意用回车( keydown和keyup事件)在不同情况下触发的不同动作：</p>
<div class="phpstudycode">
<pre class="brush:js;">
$(function(){
  
  //初始化邮箱列表
  var mail = new Array("sina.com","126.com","163.com","gmail.com","qq.com","hotmail.com","sohu.com","139.com","189.cn","sina.cn");

  //把邮箱列表加入下拉
  for(var i=0;i&lt;mail.length;i++){
  
    var $liElement = $("&lt;li class=\"autoli\"&gt;&lt;span class=\"ex\"&gt;&lt;/span&gt;&lt;span class=\"at\"&gt;@&lt;/span&gt;&lt;span class=\"step\"&gt;"+mail[i]+"&lt;/span&gt;&lt;/li&gt;");

    $liElement.appendTo("ul.autoul");
  }

  //下拉菜单初始隐藏
  $(".autoul").hide();
  
  //在邮箱输入框输入字符
  $("#uemail").keyup(function(){
   
    if(event.keyCode!=38 && event.keyCode!=40 && event.keyCode!=13){

      //菜单展现，需要排除空格开头和"@"开头
      if( $.trim($(this).val())!="" && $.trim(this.value).match(/^@/)==null ) {

        $(".autoul").show();
        //修改
        $(".autoul li").show();

        //同时去掉原先的高亮，把第一条提示高亮
        if($(".autoul li.lihover").hasClass("lihover")) {
          $(".autoul li.lihover").removeClass("lihover");
        }
        $(".autoul li:visible:eq(0)").addClass("lihover");
      }else{//如果为空或者"@"开头
        $(".autoul").hide();
        $(".autoul li:eq(0)").removeClass("lihover");
      }

      //把输入的字符填充进提示，有两种情况：1.出现"@"之前，把"@"之前的字符进行填充；2.出现第一次"@"时以及"@"之后还有字符时，不填充
      //出现@之前
      if($.trim(this.value).match(/[^@]@/)==null){//输入了不含"@"的字符或者"@"开头
        if($.trim(this.value).match(/^@/)==null){

          //不以"@"开头
          //这里要根据实际html情况进行修改
          $(this).siblings("ul").children("li").children(".ex").text($(this).val());
        }
      }else{

        //输入字符后，第一次出现了不在首位的"@"
        //当首次出现@之后，有2种情况：1.继续输入；2.没有继续输入
        //当继续输入时
        var str = this.value;//输入的所有字符
        var strs = new Array();
        strs = str.split("@");//输入的所有字符以"@"分隔
        $(".ex").text(strs[0]);//"@"之前输入的内容
        var len = strs[0].length;//"@"之前输入内容的长度
        if(this.value.length&gt;len+1){

          //截取出@之后的字符串,@之前字符串的长度加@的长度,从第(len+1)位开始截取
          var strright = str.substr(len+1);

          //正则屏蔽匹配反斜杠"\"
          if(strright.match(/[\\]/)!=null){
            strright.replace(/[\\]/,"");
            return false;
          }
         
          //遍历li
          $("ul.autoul li").each(function(){

            //遍历span
            //$(this) li
            $(this).children("span.step").each(function(){

              //@之后的字符串与邮件后缀进行比较
              //当输入的字符和下拉中邮件后缀匹配并且出现在第一位出现
              //$(this) span.step
              if($("ul.autoul li").children("span.step").text().match(strright)!=null && $(this).text().indexOf(strright)==0){
                
                //class showli是输入框@后的字符和邮件列表对比匹配后给匹配的邮件li加上的属性
                $(this).parent().addClass("showli");
                //如果输入的字符和提示菜单完全匹配，则去掉高亮和showli，同时提示隐藏
                
                if(strright.length&gt;=$(this).text().length){
                    
                  $(this).parent().removeClass("showli").removeClass("lihover").hide();
                }
              }else{
                $(this).parent().removeClass("showli");
              }
              if($(this).parent().hasClass("showli")){
                $(this).parent().show();
                $(this).parent("li").parent("ul").children("li.showli:eq(0)").addClass("lihover");
              }else{
                $(this).parent().hide();
                $(this).parent().removeClass("lihover");
              }
            });
          });

          //修改
          if(!$(".autoul").children("li").hasClass("showli")){

            $(".autoul").hide();
          }
        }else{
          //"@"后没有继续输入时
          $(".autoul").children().show();
          $("ul.autoul li").removeClass("showli");
          $("ul.autoul li.lihover").removeClass("lihover");
          $("ul.autoul li:eq(0)").addClass("lihover");
        }
      }
    }//有效输入按键事件结束

    if(event.keyCode == 8 || event.keyCode == 46){
   
     $(this).next().children().removeClass("lihover");
     $(this).next().children("li:visible:eq(0)").addClass("lihover");
    }//删除事件结束 
    
    if(event.keyCode == 38){
     //使光标始终在输入框文字右边
     $(this).val($(this).val());
    }//方向键↑结束
    
    if(event.keyCode == 13){
    
      //keyup时只做菜单收起相关的动作和去掉lihover类的动作，不涉及焦点转移
      $(".autoul").hide();
      $(".autoul").children().hide();
      $(".autoul").children().removeClass("lihover");     
    }
  });  
  
  $("#uemail").keydown(function(){

    if(event.keyCode == 40){

      //当键盘按下↓时,如果已经有li处于被选中的状态,则去掉状态,并把样式赋给下一条(可见的)li
      if ($("ul.autoul li").is(".lihover")) {

        //如果还存在下一条(可见的)li的话
        if ($("ul.autoul li.lihover").nextAll().is("li:visible")) {

          if ($("ul.autoul li.lihover").nextAll().hasClass("showli")) {

            $("ul.autoul li.lihover").removeClass("lihover")
                .nextAll(".showli:eq(0)").addClass("lihover");
          } else {

            $("ul.autoul li.lihover").removeClass("lihover").removeClass("showli")
                .next("li:visible").addClass("lihover");
            $("ul.autoul").children().show();
          }
        } else {

          $("ul.autoul li.lihover").removeClass("lihover");
          $("ul.autoul li:visible:eq(0)").addClass("lihover");
        }
      } 
    }

    if(event.keyCode == 38){

      //当键盘按下↓时,如果已经有li处于被选中的状态,则去掉状态,并把样式赋给下一条(可见的)li
      if($("ul.autoul li").is(".lihover")){

        //如果还存在上一条(可见的)li的话
        if($("ul.autoul li.lihover").prevAll().is("li:visible")){


          if($("ul.autoul li.lihover").prevAll().hasClass("showli")){

            $("ul.autoul li.lihover").removeClass("lihover")
                .prevAll(".showli:eq(0)").addClass("lihover");
          }else{

            $("ul.autoul li.lihover").removeClass("lihover").removeClass("showli")
                .prev("li:visible").addClass("lihover");
            $("ul.autoul").children().show();
          }
        }else{

          $("ul.autoul li.lihover").removeClass("lihover");
          $("ul.autoul li:visible:eq("+($("ul.autoul li:visible").length-1)+")").addClass("lihover");
        }
      }else{

        //当键盘按下↓时,如果之前没有一条li被选中的话,则第一条(可见的)li被选中
        $("ul.autoul li:visible:eq("+($("ul.autoul li:visible").length-1)+")").addClass("lihover");
      }
    } 

    if(event.keyCode == 13){              

      //keydown时完成的两个动作 ①填充 ②判断下拉菜单是否存在，如果不存在则焦点移至密码栏目。注意下拉菜单的收起动作放在keyup事件中。即当从下拉菜单中选择邮箱的时候按回车不会触发焦点转移，而选择完毕菜单收起之后再按回车，才会触发焦点转移事件
      if($("ul.autoul li").is(".lihover")) {

        $("#uemail").val($("ul.autoul li.lihover").children(".ex").text() + "@" + $("ul.autoul li.lihover").children(".step").text());
      }

      //把焦点移至密码栏目
      if($(".autoul").attr("style") == "display: none;"){
  
        $("#upwd").focus();
      }
    }
  });

  
  //把click事件修改为mousedown,避免click事件时短暂的失去焦点而触发blur事件
  $(".autoli").mousedown(function(){
 
    $("#uemail").val($(this).children(".ex").text()+$(this).children(".at").text()+$(this).children(".step").text());
    $(".autoul").hide();
    
    //修改
    $("#uemail").focus();
  }).hover(function(){

    if($("ul.autoul li").hasClass("lihover")){

      $("ul.autoul li").removeClass("lihover");
    }
    $(this).addClass("lihover");
  });

  $("body").click(function(){

    $(".autoul").hide();
  });
});</pre>
</div>
<p>register.js邮箱代码片段：</p>
<div class="phpstudycode">
<pre class="brush:js;">
//邮箱下拉js单独引用emailup.js
$("#uemail").focus(function(){
  
          var noticeMsg = '用来登陆网站，接收到激活邮件才能完成注册';
          notice($("#uemailchk"),noticeMsg);
        })
        .click(function(){
  
          var noticeMsg = '用来登陆网站，接收到激活邮件才能完成注册';
          notice($("#uemailchk"),noticeMsg);
        })
        .blur(function(){
        
          if(this.value!="" && this.value.match(/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/)!=null){
          
            //检测是否被注册
            $("#uemailchk").html("检测中...").attr("class","loading");
            //ajax查询用户名是否被注册
            $.post("./../chkemail.php",{
            
              //要传递的数据
              uemail : $("#uemail").val()
            },function(data,textStatus){
              
              if(data == 0){
              
                var successMsg = '恭喜，该邮箱可以注册';
                $("#uemailchk").html(successMsg).attr("class","success");

                emailval = true;
              }else if(data == 1){
              
                var errorMsg = '该邮箱已被注册';
                error($("#uemailchk"),errorMsg);
              }else{
              
                var errorMsg = '查询出错,请联系网站管理员';
                error($("#uemailchk"),errorMsg);
              }
            });
          }else if(this.value == ""){
          
            var errorMsg = '邮箱不能为空';
            error($("#uemailchk"),errorMsg);
          }else{
          
            var errorMsg = '请填写正确的邮箱地址';
            $("#uemailchk").html(errorMsg).attr("class","error");
          }
});</pre>
</div>
<p>提示文字( Chrome下 )</p>
<p>①获得焦点时、点击时</p>
<p></p>
<p>②输入时</p>
<p></p>
<p>③失去焦点为空、格式错误、已被注册、可以注册时分别为</p>
<p></p>
<p></p>
<p></p>
<p></p>
<p>邮箱功能至此结束。</p>
<p><strong>密码栏目：</strong></p>
<p>要求</p>
<p>①6-16个个字符，区分大小写（参考豆瓣和网易）</p>
<p>②密码不能为同一字符</p>
<p>③实时提示是否符合要求以及判断并显示密码强度，：</p>
<p>　　1.输入时如果为空(删除时)则用蓝色符号提示不能为空，超过长度时用红色符号</p>
<p>　　2.密码满足长度但是为相同字符的组合时：密码太简单，请尝试数字、字母和下划线的组合</p>
<p>　　3.密码强度判断有多种规则，有直接依据长度和组合规则作出判断，也有给每种长度和组合设置分数，通过验证实际密码的情况计算出最后分数来判断强弱。在这个模块中采用比较简单的一种形式，也是网易注册采用的方法：</p>
<p>　　密码满足长度且全部为不同字母、全部为不同数字或全部为不同符号时为弱：弱：试试字母、数字、符号混搭</p>
<p>　　 密码满足长度且为数字、字母和符号任意两种组合时为中</p>
<p>　　 密码满足长度且为数字、字母和符号三种组合时为强</p>
<p>④输入时大写提示</p>
<p>如图：</p>
<p></p>
<p>register.html密码栏目HTML代码片段：</p>
<div class="phpstudycode">
<pre class="brush:xhtml;">
&lt;div class="ipt"&gt;
  &lt;input type="password" name="upwd" id="upwd" value="" placeholder="设置密码" /&gt;
  &lt;div class="upwdpic"&gt;
    &lt;span id="upwdchk"&gt;&lt;/span&gt;
    &lt;img id="pictie" /&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
</div>
<p>register.js密码代码片段：</p>
<div class="phpstudycode">
<pre class="brush:js;">
function noticeEasy(){
  
    //密码全部为相同字符或者为123456,用于keyup时的notice
    var noticeMsg = '密码太简单，请尝试数字、字母和下划线的组合';
    return notice($("#upwdchk"),noticeMsg);
  }

  function errorEasy(){
  
    //密码全部为相同字符或者为123456,用于blur时的error
    var errorMsg = '密码太简单，请尝试数字、字母和下划线的组合';
    return error($("#upwdchk"),errorMsg);
  }
  
  //检测密码长度函数
  //检测密码长度
  function upwdLen(value,func){
  
    var showMsg = $("#upwdchk");

    if(countLen(value) &gt; 16){
            
      var errorMsg = '密码不能超过16个字符';
      error(showMsg,errorMsg);
      
      $("#pictie").hide();
    }else if(countLen(value) &lt; 6){
    
      //使用notice更加友好
      var noticeMsg = '密码不能少于6个字符';
      notice(showMsg,noticeMsg);

      $("#pictie").hide();
    }else if(countLen(value) == 0){
    
      //使用notice更加友好
      var noticeMsg = '密码不能为空';
      notice(showMsg,noticeMsg);

      $("#pictie").hide();
    }else{
    
      upwdStrong(value,func);//如果长度不成问题,则调用检测密码强弱
    }

    return countLen(value);//返回字符长度
  }

  //检测密码强弱
  function upwdStrong(value,func){
  
    var showMsg = $("#upwdchk");

    if(value.match(/^(.)\1*$/)!=null || value.match(/^123456$/)){
    
      //密码全部为相同字符或者为123456，调用函数noticeEasy或errorEasy
      func;
    }else if(value.match(/^[A-Za-z]+$/)!=null || value.match(/^\d+$/)!=null || value.match(/^[^A-Za-z0-9]+$/)!=null){

      //全部为相同类型的字符为弱
      var successMsg = '弱：试试字母、数字、符号混搭';
      success(showMsg,successMsg);

      //插入强弱条
      $("#pictie").show().attr("src","images/weak.jpg");

      pwdval = true;

    }else if(value.match(/^[^A-Za-z]+$/)!=null || value.match(/^[^0-9]+$/)!=null || value.match(/^[a-zA-Z0-9]+$/)!=null){
    
      //任意两种不同类型字符组合为中强( 数字+符号,字母+符号,数字+字母 )
      var successMsg = '中强：试试字母、数字、符号混搭';
      success(showMsg,successMsg);

      $("#pictie").show().attr("src","images/normal.jpg");

      pwdval = true;
    }else{
    
      //数字、字母和符号混合
      var successMsg = '强：请牢记您的密码';
      success(showMsg,successMsg);

      $("#pictie").show().attr("src","images/strong.jpg");

      pwdval = true;
    }
  }
  
  $upper = $("&lt;div id=\"upper\"&gt;大写锁定已打开&lt;/div&gt;");
  
  $("#upwd").focus(function(){
  
          var noticeMsg = '6到16个字符，区分大小写';
          notice($("#upwdchk"),noticeMsg);

          $("#pictie").hide();
      })
       .click(function(){
      
          var noticeMsg = '6到16个字符，区分大小写';
          notice($("#upwdchk"),noticeMsg);

          $("#pictie").hide();
      }).keydown(function(){
      
          //把焦点移至邮箱栏目
          if(event.keyCode == 13){
            
            $("#rupwd").focus();
          }
      })
       .keyup(function(){
       
          //判断大写是否开启
          //输入密码的长度
          var len = this.value.length;          
          if(len!=0){

            //当输入的最新以为含有大写字母时说明开启了大写锁定
            if(this.value[len-1].match(/[A-Z]/)!=null){
            
              //给出提示
              $upper.insertAfter($(".upwdpic"));
            }else{
            
              //移除提示
              $upper.remove();
            }
          }else{
          
            //当密码框为空时移除提示
            if($upper){
            
              $upper.remove();
            }
          }//判断大写开启结束
      
          //判断长度及强弱
          upwdLen(this.value,noticeEasy());  
       })
       //keyup事件结束
        .blur(function(){
        
          upwdLen(this.value,errorEasy());
          //upwdLen函数中部分提示使用notice是为了keyup事件中不出现红色提示,而blur事件中则需使用error标红
          if(this.value == ""){
          
            var errorMsg = '密码不能为空';
            error($("#upwdchk"),errorMsg);

            $("#pictie").hide();
          }else if(countLen(this.value)&lt;6){
          
            var errorMsg = '密码不能少于6个字符';
            error($("#upwdchk"),errorMsg);

            $("#pictie").hide();
          }
});</pre>
</div>
<p>大写锁定的思路是：判断输入的字符的最新一位是否是大写字母，如果是大写字母，则提示大写锁定键打开。这种方法并不十分准确，网上有一些插件能判断大写锁定，在这里只是简单地做了一下判断。</p>
<p>提示文字( Chrome下 )</p>
<p>①获得焦点、点击时</p>
<p></p>
<p></p>
<p>②输入时</p>
<p></p>
<p> 失去焦点时与此效果相同</p>
<p> 失去焦点时与此效果相同</p>
<p> 失去焦点时与此效果相同</p>
<p> 失去焦点时与此效果相同</p>
<p>③失去焦点为空时</p>
<p></p>
<p>④出现大写时</p>
<p></p>
<p>密码栏目至此结束。</p>
<p><strong>重复密码：失去焦点时判断是否和密码一致</strong></p>
<p>reister.html代码片段:</p>
<div class="phpstudycode">
<pre class="brush:xhtml;">
&lt;div class="ipt"&gt;
  &lt;input type="password" name="rupwd" id="rupwd" value="" placeholder="确认密码" /&gt;
  &lt;span id="rupwdchk"&gt;&lt;/span&gt;
&lt;/div&gt;</pre>
</div>
<p>register.js代码片段：</p>
<div class="phpstudycode">
<pre class="brush:js;">
$("#rupwd").focus(function(){
  
          var noticeMsg = '再次输入你设置的密码';
          notice($("#rupwdchk"),noticeMsg);
      })
        .click(function(){
      
          var noticeMsg = '再次输入你设置的密码';
          notice($("#rupwdchk"),noticeMsg);
      }).keydown(function(){
      
          //把焦点移至邮箱栏目
          if(event.keyCode == 13){
            
            $("#yzm").focus();
          }
      })
        .blur(function(){
      
          if(this.value == $("#upwd").val() && this.value!=""){
          
            success($("#rupwdchk"),"");

            rpwdval = true;
          }else if(this.value == ""){
          
            $("#rupwdchk").html("");
          }else{
          
            var errorMsg = '两次输入的密码不一致';
            error($("#rupwdchk"),errorMsg);
          }
});</pre>
</div>
<p>提示文字：</p>
<p>①获得焦点、点击时</p>
<p></p>
<p>②失去焦点时和密码不一致、一致时分别为</p>
<p></p>
<p></p>
<p>至此重复密码结束。</p>
<p><strong>验证码：不区分大小写</strong></p>
<p>验证码采用4位，可以包含的字符为数字1-9，字母a-f</p>
<p>点击验证码和刷新按钮都能刷新验证码</p>
<p>register.html验证码代码部分：</p>
<div class="phpstudycode">
<pre class="brush:xhtml;">
&lt;div class="ipt iptend"&gt;
  &lt;input type='text' id='yzm' name='yzm' placeholder="验证码"&gt;
  &lt;img id='yzmpic' src='' style="cursor:pointer"&gt; &lt;!-- 验证码图片 --&gt;
  &lt;a style="cursor:pointer" id='changea'&gt;
    &lt;img id="refpic" src="images/ref.jpg" alt="验证码"&gt; &lt;!-- 验证码刷新按钮图片 --&gt;
  &lt;/a&gt;
  &lt;span id='yzmchk'&gt;&lt;/span&gt;
  &lt;input type='hidden' id='yzmHiddenNum' name='yzmHiddenNum' value=''&gt; &lt;!-- 隐藏域，内容是验证码输出的数字，用户输入的字符与其进行对比 --&gt;
&lt;/div&gt;</pre>
</div>
<p>register.js验证码部分:</p>
<div class="phpstudycode">
<pre class="brush:js;">
//验证码按钮
$("#refpic").hover(function(){
    
      $(this).attr("src","images/refhover.jpg");
    },function(){
    
      $(this).attr("src","images/ref.jpg");
    }).mousedown(function(){
    
      $(this).attr("src","images/refclick.jpg");
    }).mouseup(function(){
    
      $(this).attr("src","images/ref.jpg");
    });
    
    //生成验证码函数
    function showval() {

      num = '';
      for (i = 0; i &lt; 4; i++) {

        tmp = Math.ceil(Math.random() * 15);//Math.ceil上取整；Math.random取0-1之间的随机数
        if (tmp &gt; 9) {
          switch (tmp) {
            case(10):
              num += 'a';
              break;
            case(11):
              num += 'b';
              break;
            case(12):
              num += 'c';
              break;
            case(13):
              num += 'd';
              break;
            case(14):
              num += 'e';
              break;
            case(15):
              num += 'f';
              break;
          }
        } else {
          num += tmp;
        }

        $('#yzmpic').attr("src","../valcode.php&#63;num="+num);
      }
      $('#yzmHiddenNum').val(num);
    }

    //生成验证码以及刷新验证码
    showval();
    $('#yzmpic').click(function(){
    
      showval();
    });
    $('#changea').click(function(){
    
      showval();
    });

    //验证码检验
    function yzmchk(){
    
      if($("#yzm").val() == ""){
      
        var errorMsg = '验证码不能为空';
        error($("#yzmchk"),errorMsg);
      }else if($("#yzm").val().toLowerCase()!=$("#yzmHiddenNum").val()){
      
        //不区分大小写
        var errorMsg = '请输入正确的验证码';
        error($("#yzmchk"),errorMsg);
      }else{
      
        success($("#yzmchk"),"");

        yzmval = true;
      }
    }

    //验证码的blur事件
    $("#yzm").focus(function(){
    
      var noticeMsg = '不区分大小写';
      notice($("#yzmchk"),noticeMsg);
    }).click(function(){
    
      var noticeMsg = '不区分大小写';
      notice($("yzmdchk"),noticeMsg);
    }).keydown(function(){
      
      //提交
      if(event.keyCode == 13){        
        
        //先检验后提交
        yzmchk();
        formsub();
      }
    }).blur(function(){
    
      yzmchk();
});</pre>
</div>
<p>valcode.php验证码生成php代码：</p>
<div class="phpstudycode">
<pre class="brush:php;">
&lt;&#63;php 

  header("content-type:image/png");
  $num = $_GET['num'];
  $imagewidth = 150;
  $imageheight = 54;
  
  //创建图像
  $numimage = imagecreate($imagewidth, $imageheight);
  
  //为图像分配颜色
  imagecolorallocate($numimage, 240,240,240); 

  //字体大小
  $font_size = 33;
  
  //字体名称
  $fontname = 'arial.ttf';
  
  //循环生成图片文字
  for($i = 0;$i&lt;strlen($num);$i++){
    
    //获取文字左上角x坐标
    $x = mt_rand(20,20) + $imagewidth*$i/5;
    
    //获取文字左上角y坐标
    $y = mt_rand(40, $imageheight);
    
    //为文字分配颜色
    $color = imagecolorallocate($numimage, mt_rand(0,150), mt_rand(0,150), mt_rand(0,150));
    
    //写入文字
    imagettftext($numimage,$font_size,0,$x,$y,$color,$fontname,$num[$i]);
  }
  
  //生成干扰码
  for($i = 0;$i&lt;2200;$i++){
    $randcolor = imagecolorallocate($numimage, rand(200,255), rand(200,255), rand(200,255));
    imagesetpixel($numimage, rand()%180, rand()%90, $randcolor);
  }
  
  //输出图片
  imagepng($numimage);
  imagedestroy($numimage);
&#63;&gt;</pre>
</div>
<p>注：把字体"Arial"放在服务器的相应目录</p>
<p>提示文字：</p>
<p>①获得焦点时、点击时</p>
<p></p>
<p>②为空且失去焦点时</p>
<p></p>
<p>③输入错误、输入正确且失去焦点时分别为</p>
<p></p>
<p></p>
<p>验证码至此结束。</p>
<p><strong>使用协议：默认勾选；</strong></p>
<p>register.html相应代码：</p>
<div class="phpstudycode">
<pre class="brush:xhtml;">
&lt;span class="fuwu"&gt;
    &lt;input type="checkbox" name="agree" id="agree" checked="checked"&gt;
    &lt;label for="agree"&gt;我同意 &lt;a href="#"&gt;" 服务条款 "&lt;/a&gt; 和 &lt;a href="#"&gt;" 网络游戏用户隐私权保护和个人信息利用政策 "&lt;/a&gt;
    &lt;/label&gt;
&lt;/span&gt;</pre>
</div>
<p>register.js相应代码：</p>
<div class="phpstudycode">
<pre class="brush:js;">
if($("#agree").prop("checked") == true){
  
    fuwuval = true;
  }

$("#agree").click(function(){
  
    if($("#agree").prop("checked") == true){

      fuwuval = true;
      $("#sub").css("background","#69b3f2");
    }else{
    
      $("#sub").css({"background":"#f2f2f2","cursor":"default"});
    }  
});</pre>
</div>
<p>效果图：</p>
<p>①勾选之后</p>
<p></p>
<p>②未勾选</p>
<p></p>
<p></p>
<p><strong>提交按钮：</strong>检测是否所有栏目都填写正确，否则所有填写错误的栏目将给出错误提示。全部填写正确后提交并且发送验证邮件到注册邮箱中，邮件的验证地址在3日后失效</p>
<p>首先在register.js开始部分定义几个参数：nameval,emailval,pwdval,rpwdval,yzmval,fuwuval，全部设为0；当相应栏目符合规定之后，把相应的参数设为true。当所有的参数都为true之后，提交至registerChk.php，否则return false。</p>
<p>register.html相应代码：</p>
<div class="phpstudycode">
<pre class="brush:xhtml;">
&lt;button type="button" id="sub"&gt;立即注册&lt;/button&gt;</pre>
</div>
<p>register.js相应代码：</p>
<p>参数设置：</p>
<pre>
var nameval,emailval,pwdval,rpwdval,yzmval,fuwuval = 0;</pre>
<p>提交事件：</p>
<div class="phpstudycode">
<pre class="brush:js;">
function formsub(){
  
    if(nameval != true || emailval!=true || pwdval!=true || rpwdval!=true || yzmval!=true || fuwuval!=true){
    
      //当邮箱有下拉菜单时点击提交按钮时不会自动收回菜单，因为下面的return false，所以在return false之前判断下拉菜单是否弹出
      if(nameval != true && $("#unamechk").val()!=""){
      
        var errorMsg = '请输入用户名';
        error($("#namechk"),errorMsg);
      }

      if($(".autoul").show()){
      
        $(".autoul").hide();
      }

      //以下是不会自动获得焦点的栏目如果为空时，点击注册按钮给出错误提示
      if($("#uemail").val() == ""){
      
        var errorMsg = '邮箱不能为空';
        error($("#uemailchk"),errorMsg);    
      }

      if($("#upwd").val() == ""){
      
        var errorMsg = '密码不能为空';
        error($("#upwdchk"),errorMsg);    
      }

      if($("#rupwd").val() == ""){
      
        var errorMsg = '请再次输入你的密码';
        error($("#rupwdchk"),errorMsg);    
      }

      if($("#yzm").val() == ""){
      
        var errorMsg = '验证码不能为空';
        error($("#yzmchk"),errorMsg);    
      }

    }else{
    
      $("#register-form").submit();
    }
  }

  $("#sub").click(function(){
    
    formsub();
});</pre>
</div>
<p>显示效果：</p>
<p>有栏目为空时点击提交按钮</p>
<p></p>
<p></p>
<p><strong>注册以及发送邮件</strong>：</p>
<p>使用了Zend Framework( 1.11.11 )中的zend_email组件。Zend Framework的下载地址是：https://packages.zendframework.com/releases/ZendFramework-1.11.11/ZendFramework-1.11.11.zip。在Zend Framework根目录下library路径下，剪切Zend文件至服务器下，在注册页面中引入Zend/Mail/Transport/Smtp.php和Zend/Mail.php两个文件。</p>
<p>当点击提交按钮时，表单将数据提交至register_chk.php，然后页面在当前页跳转至register_back.html，通知用户注册结果并且进邮箱激活。</p>
<p>验证邮箱的地址参数使用用户名和一个随机生成的key。</p>
<p>register_chk.php:</p>
<div class="phpstudycode">
<pre class="brush:php;">
&lt;&#63;php 

  include_once 'conn/conn.php';
  include_once 'Zend/Mail/Transport/Smtp.php';
  include_once 'Zend/Mail.php';
  
  //激活key,生成的随机数
  $key = md5(rand());
  
  //先写入数据库，再发邮件
  //写入数据库
  //判断是否开启magic_quotes_gpc
  if(get_magic_quotes_gpc()){
  
    $postuname = $_POST['uname'];
    $postupwd = $_POST['upwd'];
    $postuemail = $_POST['uemail'];
  }else{
    
    $postuname = addslashes($_POST['uname']);
    $postupwd = addslashes($_POST['upwd']);
    $postuemail = addslashes($_POST['uemail']);
  }

  function check_input($value){
  
    // 如果不是数字则加引号
    if (!is_numeric($value)){
    
      $value = mysql_real_escape_string($value);
    }
    return $value;
  }
  
  $postuname = check_input($postuname);
  $postupwd = check_input($postupwd);
  $postuemail = check_input($postuemail);

  $sql = "insert into user(uname,upwd,uemail,activekey)values('".trim($postuname)."','".md5(trim($postupwd))."','".trim($postuemail)."','".$key."')";

  $num = $conne-&gt;uidRst($sql);
  if($num == 1){
    
    //插入成功时发送邮件
    //用户激活链接
    $url = 'http://'.$_SERVER['HTTP_HOST'].'/php/myLogin/activation.php';
    //urlencode函数转换url中的中文编码
    //带反斜杠
    $url.= '&#63;name='.urlencode(trim($postuname)).'&k='.$key;
    //定义登录使用的邮箱
    $envelope = 'dee1566@126.com';
    
    //激活邮件的主题和正文
    $subject = '激活您的帐号';
    $mailbody = '注册成功，&lt;a href="'.$url.'" target="_blank"&gt;请点击此处激活帐号&lt;/a&gt;';
    
    //发送邮件
    //SMTP验证参数
    $config = array(
        
        'auth'=&gt;'login',
        'port' =&gt; 25,
        'username'=&gt;'dee1566@126.com',
        'password'=&gt;'你的密码'
        );
    
    //实例化验证的对象,使用gmail smtp服务器
    $transport = new Zend_Mail_Transport_Smtp('smtp.126.com',$config);
    $mail = new Zend_Mail('utf-8');
    
    $mail-&gt;addTo($_POST['uemail'],'获取用户注册激活链接');
    $mail-&gt;setFrom($envelope,'发件人');
    $mail-&gt;setSubject($subject);
    $mail-&gt;setBodyHtml($mailbody);
    $mail-&gt;send($transport);

    echo "&lt;script&gt;self.location=\"templets/register_back.html\";&lt;/script&gt;";

  }else{
  
    echo "&lt;script&gt;self.location=\"templets/register_back.html&#63;error=1\";&lt;/script&gt;";
  }
&#63;&gt;</pre>
</div>
<p></p>
<p>邮箱中收取的邮件截图：</p>
<p></p>
<p>然后点击邮箱中的链接进行激活，把数据库中的active设置为1。</p>
<p>activation.php:</p>
<div class="phpstudycode">
<pre class="brush:xhtml;">
&lt;&#63;php 
session_start();
header('Content-type:text/html;charset=utf-8');
include_once 'conn/conn.php';

$table = "user";

if(!empty($_GET['name']) && !is_null($_GET['name'])){
          
  //urlencode会对字符串进行转义。所以这里要进行处理
  if(get_magic_quotes_gpc()){
  
    $getname = stripslashes(urldecode($_GET['name']));
  }else{
  
    $getname = urldecode($_GET['name']);
  }

  //urldecode反转url中的中文编码
  $sql = "select * from ".$table." where uname='".$getname."' and activekey='".$_GET['k']."'";

  $num = $conne-&gt;getRowsNum($sql);
  if($num&gt;0){
    
    $rs = $conne-&gt;getRowsRst($sql);  

    //此时数据库里的字符串是不会带反斜杠的  
    //因此要为下面的SQL语句加上反斜杠
    $rsname = addslashes($rs['uname']);

    $upnum = $conne-&gt;uidRst("update ".$table." set active = 1 where uname = '".$rsname."' and activekey = '".$rs['activekey']."'");

    if($upnum&gt;0){
      
      $_SESSION['name'] = urldecode($getname);
      echo "&lt;script&gt;alert('您已成功激活');window.location.href='main.php';&lt;/script&gt;";
    }else{
      
      echo "&lt;script&gt;alert('您已经激活过了');window.location.href='main.php';&lt;/script&gt;";
    }
  }else{
    
    echo "&lt;script&gt;alert('激活失败');window.location.href='templets/register.html';&lt;/script&gt;";
  }
}

&#63;&gt;</pre>
</div>
<p>关于注册成功后的邮件页和跳转页，这里不做了。</p>
<p>关于数据库防注入的几种方式magic_quote_gpc，addslashes/stripslashes，mysql_real_eascpae_string，我做了一张表格</p>
<p></p>
<p></p>
<p>附</p>
<p>数据库设计：</p>
<p>user表</p>
<div class="phpstudycode">
<pre class="brush:sql;">
create table user (id int primary key auto_increment,
uname varchar(14) not null default '',
upwd char(32) not null default '',
uemail varchar(50) not null default '',
active tinyint(4) default '0',
activekey char(32) not null defalut '')engine=innodb default charset=utf8</pre>
</div>
<p>说明：md5的长度是32。</p>
<p>模块的目录结构如下：</p>
<p>ROOT:<br />
├─conn<br />
│ ├─conn.php<br />
│<br />
├─templets<br />
│ ├─css<br />
│ │ ├─common.css<br />
│ │ ├─register.css<br />
│ │<br />
│ ├─images<br />
│ │<br />
│ └─js<br />
│ ├─jquery-1.8.3.min.js<br />
│ ├─register.js<br />
│ ├─emailup.js<br />
│<br />
├─chkname.php<br />
├─chkemail.php<br />
├─valcode.php<br />
├─register_chk.php<br />
├─activation.php<br />
├─arial.ttf<br />
│<br />
└─Zend</p>
<p>模块至此结束。</p>
<hr></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/php/biji/92582.html'>jQuery实现的动态伸缩导航菜单实例</a><a>下一篇</a><a href='/php/biji/92584.html'>Win10浏览器对决 续航最强的竟然是IE和edge</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>