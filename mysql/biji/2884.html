<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>SQL Server数据汇总用法_mysql教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了SQL Server数据汇总用法，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
本文我们将讨论如何使用GROUPBY子" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
	    <a href="/mysql/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>数据库笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">SQL Server数据汇总用法</h1>
					</div>
                    <div class="panel-title">
                        2022-11-12 09:41:24                    </div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了SQL Server数据汇总用法，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
本文我们将讨论如何使用GROUPBY子</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了SQL Server数据汇总用法，具有一定的参考价值，可以用来参考一下。</p>

<p>对此感兴趣的朋友，看看idc笔记做的技术笔记！</p>
<p>本文我们将讨论如何使用GROUPBY子句来汇总数据。</p>
<p></p>
<h3>使用单独列分组</h3>
<p></p>
<p>GROUP BY子句通过设置分组条件来汇总数据，在第一个例子中，我在数据库AdventureWork2012中的表 Sales.SalesOrderDetail.中的一列上进行数据分组操作。这个例子以及其他例子都使用数据库AdventureWorks2012，如果你想使用它运行我的代码，你可以点击下载。</p>
<p>下面是第一个示例的源码，在CarrierTrackingNumber列上使用group by子句进行数据分组操作</p>
<p>代码如下：</p>
<pre>
<code>
USE AdventureWorks2012; 
 
GO 
 
SELECT CarrierTrackingNumber 
 
,SUM(LineTotal) AS SummarizedLineTotal 
 
FROM AdventureWorks2012.Sales.SalesOrderDetail 
 
GROUP BY CarrierTrackingNumber; 
</code></pre>
<p>在我运行这段代码后，会得到3807个记录，下面是这个庞大的结果集中前五个数值：</p>
<p>代码如下：</p>
<pre>
<code>
CarrierTrackingNumber LineTotal 
 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
 
6E46-440A-B5 2133.170700 
 
B501-448E-96 4085.409800 
 
8551-4CDF-A1 72616.524200 
 
B65C-4867-86 714.704300 
 
99CE-4ADA-B1 16185.429200 
</code></pre>
<p>在上面的示例中，我使用group by子句选择哪些列作为聚集dventureWorks2012.Sales.SalesOrderDetai数据表数据的条件，在例子中，我使用CarrierTrackingNumber汇总数据，当你进行数据分组时，只有在group By 子句中出现的列才在selection 列表中有效。在我的示例中，我使用聚集函数SUM计算LineTotal，为了使用方便，我为它设置了别名SummarizedLineTotal。</p>
<p>如果我想获得CarrierTrackingNumber 满足特定条件下的聚集集合，那我可以在Where子句中对查询进行限制，就像我下面做的这样：</p>
<p>代码如下：</p>
<pre>
<code>
USE AdventureWorks2012; 
 
GO 
 
SELECT CarrierTrackingNumber 
 
,SUM(LineTotal) AS SummarizedLineTotal 
 
FROM AdventureWorks2012.Sales.SalesOrderDetail 
 
WHERE CarrierTrackingNumber = '48F2-4141-9A' 
 
GROUP BY CarrierTrackingNumber; 
</code></pre>
<p>这里我在原始查询基础上在where子句中加上了一条限制，我设置了我的查询只返回CarrierTrackingNumber 等于一个特定值的结果。运行这段代码后，我会得到记录中CarrierTrackingNumber 等于48F2-4141-9A的行的数量。Where子句的过滤行为在数据被聚集之前就已生效。</p>
<p></p>
<h3>通过多列来分组</h3>
<p></p>
<p>有时候你可能需要使用多列来进行数据分组，下面是我使用多列进行分组的示例代码</p>
<p>代码如下：</p>
<pre>
<code>
SELECT D.ProductID 
 
, H.OrderDate 
 
, SUM(LineTotal) AS SummarizedLineTotal 
 
FROM AdventureWorks2012.Sales.SalesOrderDetail D 
 
JOIN AdventureWorks2012.Sales.SalesOrderHeader H 
 
ON D.SalesOrderId = H.SalesOrderID 
 
GROUP BY ProductID, OrderDate; 
</code></pre>
<p>查询返回26878行数据，这是上面查询返回的部分结果：</p>
<p>代码如下：</p>
<pre>
<code>
ProductID OrderDate LineTotal 
 
-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- 
 
714 2008-05-21 00:00:00.000 99.980000 
 
859 2007-11-03 00:00:00.000 48.980000 
 
923 2007-11-23 00:00:00.000 14.970000 
 
712 2007-12-22 00:00:00.000 62.930000 
 
795 2007-10-14 00:00:00.000 2443.350000 
 
950 2007-07-01 00:00:00.000 2462.304000 
 
795 2007-11-06 00:00:00.000 2443.350000 
 
877 2007-11-19 00:00:00.000 15.900000 
 
713 2007-10-01 00:00:00.000 99.980000 
 
860 2008-05-31 00:00:00.000 48.980000 
 
961 2008-05-01 00:00:00.000 36242.120880 
</code></pre>
<p>在上面的示例程序中，Group by 子句中用到了ProductID列与OrderDate列，SQL Server基于ProductID和OrderDate二者组合的唯一性，返回LineTotal的值，并为其设置别名SummarizedLineTotal。如果你查看程序的输出，你会发现SQL Server 对数据进行分组后，返回的结果并没有特定的顺序，如果你需要返回结果按照一定顺序排序，你需要使用ORDER BY 子句，就像我在下面代码中展示的那样。</p>
<p>代码如下：</p>
<pre>
<code>
SELECT D.ProductID 
 
, H.OrderDate 
 
, SUM(LineTotal) AS SummarizedLineTotal 
 
FROM AdventureWorks2012.Sales.SalesOrderDetail D 
 
JOIN AdventureWorks2012.Sales.SalesOrderHeader H 
 
ON D.SalesOrderId = H.SalesOrderID 
 
GROUP BY ProductID, OrderDate 
 
ORDER BY SummarizedLineTotal DESC; 
</code></pre>
<p>在上面的代码中，我按照SummorizedLineTotal降序对结果集进行排序，此列的值通过Group BY子句分组后对LineTotal使用聚合函数Sum得到。我对结果按照SummorizedLineTotal 的值降序排列。如果你运行此程序，你可以得出LineTotal 数量最高的ProductID和OrderDate。</p>
<p>对没有任何值的数据进行分组</p>
<p>有时候你会需要对一些记录中包含空值的数据进行分组操作。当你在SQL Server 执行此类操作时，它会自动假设所有NULL值相等。让我看一下下面的示例程序</p>
<p>代码如下：</p>
<pre>
<code>
CREATE TABLE NullGroupBy (OrderDate date, Amount Int); 
 
INSERT INTO NullGroupBy values (NULL,100), 
 
('10-30-2014',100), 
 
('10-31-2014',100), 
 
(NULL,100); 
 
SELECT OrderDate, SUM(Amount) as TotalAmount 
 
FROM NullGroupBy 
 
GROUP BY OrderDate; 
 
DROP TABLE NullGroupBy; 
 
When I run this code I get the following output: 
 
OrderDate TotalAmount 
 
-- -- -- -- -- -- -- -- -- -- - 
 
NULL 200 
 
2014-10-30 100 
 
2014-10-31 100 
</code></pre>
<p>在上面的程序中，我首先创建并填充了一个NullGroupBy表.在这个表中，我放置了四个不同的行，第一行和最后一行的orderDate列值为NULL，其他两列的orderDate值不同。从上面的输出结果可以看到，SQL Server 在分组时将OrderDate为NULL的两行聚集为一行处理。</p>
<p>在Group BY 子句中使用表达式</p>
<p>有时你需要在Group by子句中使用表达式，而不是具体的列。SQL Server允许你在Group By子句中指定一个表达式，就像下面的代码中所示：</p>
<p>代码如下：</p>
<pre>
<code>
SELECT CONVERT(CHAR(7),H.OrderDate,120) AS [YYYY-MM] 
 
, SUM(LineTotal) AS SummarizedLineTotal 
 
FROM AdventureWorks2012.Sales.SalesOrderDetail D 
 
JOIN AdventureWorks2012.Sales.SalesOrderHeader H 
 
ON D.SalesOrderId = H.SalesOrderID 
 
GROUP BY CONVERT(CHAR(7),H.OrderDate,120) 
 
ORDER BY SummarizedLineTotal DESC; 
</code></pre>
<p>上述代码使用OrderDate 列中的年月数据进行分组，通过使用表达式CONVERT(CHAR(7),H.OrderDate,120) ，我告诉SQL服务器截取OrderDate ODBC标准日期格式的前七个字符，也就是OrderDate yyyy-mm部分。基于这个表达式，我可以找出特定年月的total SummarizeLineTotal值，在Group By子句中使用表达式，以及对LineTotal值排序，我可以找出哪一年哪一个月的SummarizeLineTotal最大或最小。</p>
<p></p>
<h3>使用HAVING子句过滤数据</h3>
<p></p>
<p>Having 是另外一个能与Group BY 子句结合使用的重要子句，使用Having 子句，你可以过滤掉不符合Having子句所接表达式的数据行，当我在其上使用where子句时，在聚集之前就会产生过滤行为。Having 子句允许你基于某些标准过滤聚合行。想要更清楚地了解Having子句，请参考下面代码：</p>
<p>代码如下：</p>
<pre>
<code>
SELECT D.ProductID 
 
, H.OrderDate 
 
, SUM(LineTotal) AS SummarizedLineTotal 
 
FROM AdventureWorks2012.Sales.SalesOrderDetail D 
 
JOIN AdventureWorks2012.Sales.SalesOrderHeader H 
 
ON D.SalesOrderId = H.SalesOrderID 
 
GROUP BY ProductID, OrderDate 
 
HAVING SUM(LineTotal) &gt; 200000 
 
ORDER BY SummarizedLineTotal DESC; 
</code></pre>
<p>在上面的代码中Having子句限制条件是SUM(LineTotal) &gt; 200000。这个having子句保证最终结果中LineTotal的聚合值（SummarizedLineTotal）大于200000.通过使用having子句，我的查询只返回一行数据，其SummarizedLineTotal大于200000.having子句允许SQL Server 只返回聚合结果满足Having子句限制的条件的数据行。</p>
<p></p>
<h3>总结</h3>
<p></p>
<p>许多应用要求数据在展示之前要经过一定的汇总操作，GROUP BY子句就是SQL Server提供的汇总数据的机制。GROUPBY子句允许你使用HAVING子句对汇总数据进行特定的过滤。希望下次你需要汇总一些数据的时候，你可以更加容易的达到目的。</p>

<p>注：关于SQL Server数据汇总用法的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>
			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/mysql/biji/2883.html'>SQL Server给表增加多个字段的语法</a><a>下一篇</a><a href='/mysql/biji/2885.html'>使用NotePad++录制宏功能如何快速将sql搜索条件加上前后单引号</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>