<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>诊断SQLSERVER问题常用的日志概述及使用_mysql教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了诊断SQLSERVER问题常用的日志概述及使用，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
诊断SQLSERVER问题" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
	    <a href="/mysql/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>数据库笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">诊断SQLSERVER问题常用的日志概述及使用</h1>
					</div>
                    <div class="panel-title">
                        2022-11-12 09:42:04                    </div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了诊断SQLSERVER问题常用的日志概述及使用，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
诊断SQLSERVER问题</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了诊断SQLSERVER问题常用的日志概述及使用，具有一定的参考价值，可以用来参考一下。</p>

<p>对此感兴趣的朋友，看看idc笔记做的技术笔记！</p>
<p><strong>诊断SQLSERVER问题常用的日志</strong></p>
<p><strong>这里主要有两个：</strong></p>
<p><strong>（1）Windows事件日志</strong></p>
<p><strong>（2）SQLSERVER ErrorLog</strong></p>
<p><strong>1、Windows事件日志 Event Log</strong></p>
<p>作为一个Windows开启和管理的服务程序，Windows会在自己的系统日志system log里记录SQLSERVER这个服务的启动、正常关闭、异常关闭等信息。</p>
<p>SQLSERVER也会把自己的一些概要信息同时记录在Windows的应用程序日志里Application Log而Windows日志本身又能够反映操作系统的健康情况，是否有任何软件或硬件的异常。</p>
<p>如果Windows本身不能正常工作，SQLSERVER的运行一定会受到影响。</p>
<p>当遇到一些问题需要微软的售后工程师解决的时候，Windows事件日志是一个很好的界定问题性质的工具。</p>
<p>在Windows里，点击&ldquo;开始&rdquo;-》运行 -》输入：eventvwr 点确定 就可以打开事件查看器Event Viewer</p>
<p>在Windows7、Windows2008和Windows2008R2里面，界面会有所不同，但是主要内容还是类似的</p>
<p>【图片暂缺】</p>
<p>Windows主要有三种日志：应用程序，安全，系统 （我的系统是Windows7）</p>
<p>【图片暂缺】</p>
<p>对于SQLSERVER会主要关心<strong>应用程序</strong>日志和<strong>系统</strong>日志。当处理一些连接认证问题时，可能会偶尔用上<strong>安全</strong>日志。</p>
<p>日志里的每一条记录，都属于<strong>信息</strong>、<strong>警告</strong>、<strong>错误</strong>中的一类。</p>
<p>每条记录都会标明日期、时间、来源、事件ID。</p>
<p>如果在应用日志里，从SQLSERVER产生的记录其来源名称都会是<strong>MSSQLSERVER</strong></p>
<p>双击某一条记录，Windows会弹出一个对话框，显示记录的具体内容</p>
<p>【图片暂缺】</p>
<p></p>
<p>在这里说一下我遇到的机器内存不足，导致SQLSERVER需要把内存换出去硬盘的情况，导致经常SQLSERVER反应缓慢</p>
<p>事件查看器显示的信息就是上面那个截图，一句话概括就是：<strong>系统内存不足</strong></p>
<p>我的机器情况：</p>
<p>【图片暂缺】</p>
<p></p>
<p>8GB内存没有用尽，因为32位操作系统的关系，迟一点打算更换为64位Windows7</p>
<p></p>
<p>所以平时多看一下事件查看器或者遇到问题的时候就先看事件查看器，一定能找到一些问题的蛛丝马迹</p>
<p>另外一个，在事件查看器里，还能把日志另存为*.evt文件或*.txt文件，以供DBA带到其他机器上打开分析。</p>
<p>打开一个*.evt文件的方法是：是右键点击&ldquo;事件查看器（本地）&rdquo;树型结构---》打开保存的日志</p>
<p><strong>【图片暂缺】</strong></p>
<p><strong>【图片暂缺】</strong></p>
<p>用这种方法，DBA就能像看本机上的日志记录一样，分析从其他机器保存下来的日志文件了</p>
<p>保存的时候可以保存单个事件或者整个类别的事件</p>
<p>【图片暂缺】</p>
<p>【图片暂缺】</p>
<p>最后，用事件日志查看器打开的日志，其时间会和时区有关系的，</p>
<p>不同时区设置的机器打开一个*.evt文件，其显示的时间会不一样。</p>
<p>例如，如果某个错误信息发生在美国的白天，那么用在中国的机器打开，其时间会显示在晚上</p>
<p>如果你按美国时间找，就会找不到了。但是保存成 *.txt格式 文本文件格式就不会有这种问题</p>
<p></p>
<hr />
<p><strong>2、SQLSERVER ErrorLog文件</strong></p>
<p>检查完Windows的基本状况后，就可以开始检查SQLSERVER的健康状况。</p>
<p>不管你是遇到什么问题，建议第一个要检查的是SQLSERVER的<strong>ErrorLog</strong>文件</p>
<p>当SQLSERVER启动的时候，会在某个固定的路径下生成一个&ldquo;<strong>errorlog</strong>&rdquo;的文件</p>
<p>SQLSERVER默认会保留7份errorlog文件，按照时间顺序，依次用文件扩名.1,.2,.3,...,.6表示。</p>
<p>每重启一次服务，文件扩展名都会加一，最早的那份会被删除。</p>
<p></p>
<p>日志文件的默认路径是安装路径下的C:\Program Files\Microsoft SQL Server\MSSQL.1\MSSQL\LOG\LOG子目录。</p>
<p>C:\Program Files是我的机器的安装路径，这个路径是你安装SQLSERVER的时候选择的</p>
<p>当然DBA也能够修改其设置（在配置管理器里，双击sql服务-》高级-》转储目录）</p>
<p>【图片暂缺】</p>
<p>发觉Windows对错误日志或者目录都叫转储的，像某些软件，例如QQ，有道词典好像也是用dmp格式的转储文件</p>
<p>【图片暂缺】</p>
<p></p>
<p>说回正题o(&cap;_&cap;)o</p>
<p>如果你要分析的是一台陌生的服务器，可以用很多种方法找到errorlog路径。</p>
<p>一种比较简单的方法是在SQLSERVER 配置管理器里选择SQL服务，在其属性-》高级里找到一个&ldquo;启动参数&rdquo;的高级属性</p>
<p>在属性字符串里，会有一个&ldquo;-e&rdquo;的参数。他的后面就是跟errorlog文件的位置</p>
<p>【图片暂缺】</p>
<p></p>
<p>或者干脆在上面说的转储目录就可以看到了</p>
<p>errorlog文件以文本方式记录，用任何文件编辑器，包括记事本，SSMS都能打开</p>
<p>一般来讲，errorlog文件的大小不会很大。用这些工具完全能够满足需求</p>
<p>但是，errorlog本身非常重要，他记录了SQL的整个开启、运行、终止过程。</p>
<p>如果SQLSERVER遇到了比较严重的问题，在errorlog里都会有所显示</p>
<p>ErrorLog显示包括以下内容：</p>
<p><strong>（1）SQL的版本，以及Windows和Processor基本信息</strong></p>
<p><strong>（2）SQL的启动参数，以及认证模式，内存分配模式</strong></p>
<p><strong>（3）每个数据库是否能够被正常打开。如果不能，原因是什么</strong></p>
<p><strong>（4）数据库损坏相关的错误</strong></p>
<p><strong>（5）数据库备份与恢复动作记录</strong></p>
<p><strong>（6）DBCC CHECKDB记录</strong></p>
<p><strong>（7）内存相关的错误和警告</strong></p>
<p><strong>（8）SQL调度出现异常时的警告。一般SERVER HANG 服务器死机会伴随着有这些警告</strong></p>
<p><strong>（9）SQL I/O操作遇到长时间延迟的警告</strong></p>
<p><strong>（10）SQL在运行过程中遇到的其他级别比较高的错误</strong></p>
<p><strong>（11）SQL内部的访问越界错误（Access Violation）</strong></p>
<p><strong>（12）SQL服务关闭时间</strong></p>
<p>在检查SQLSERVER相关问题的时候，总是从errorlog着手，先确认errorlog里是干净的。</p>
<p>如果errorlog里有一些错误或警告，就要确认这些错误和警告发生的时间，是不是前端感觉到问题的时间。</p>
<p>如果时间能对得上，那就要着重分析一下</p>
<p>如果开启一些设置，在errorlog里还能看到的有用信息有：</p>
<p><strong>（1）所有用户成功或失败的登入</strong></p>
<p><strong>（2）死锁以及其参与者的信息：需要打开跟踪标志1222 或1204</strong></p>
<p>代码如下:</p>
<pre>

<code>DBCC TRACEON(1222)
DBCC TRACEON(1204) 
</code></pre>
<hr />
<p></p>
<p><strong>有时候errorlog也不是万能的哦？他不能反映的问题有</strong>：</p>
<p>（1）阻塞问题。只要阻塞还没有严重影响SQLSERVER的线程调度，errorlog里是不会有体现</p>
<p>（2）普通性能问题，超时问题。如果性能问题不是由于内存使用异常、线程调度异常，或者是I/O子系统反应非常缓慢，</p>
<p>而是由于表格或语句设计导致，errorlog里也不会有所反映</p>
<p>（3）Windows层面异常。如果Windows层面出现工作不正常，或者服务器不响应，SQLSERVER很难自我判断的</p>
<p>上面这三个问题，errorlog里一般不会有所体现。这也是我们为什麽要第一步就要检查Event Log的原因</p>
<p>下面给出一个errorlog的内容出来讲解</p>

<p>注：关于诊断SQLSERVER问题常用的日志概述及使用的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>
			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/mysql/biji/2952.html'>sql 语句练习与答案</a><a>下一篇</a><a href='/mysql/biji/2954.html'>SQL Server sql中count或sum为条件的查询示例(sql查询count)</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>