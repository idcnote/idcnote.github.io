<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>MySQL开发规范_mysql教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了MySQL开发规范，具有一定的参考价值，可以用来参考一下。

写在前面：无规矩不成方圆。对于刚加入互联网的朋友们，肯定会接触到MySQL，MySQL作为互联网" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
	    <a href="/mysql/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>数据库笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">MySQL开发规范</h1>
					</div>
                    <div class="panel-title">
                        2022-11-12 09:55:36                    </div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了MySQL开发规范，具有一定的参考价值，可以用来参考一下。

写在前面：无规矩不成方圆。对于刚加入互联网的朋友们，肯定会接触到MySQL，MySQL作为互联网</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了MySQL开发规范，具有一定的参考价值，可以用来参考一下。</p>

<p>写在前面：无规矩不成方圆。对于刚加入互联网的朋友们，肯定会接触到MySQL，MySQL作为互联网最流行的关系型数据库产品，它有它擅长的地方，也有它不足的短板，针对它的特性，结合互联网大多应用的特点，笔者根据自己多年互联网公司的MySQL DBA经验，现总结出互联网MySQL的一些开发规范，仅供参考。</p>
<p>摘要：基础规范</p>
<p>命名规范</p>
<p>库、表、字段开发设计规范</p>
<p>索引规范</p>
<p>SQL规范</p>
<p>流程规范</p>
<h4>一)<b>基础规范</b></h4>
<p>(1) 使用INNODB存储引擎(2) 表字符集使用UTF8(3) 所有表都需要添加注释(4) 单表数据量建议控制在5000W以内(5) 不在数据库中存储图、文件等大数据(6) 禁止在线上做数据库压力测试(7) 禁从测试、开发环境直连数据库</p>
<h4>二)<b>命名规范</b></h4>
<p>(1) 库名表名字段名必须有固定的命名长度，12个字符以内(2) 库名、表名、字段名禁止超过32个字符。须见名之意(3) 库名、表名、字段名禁止使用MySQL保留字(4) 临时库、表名必须以tmp为前缀，并以日期为后缀(5) 备份库、表必须以bak为前缀，并以日期为后缀</p>
<h4>三)<b>库、表、字段开发设计规范</b></h4>
<p>(1) 禁使用分区表(2) 拆分大字段和访问频率低的字段，分离冷热数据(3) 用HASH进散表，表名后缀使进制数，下标从0开始(4) 按日期时间分表需符合YYYY[MM][DD][HH]格式(5) 采用合适的分库分表策略。例如千库十表、十库百表等(6) 尽可能不使用TEXT、BLOB类型(7) 用DECIMAL代替FLOAT和DOUBLE存储精确浮点数(8) 越简单越好：将字符转化为数字、使用TINYINT来代替ENUM类型(9) 所有字段均定义为NOT NULL(10) 使用UNSIGNED存储非负整数(11) INT类型固定占用4字节存储(12) 使用timestamp存储时间(13) 使用INT UNSIGNED存储IPV4(14) 使用VARBINARY存储大小写敏感的变长字符串(15) 禁止在数据库中存储明文密码，把密码加密后存储(16) 用好数值类型字段Tinyint (1Byte)smallint (2Byte)mediumint (3Byte)int (4Byte)</p>
<p>bigint (8Byte)<img alt="" src="http://www.512pic.com/d/file/20181008/b0e5ad21a346ba24a9be96780a480bb5.jpg" style="width: 475px; height: 402px;" /></p>
<h4><span style="line-height: 1.6;">四)</span><b style="line-height: 1.6;">索引规范</b></h4>
<p>如果数值字段没有那么大，就不要用 bigint(17) 存储ip最好用int存储而非char(15)(18) 不允许使用ENUM(19) 避免使用NULL字段NULL字段很难查询优化，NULL字段的索引需要额外空间，NULL字段的复合索引无效(20) 少用text/blob，varchar的性能会比text高很多，实在避免不了blob，请拆表(21) 数据库中不允许存储大文件，或者照片，可以将大对象放到磁盘上，数据库中存储它的路径</p>
<p>1、索引的数量要控制：(1) 单张表中索引数量不超过5个(2) 单个索引中的字段数不超过5个(3) 对字符串使用前缀索引，前缀索引长度不超过8个字符(4) 建议优先考虑前缀索引，必要时可添加伪列并建立索引</p>
<p>2、主键准则(1) 表必须有主键(2) 不使用更新频繁的列作为主键(3) 尽量不选择字符串列作为主键(4) 不使用UUID MD5 HASH这些作为主键(数值太离散了)(5) 默认使非空的唯一键作为主键(6) 建议选择自增或发号器</p>
<p>3、重要的SQL必须被索引，比如：(1) UPDATE、DELETE语句的WHERE条件列(2) ORDER BY、GROUP BY、DISTINCT的字段</p>
<p>4、多表JOIN的字段注意以下：(1) 区分度最大的字段放在前面(2) 核SQL优先考虑覆盖索引(3) 避免冗余和重复索引(4) 索引要综合评估数据密度和分布以及考虑查询和更新比例</p>
<p>5、索引禁忌(1) 不在低基数列上建立索引，例如&ldquo;性别&rdquo;(2) 不在索引列进行数学运算和函数运算</p>
<p>6、尽量不使用外键(1) 外键用来保护参照完整性，可在业务端实现(2) 对父表和子表的操作会相互影响，降低可用性</p>
<p>7、索引命名：非唯一索引必须以 idx_字段1_字段2命名，唯一所以必须以uniq_字段1_字段2命名，索引名称必须全部小写8、新建的唯一索引必须不能和主键重复9、索引字段的默认值不能为NULL，要改为其他的default或者空。NULL非常影响索引的查询效率10、反复查看与表相关的SQL，符合最左前缀的特点建立索引。多条字段重复的语句，要修改语句条件字段的顺序，为其建立一条联合索引，减少索引数量11、能使用唯一索引就要使用唯一索引，提高查询效率12、研发要经常使用explain，如果发现索引选择性差，必须让他们学会使用hint</p>
<h4>五)<b>SQL规范</b></h4>
<p>(1) sql语句尽可能简单大的sql想办法拆成小的sql语句(充分利用QUERY CACHE和充分利用多核CPU)(2) 事务要简单，整个事务的时间长度不要太长(3) 避免使用触发器、函数、存储过程(4) 降低业务耦合度，为sacle out、sharding留有余地(5) 避免在数据库中进数学运算(MySQL不擅长数学运算和逻辑判断)(4) 不要用select *，查询哪几个字段就select 这几个字段(5) sql中使用到OR的改写为用 IN() (or的效率没有in的效率高)(6) in里面数字的个数建议控制在1000以内(7) limit分页注意效率。Limit越大，效率越低。可以改写limit，比如例子改写：select id from tlimit 10000, 10; =&gt; select id from t where id &gt; 10000 limit10;(9) 使用union all替代union(10) 避免使大表的JOIN(11) 使用group by 分组、自动排序(12) 对数据的更新要打散后批量更新，不要一次更新太多数据(13) 减少与数据库的交互次数(13) 注意使用性能分析工具Sql explain / showprofile / mysqlsla(14) SQL语句要求所有研发，SQL关键字全部是大写，每个词只允许有一个空格(15) SQL语句不可以出现隐式转换，比如 select id from 表 where id=&#39;1&#39;(16) IN条件里面的数据数量要少，我记得应该是500个以内，要学会使用exist代替in，exist在一些场景查询会比in快(17) 能不用NOT IN就不用NOTIN，坑太多了。。会把空和NULL给查出来(18) 在SQL语句中，禁止使用前缀是%的like(19) 不使用负向查询，如not in/like(19) 关于分页查询：程序里建议合理使用分页来提高效率limit，offset较大要配合子查询使用(20) 禁止在数据库中跑大查询(21) 使预编译语句，只传参数，比传递SQL语句更高效；一次解析，多次使用；降低SQL注入概率(22) 禁止使order by rand()(23) 禁单条SQL语句同时更新多个表</p>
<h4>六)<b>流程规范</b></h4>
<p>(1) 所有的建表操作需要提前告知该表涉及的查询sql；(2) 所有的建表需要确定建立哪些索引后才可以建表上线；(3) 所有的改表结构、加索引操作都需要将涉及到所改表的查询sql发出来告知DBA等相关人员；(4) 在建新表加字段之前，要求研发至少要提前3天邮件出来，给dba们评估、优化和审核的时间(5)批量导入、导出数据必须提前通知DBA协助观察(6) 禁在线上从库执行后台管理和统计类查询(7) 禁有super权限的应用程序账号存在(8) 推广活动或上线新功能必须提前通知DBA进行流量评估(9) 不在业务高峰期批量更新、查询数据库</p>

<p>注：关于MySQL开发规范的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>
			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/mysql/biji/4408.html'>MySQL授权许可解析</a><a>下一篇</a><a href='/mysql/biji/4410.html'>sql server 游标实例：循环表内数据，并根据参数 查询其他表内数据，拼接SQL 插入另一个表示例</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>