<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>SQL Server 数据库基本操作语句总结_mysql教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了SQL Server 数据库基本操作语句总结，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！

代码如下:


--sql基" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
	    <a href="/mysql/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>数据库笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">SQL Server 数据库基本操作语句总结</h1>
					</div>
                    <div class="panel-title">
                        2022-11-12 09:45:14                    </div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了SQL Server 数据库基本操作语句总结，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！

代码如下:


--sql基</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了SQL Server 数据库基本操作语句总结，具有一定的参考价值，可以用来参考一下。</p>

<p>对此感兴趣的朋友，看看idc笔记做的技术笔记！</p>
<p></p>
<p>代码如下:</p>
<pre>

<code>--sql基本操作</code></pre>
<p></p>
<p><code class="hljs">--创建数据库</code></p>
<p><code class="hljs">create database Studets</code></p>
<p><code class="hljs">--创建表</code></p>
<p><code class="hljs">create table student ( sno char(5), sname char(20), ssex char(2), sage smallint, sdept char(15) ) </code></p>
<p><code class="hljs">create table course ( cno char(3), cname char(30), cpno char(3), ccredit smallint ) </code></p>
<p><code class="hljs">create table sc ( sno char(5), cno char(3), grade int ) </code></p>
<p><code class="hljs">--查看表信息</code></p>
<p><code class="hljs">select * from student select sno as 学号 from student select * from course select * from sc</code></p>
<p><code class="hljs">--修改表</code></p>
<p><code class="hljs">--插入列</code></p>
<p><code class="hljs">alter table student add scome datetime</code></p>
<p><code class="hljs">--修改列的字段类型 alter table student alter column scome char(50)</code></p>
<p><code class="hljs">--删除 --删除列</code></p>
<p><code class="hljs">alter table student drop column scome</code></p>
<p><code class="hljs">--删除表 drop table student drop table course drop table sc</code></p>
<p><code class="hljs">--完整性约束实现</code></p>
<p><code class="hljs">--sno 非空唯一，ssex检查约束， sage默认大小</code></p>
<p><code class="hljs">create table student ( sno char(5) not null unique, sname char(20), sex char(2), sage smallint default 20, sdept char(15), constraint sex check(sex in(&#39;男&#39;,&#39;女&#39;)), )</code></p>
<p><code class="hljs">--删除表的约束 alter table student drop constraint ssex</code></p>
<p><code class="hljs">--添加字段约束 alter table student add constraint ssex check(sex in(&#39;男&#39;,&#39;女&#39;))</code></p>
<p><code class="hljs">--添加主键约束 alter table student add constraint PK_SNO primary key(sno) create table course ( cno char(3) not null unique, cname char(30), cpno char(3), ccredit smallint )</code></p>
<p><code class="hljs">--关联表主键已经存在，可以如下操作添加主键和外键约束</code></p>
<p><code class="hljs">alter table course add constraint PK_CNO primary key(cno), constraint FK_CPNO foreign key(cpno) REFERENCES sc(cno)</code></p>
<p><code class="hljs">create table sc</code></p>
<p><code class="hljs">( </code></p>
<p><code class="hljs">sno char(5) foreign key references student(sno), </code></p>
<p><code class="hljs">cno char(3) foreign key references course(cno),</code></p>
<p><code class="hljs">grade int, </code></p>
<p><code class="hljs">constraint PK_SC primary key(sno,cno) </code></p>
<p><code class="hljs">) </code></p>
<p><code class="hljs">ALTER TABLE [dbo].[sc] DROP CONSTRAINT [FK__sc__sno__0F975522] </code></p>
<p><code class="hljs">ALTER TABLE [dbo].[sc] DROP CONSTRAINT [PK_SC] </code></p>
<p><code class="hljs">ALTER TABLE [dbo].[sc] DROP CONSTRAINT [PK_SC]</code></p>
<p><code class="hljs">--创建sc后，通过如下修改主外键</code></p>
<p><code class="hljs">alter table sc add constraint PK_SC primary key(sno,cno), </code></p>
<p><code class="hljs">constraint FK_SNO foreign key(sno) references student(sno), </code></p>
<p><code class="hljs">constraint FK_CNO foreign key(cno) references course(cno)</code></p>
<p><code class="hljs">--创建索引。</code></p>
<p></p>
<p></p>
<p>分为聚簇索引（clustered物理顺序）和非聚簇索引（nonclustered逻辑顺序，可多个）</p>
<p></p>
<p>代码如下:</p>
<pre>

</pre>
<p></p>
<p><code>--not null约束字段时候。会创建一个系统内置的约束键值，并且这种非空判断，通过索引查询实现 --的，索引默认创建一个系统索引</code></p>
<p><code>create unique index STUsno</code></p>
<p><code>on student(sno) </code></p>
<p><code>create unique index COUcno </code></p>
<p><code>on course(cno) </code></p>
<p><code>create unique index SCno </code></p>
<p><code>on sc(sno asc,cno desc)</code></p>
<p><code>drop index SCno on sc</code></p>
<p><code>--显示表的数据和索引的碎块信息 DBCC SHOWCONTIG</code></p>
<p><code>--插入数据 select * from student</code></p>
<p><code>alter table student alter column sno char(10)</code></p>
<p><code>insert into student values(&#39;10021&#39;,&#39;张三&#39;,&#39;男&#39;,20,&#39;计科系&#39;) </code></p>
<p><code>insert into student values(&#39;10022&#39;,&#39;王朝&#39;,&#39;女&#39;,18,&#39;软件&#39;) </code></p>
<p><code>insert into student values(&#39;10023&#39;,&#39;朱元璋&#39;,&#39;男&#39;,20,&#39;管理&#39;)</code></p>
<p><code>insert into student values(&#39;10024&#39;,&#39;刘彻&#39;,&#39;男&#39;,18,&#39;军事&#39;) </code></p>
<p><code>insert into student values(&#39;10025&#39;,&#39;刘表&#39;,&#39;男&#39;,20,&#39;商学系&#39;)</code></p>
<p><code>insert into student values(&#39;10026&#39;,&#39;白居易&#39;,&#39;男&#39;,19,&#39;文法&#39;) </code></p>
<p><code>insert into student values(&#39;10027&#39;,&#39;李清照&#39;,&#39;女&#39;,24,&#39;文法&#39;)</code></p>
<p><code>select * from course insert into course values(&#39;001&#39;,&#39;数据库&#39;,&#39;005&#39;,4)</code></p>
<p><code>insert into course values(&#39;002&#39;,&#39;高等数学&#39;,&#39;&#39;,2)</code></p>
<p><code>insert into course values(&#39;003&#39;,&#39;信息系统&#39;,&#39;001&#39;,4) </code></p>
<p><code>insert into course values(&#39;004&#39;,&#39;操作系统&#39;,&#39;006&#39;,2) </code></p>
<p><code>insert into course values(&#39;005&#39;,&#39;数据结构&#39;,&#39;007&#39;,3)</code></p>
<p><code>insert into course values(&#39;006&#39;,&#39;数据处理&#39;,&#39;&#39;,2)</code></p>
<p><code>insert into course values(&#39;007&#39;,&#39;C语言&#39;,&#39;006&#39;,5)</code></p>
<p><code>select * from sc insert into sc values(&#39;10021&#39;,&#39;002&#39;,100)</code></p>
<p><code>insert into sc values(&#39;10021&#39;,&#39;001&#39;,88) </code></p>
<p><code>insert into sc values(&#39;10021&#39;,&#39;006&#39;,100) </code></p>
<p><code>insert into sc values(&#39;10021&#39;,&#39;007&#39;,68)</code></p>
<p><code>insert into sc values(&#39;10022&#39;,&#39;002&#39;,100) </code></p>
<p><code>insert into sc values(&#39;10023&#39;,&#39;005&#39;,30)</code></p>
<p><code>insert into sc values(&#39;10024&#39;,&#39;002&#39;,100)</code></p>
<p><code>insert into sc values(&#39;10024&#39;,&#39;006&#39;,56) </code></p>
<p><code>select * from student --查询操作</code></p>
<p><code>--查询 select * from student select * from course select * from sc</code></p>
<p><code>--去掉重复行 select distinct sno from sc</code></p>
<p><code>--格式化查询</code></p>
<p><code>select sname as &#39;姓名&#39;,2013-sage as &#39;出生日期&#39; from student </code></p>
<p><code>select sname,&#39;出生日期&#39;,2013-sage from student</code></p>
<p><code>select 姓名=sname,出生日期=2013-sage from student</code></p>
<p><code>--条件查询</code></p>
<p><code>select * from course where ccredit&gt;3 </code></p>
<p><code>select * from course where ccredit between 2 and 5 </code></p>
<p><code>select * from course where ccredit&gt; 2 and ccredit&lt;5 </code></p>
<p><code>select * from course where ccredit in(2) </code></p>
<p><code>select * from course where ccredit not in(2)</code></p>
<p><code>--匹配查询</code></p>
<p><code>select * from student where sname like &#39;刘__&#39; </code></p>
<p><code>select * from student where sname like &#39;_表__&#39; </code></p>
<p><code>select * from student where sname like &#39;%表%&#39;</code></p>
<p><code>--算术元算查询</code></p>
<p><code>select grade*(1+0.2) as 总成绩,grade/(10) as 绩点 from sc</code></p>
<p><code>--分组函数查询</code></p>
<p><code>select COUNT(*) as 总人数 from student </code></p>
<p><code>select COUNT(distinct sno) as &#39;选修的总人数&#39; from sc </code></p>
<p><code>select AVG(grade) as &#39;平均成绩&#39; from sc where sno=&#39;10021&#39; </code></p>
<p><code>select MAX(grade) as &#39;MAX成绩&#39; from sc where sno=&#39;10021&#39; </code></p>
<p><code>select MIN(grade) as &#39;MIN成绩&#39; from sc where sno=&#39;10021&#39; </code></p>
<p><code>select SUM(grade) as &#39;总成绩&#39; from sc where sno=&#39;10021&#39; </code></p>
<p><code>select SUM(grade)/COUNT(grade) as &#39;平均成绩&#39; from sc where sno=&#39;10021&#39; </code></p>
<p><code>select SUM(grade) as &#39;总成绩&#39; from sc group by sno having sum(grade)&gt;100 -</code></p>
<p><code>-连接查询、</code></p>
<p><code>--等值连接</code></p>
<p><code>select distinct student.*,sc.* from student,sc where student.sno=sc.sno</code></p>
<p><code>--自身连接</code></p>
<p><code>select distinct A.*,B.* from student A,sc B where A.sno=B.sno</code></p>
<p><code>select B.sname as &#39;同一个系&#39; from student A,student B where A.sname=&#39;白居易&#39; and A.sdept=B.sdept</code></p>
<p><code>--外连接</code></p>
<p><code>select A.*,B.* from student A left join sc B on A.sno=B.sno </code></p>
<p><code>select A.*,B.* from student A right join sc B on A.sno=B.sno </code></p>
<p><code>select A.*,B.* from student A FULL join sc B on A.sno=B.sno</code></p>
<p><code>--复合条件连接</code></p>
<p><code>select * from sc select * from course </code></p>
<p><code>select distinct A.*,B.* from student A,sc B where A.sno=B.sno and B.grade&gt;99 and B.cno=&#39;002&#39; </code></p>
<p><code>select distinct A.*,B.*,C.* from student A,sc B,course C where A.sno=B.sno and B.cno=C.cno and B.grade&gt;99 and B.cno=&#39;002&#39;</code></p>
<p><code>--字符串连接查询</code></p>
<p><code>select sname+sno from student </code></p>
<p><code>select distinct sname from student ,sc where student.sno=sc.sno </code></p>
<p><code>select sname from student ,sc where student.sno=sc.sno and student.sno not in (select sno from sc where grade&lt;60) group by sname</code></p>
<p><code>--子查询</code></p>
<p><code>select * from student where sage&gt;(select AVG(sage) from student)</code></p>
<p><code>--是否存在的查询</code></p>
<p><code>select * from student where exists(select * from sc where sno=student.sno)</code></p>
<p><code>select * from student where not exists(select * from sc where sno=student.sno)</code></p>
<p><code>--sql创建用户 sys.sp_addlogin bnc,bnc,Studets sp_adduser bnc,bnc</code></p>
<p><code>--权限分配和收回</code></p>
<p><code>grant select on student to bnc</code></p>
<p><code>select * from student</code></p>
<p><code>revoke select on student from bnc</code></p>
<p><code>--视图的创建</code></p>
<p><code>create view VIEW_STUGrade(学号,姓名,课程,成绩) </code></p>
<p><code>as</code></p>
<p><code>select student.sno,student.sname,course.cname,sc.grade from student,course,sc</code></p>
<p><code>where student.sno=sc.sno and course.cno=sc.cno and student.sdept=&#39;软件&#39; </code></p>
<p><code>--查看视图</code></p>
<p><code>select * from VIEW_STUGrade</code></p>
<p><code>--视图修改</code></p>
<p><code>alter view VIEW_STUGrade(学号,姓名,课程,成绩) </code></p>
<p><code>as</code></p>
<p><code>select student.sno,student.sname,course.cname,sc.grade from student,course,sc </code></p>
<p><code>where student.sno=sc.sno and course.cno=sc.cno and student.sdept=&#39;软件&#39; </code></p>
<p><code>with check option</code></p>
<p><code>--更新失败后不影响视图查看</code></p>
<p><code>--视图更新</code></p>
<p><code>update VIEW_STUGrade set 姓名=&#39;王超&#39; where 学号=&#39;10022&#39; select * from student where sno=&#39;10022&#39;</code></p>
<p><code>/* 1,可更新视图： a,单个基本表导出的 2，不可更新视图 a 两个以上基本表导出的 b 视图字段来自表达式或者函数 c 嵌套查询的表 d 分组子句使用distinct */</code></p>
<p><code>--删除视图 drop view VIEW_STUGrade</code></p>
<p><code>--高级sql编程</code></p>
<p><code>--数据类型1,int 2,smallint 3,tinyint (0--255) 4,bigint 5char固定长度&lt;800.如：学号，姓名 6，varchar可变长度小于800 7,text 2GB 8，nvarchar1--4000 */</code></p>
<p><code>--运算符和通配符</code></p>
<p><code>select GETDATE()-1 昨天,GETDATE() 今天,GETDATE()+1 明天</code></p>
<p><code>select 59&amp;12</code></p>
<p><code>select 59|12</code></p>
<p><code>select 59^12</code></p>
<p><code>--模糊查询</code></p>
<p><code>select * from student where sname like &#39;%刘%&#39;</code></p>
<p><code>select * from student where sno like &#39;1002[5-9]&#39;</code></p>
<p><code>--控制流程语句</code></p>
<p><code>declare @name char(10) set @name=&#39;司马相如&#39; </code></p>
<p><code>print @name </code></p>
<p><code>--输出一个表达式，不能进行查询 select @name </code></p>
<p><code> --输出多个表达式</code></p>
<p><code>declare @a nvarchar(50),@b nvarchar(50) </code></p>
<p><code>set @a=33 set @b=34 ---简写select@a=33，@b=34</code></p>
<p><code>if @a&gt;@b</code></p>
<p><code>print &#39;最小值是：&#39;+@a </code></p>
<p><code>else </code></p>
<p><code>print &#39;最大值是：&#39;+@b</code></p>
<p><code>--waitfor间隔一段时间执行</code></p>
<p><code>waitfor delay &#39;00:00:04&#39; print &#39;推迟4秒执行&#39;</code></p>
<p><code>waitfor time &#39;17:45:50&#39; print &#39;等待这一时刻执行&#39;</code></p>
<p><code>--创建函数</code></p>
<p><code>CREATE FUNCTION GetTime ( @date1 datetime, @date2 datetime ) </code></p>
<p><code>RETURNS TABLE </code></p>
<p><code>AS RETURN ( </code></p>
<p><code>select datediff(dd,@date1,@date2) 日差,datediff(mm,@date1,@date2) 月差, datediff(yy,@date1,@date2) 年差</code></p>
<p><code>) </code></p>
<p><code>--创建存储过程，</code></p>
<p><code>--查看</code></p>
<p><code>GO create proc [dbo].[sel] (</code></p>
<p><code>@sno char(10) </code></p>
<p><code>) </code></p>
<p><code>as </code></p>
<p><code>select * from student where sno=@sno</code></p>
<p><code>exec sel @sno=&#39;10021&#39;</code></p>
<p><code>--查看</code></p>
<p><code>GO create proc sel2 </code></p>
<p><code>as</code></p>
<p><code>select * from student</code></p>
<p><code>exec sel2</code></p>
<p><code>--修改</code></p>
<p><code>GO create proc updat @sno char(10), @sex char(2) </code></p>
<p><code>as</code></p>
<p><code>update student set sex=@sex where sno=@sno </code></p>
<p><code>select * from student exec updat @sno=&#39;10021&#39;, @sex=&#39;女&#39;</code></p>
<p><code>--删除</code></p>
<p><code>GO create proc dele @sno char(10) </code></p>
<p><code>as </code></p>
<p><code>delete student where sno=@sno </code></p>
<p><code>select * from student</code></p>
<p><code>exec dele @sno=&#39;10029&#39;</code></p>
<p><code>--插入</code></p>
<p><code>GO create proc inser @sno char(10), @sname char(20), @sex char(2), @sage smallint, @sdept char(15) </code></p>
<p><code>as</code></p>
<p><code>insert into student values(@sno,@sname,@sex,@sage,@sdept) </code></p>
<p><code>exec inser @sno=&#39;10029&#39;, @sname=&#39;tom&#39;, @sex=&#39;男&#39;, @sage=100, @sdept=&#39;sc&#39; select * from student</code></p>
<p><code>--查询操作</code></p>
<p><code>--查询</code></p>
<p><code>select * from student select * from course select * from sc</code></p>
<p><code>--去掉重复行 select distinct sno from sc</code></p>
<p><code>--格式化查询</code></p>
<p><code>select sname as &#39;姓名&#39;,2013-sage as &#39;出生日期&#39; from student</code></p>
<p><code>select sname,&#39;出生日期&#39;,2013-sage from student </code></p>
<p><code>select 姓名=sname,出生日期=2013-sage from student</code></p>
<p><code>--条件查询</code></p>
<p><code>select * from course where ccredit&gt;3</code></p>
<p><code>select * from course where ccredit between 2 and 5 </code></p>
<p><code>select * from course where ccredit&gt; 2 and ccredit&lt;5 </code></p>
<p><code>select * from course where ccredit in(2) </code></p>
<p><code>select * from course where ccredit not in(2)</code></p>
<p><code>--匹配查询</code></p>
<p><code>select * from student where sname like &#39;刘__&#39;</code></p>
<p><code>select * from student where sname like &#39;_表__&#39;</code></p>
<p><code>select * from student where sname like &#39;%表%&#39;</code></p>
<p><code>--算术元算查询</code></p>
<p><code>select grade*(1+0.2) as 总成绩,grade/(10) as 绩点 from sc</code></p>
<p><code>--分组函数查询</code></p>
<p><code>select COUNT(*) as 总人数 from student</code></p>
<p><code>select COUNT(distinct sno) as &#39;选修的总人数&#39; from sc select AVG(grade) as &#39;平均成绩&#39; from sc where sno=&#39;10021&#39; </code></p>
<p><code>select MAX(grade) as &#39;MAX成绩&#39; from sc where sno=&#39;10021&#39; </code></p>
<p><code>select MIN(grade) as &#39;MIN成绩&#39; from sc where sno=&#39;10021&#39; </code></p>
<p><code>select SUM(grade) as &#39;总成绩&#39; from sc where sno=&#39;10021&#39; </code></p>
<p><code>select SUM(grade)/COUNT(grade) as &#39;平均成绩&#39; from sc where sno=&#39;10021&#39; </code></p>
<p><code>select SUM(grade) as &#39;总成绩&#39; from sc group by sno having sum(grade)&gt;100</code></p>
<p><code>--连接查询、 --等值连接</code></p>
<p><code>select distinct student.*,sc.* from student,sc where student.sno=sc.sno</code></p>
<p><code>--自身连接</code></p>
<p><code>select distinct A.*,B.* from student A,sc B where A.sno=B.sno select B.sname as &#39;同一个系&#39; from student A,student B where A.sname=&#39;白居易&#39; and A.sdept=B.sdept</code></p>
<p><code>--外连接</code></p>
<p><code>select A.*,B.* from student A left join sc B on A.sno=B.sno select A.*,B.* from student A right join sc B on A.sno=B.sno</code></p>
<p><code>select A.*,B.* from student A FULL join sc B on A.sno=B.sno</code></p>
<p><code>-复合条件连接</code></p>
<p><code>select distinct A.*,B.* from student A,sc B where A.sno=B.sno and B.grade&gt;99 and B.cno=&#39;002&#39; </code></p>
<p><code>select distinct A.*,B.*,C.* from student A,sc B,course C where A.sno=B.sno and B.cno=C.cno and B.grade&gt;99 and B.cno=&#39;002&#39;</code></p>
<p><code>--字符串连接查询</code></p>
<p><code>select sname+sno from student</code></p>
<p><code>select distinct sname from student ,sc where student.sno=sc.sno</code></p>
<p><code>select sname from student ,sc where student.sno=sc.sno and student.sno not in (select sno from sc where grade&lt;60) group by sname</code></p>
<p><code>--子查询</code></p>
<p><code>select * from student where sage&gt;(select AVG(sage) from student)</code></p>
<p><code>--是否存在的查询</code></p>
<p><code>select * from student where exists(select * from sc where sno=student.sno)</code></p>
<p><code>select * from student where not exists(select * from sc where sno=student.sno)</code></p>
<p><code>--sql创建用户</code></p>
<p><code>sys.sp_addlogin bnc,bnc,Studets sp_adduser bnc,bnc</code></p>
<p><code>--权限分配和收回</code></p>
<p><code>grant select on student to bnc</code></p>
<p><code>select * from student</code></p>
<p><code>revoke select on student from bnc</code></p>
<p><code>--视图的创建</code></p>
<p><code>create view VIEW_STUGrade(学号,姓名,课程,成绩)</code></p>
<p><code>as </code></p>
<p><code>select student.sno,student.sname,course.cname,sc.grade from student,course,sc </code></p>
<p><code>where student.sno=sc.sno and course.cno=sc.cno and student.sdept=&#39;软件&#39;</code></p>
<p><code>--查看视图</code></p>
<p><code>select * from VIEW_STUGrade</code></p>
<p><code>--视图修改</code></p>
<p><code>alter view VIEW_STUGrade(学号,姓名,课程,成绩) as select student.sno,student.sname,course.cname,sc.grade from student,course,sc</code></p>
<p><code>where student.sno=sc.sno and course.cno=sc.cno and student.sdept=&#39;软件&#39; </code></p>
<p><code>with check option</code></p>
<p><code>--更新失败后不影响视图查看 --视图更新</code></p>
<p><code>update VIEW_STUGrade set 姓名=&#39;王超&#39; where 学号=&#39;10022&#39; select * from student where sno=&#39;10022&#39; </code></p>
<p><code>/* 1,可更新视图： a,单个基本表导出的 2，不可更新视图 a 两个以上基本表导出的 b 视图字段来自表达式或者函数 c 嵌套查询的表 d 分组子句使用distinct */</code></p>
<p><code>--删除视图 drop view VIEW_STUGrade</code></p>
<p><code>--触发器</code></p>
<p><code>use Studets </code></p>
<p><code>GO create trigger insert_Tri </code></p>
<p><code>ON student after</code></p>
<p><code>insert as print &#39;有新数据插入！&#39;</code></p>
<p><code></code></p>
<p><code>GO create trigger update_Tri </code></p>
<p><code>on student after </code></p>
<p><code>update as print &#39;有数据更新！&#39;</code></p>
<p><code></code></p>
<p><code>GO create trigger delete_Tri </code></p>
<p><code>on student after </code></p>
<p><code>delete as print &#39;有数据删除！&#39;</code></p>
<p><code></code></p>
<p><code>--修改触发器</code></p>
<p><code>GO alter trigger delete_Tri </code></p>
<p><code>on student after delete </code></p>
<p><code>as</code></p>
<p><code>if &#39;王帅&#39; in (select sname from deleted) </code></p>
<p><code>print &#39;该信息不许删除！&#39;</code></p>
<p><code>rollback transaction</code></p>
<p><code>--执行存储过程查看触发器使用情况</code></p>
<p><code>exec sel @sno=&#39;10021&#39;</code></p>
<p><code>exec inser @sno=&#39;10029&#39;, @sname=&#39;王帅&#39;, @sex=&#39;男&#39;, @sage=25, @sdept=&#39;国贸&#39;</code></p>
<p><code>exec updat @sno=&#39;10029&#39;, @sex=&#39;女&#39;</code></p>
<p><code>exec dele @sno=&#39;10029&#39;</code></p>
<p><code>--查看,修改,删除触发器</code></p>
<p><code>/* sp_*+触发器名称</code></p>
<p><code> sp_helptext：触发器正文信息 sp_help:查看一般信息，触发器名称，属性，创建时间，类型 sp_depends：引用或指定表的所有触发器 sp_helptrigger：指定信息 */ sp_help delete_Tri </code></p>
<p><code>sp_helptext delete_Tri</code></p>
<p><code>sp_depends delete_Tri </code></p>
<p><code>sp_helptrigger student </code></p>
<p><code>--删除触发器 </code></p>
<p><code>drop trigger delete_Tri </code></p>
<p></p>

<p>注：关于SQL Server 数据库基本操作语句总结的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>
			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/mysql/biji/3300.html'>SQL Server 数据库移动数据库路径的脚本</a><a>下一篇</a><a href='/mysql/biji/3302.html'>Sql学习第三天——SQL 关于CTE(公用表达式)的递归查询使用</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>