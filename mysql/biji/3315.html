<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>SQL Server2012在开发中的一些新特性_mysql教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了SQL Server2012在开发中的一些新特性，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
一、增加了Sequence对" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
	    <a href="/mysql/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>数据库笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">SQL Server2012在开发中的一些新特性</h1>
					</div>
                    <div class="panel-title">
                        2022-11-12 09:45:20                    </div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了SQL Server2012在开发中的一些新特性，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
一、增加了Sequence对</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了SQL Server2012在开发中的一些新特性，具有一定的参考价值，可以用来参考一下。</p>

<p>对此感兴趣的朋友，看看idc笔记做的技术笔记！</p>
<p><strong>一、增加了Sequence对象。</strong>这个对于Oracle用户来说是最熟悉不过的数据库对象了，现在在SQL Server中终于也看到了类似的对象，只是在使用的语法上有一点点不一样。创建语法也是CREATE SEQUENCE，使用的时候需要使用NEXT VALUE FOR来取下一个值：</p>
<p></p>
<p>代码如下:</p>
<pre>

<code>CREATE SEQUENCE [dbo].[SQ_1] 
AS [bigint]
START WITH 1
INCREMENT BY 1;</code></pre>
<p></p>
<p><code>SELECT NEXT VALUE FOR [SQ_1] AS FirstUse;</code></p>
<p></p>
<p>如果要插入一个值，那么就是：</p>
<p></p>
<p>代码如下:</p>
<pre>

<code>INSERT INTO t1(c1,c2)
VALUES (NEXT VALUE FOR SQ_1, &#39;Test&#39;) ;
</code></pre>
<p></p>
<p><strong>但是好像没有提供获得当前值的语法，难道必须取下一个值？</strong></p>
<p><strong>二、新的分页查询语法。</strong>以前在SQL Server中分页，最早是用top或者临时表，后来出现了ROW_NUMBER函数实现分页，现在最新的SQL2012可以在order by子句后跟offset和fetch来分页，感觉有点像是LINQ的语法。比如查询1W行之后的20条有效项目信息，那么ROW_NUMBER分页查询的SQL是：</p>
<p></p>
<p>代码如下:</p>
<pre>

<code>select *
from
(
select *,ROW_NUMBER() over(order by p.PROJECT_ID) R
from PROJECT p
where p.IS_DELETED=0 
) x
where x.R between 10001 and 10020而是有了新的语法，那么查询语句就是：</code></pre>
<p></p>
<p><code>SELECT *FROM PROJECT pwhere p.IS_DELETED=0ORDER BY p.PROJECT_IDOFFSET 10001 ROWSFETCH NEXT 20 ROWS ONLY;</code></p>
<p></p>
<p>显然使用了新的语法后代码看起来更简洁，意思表达也更明确。从执行效率上来讲，试了一下，是一样的。</p>
<p><strong>三、一些新的系统函数。</strong>3.1相当于C#中三目运算符的IIF函数</p>
<p>这个函数和VBA中的IIF函数相同，判断第一个参数的表达式是否为真，真则返回第二个参数，假则返回第三个参数。</p>
<p>有了这个函数很多时候我们可以不用再使用复杂的case when语法了。比如我们判断项目的大小以显示对应的字符串，那么老的写法是：</p>
<p></p>
<p>代码如下:</p>
<pre>

<code>select p.CODE,case when p.SIZE&gt;100 then &#39;Big&#39; else &#39;Small&#39; end as SIZE_STRING
from PROJECT p
where SIZE is not null
</code></pre>
<p></p>
<p>现在，我们可以简单的写成：</p>
<p></p>
<p>代码如下:</p>
<pre>

<code>select p.CODE,IIF(p.SIZE&gt;100,&#39;Big&#39;,&#39;Small&#39;) as SIZE_STRING
from PROJECT p
where SIZE is not null
</code></pre>
<p></p>
<p><strong>3.2不用判断类型和NULL的字符串连接CONCAT函数</strong></p>
<p>SQL Server本来对字符串的连接很简单，直接使用&ldquo;+&rdquo;号，但是需要注意两个问题，一是必须类型都是字符串类型，如果是数字类型那么会报语法错误，所以必须把数字类型转换为字符串。二是如果其中的某个值为null，那么整个连接的结果就是一个null字符串，所以还需要判断null，所以本来只是一个连接字符串的查询就会写的很复杂：</p>
<p></p>
<p>代码如下:</p>
<pre>

<code>select p.PROJECT_ID, p.CODE+&#39;,&#39;+p.NAME+&#39;,&#39;+ISNULL(p.NICK_NAME,&#39;&#39;)+&#39;,&#39;+ISNULL(CONVERT(varchar(50),p.SIZE),&#39;&#39;)
from PROJECT p
</code></pre>
<p></p>
<p>现在使用CONCAT函数，直接忽略其中的类型，忽略对NULL的检查，直接连接成一个非空的字符串：</p>
<p>代码如下:</p>
<pre>

<code>select p.PROJECT_ID,CONCAT( p.CODE,&#39;,&#39;,p.NAME,&#39;,&#39;,p.NICK_NAME,&#39;,&#39;,p.SIZE)
from PROJECT p
</code></pre>
<p></p>
<p>可以明显感觉到简洁了很多。</p>
<p><strong>3.3转换成字符串时设置格式的FORMAT函数。</strong></p>
<p>以前要把数字或者日期转换成字符串，可以使用CONVERT函数并带人第三个整数类型的参数指定转换的格式，不过这种方法太麻烦，整数参数不容易理解和记忆，而且也不灵活。现在的FORMAT函数相当于C#中的String.Format函数，在第二个参数中可以想要输出的格式。</p>
<p></p>
<p>代码如下:</p>
<pre>

<code>select p.PROJECT_ID,FORMAT(p.CREATED_TIME,&#39;yyyy-MM-dd&#39;),CONVERT(varchar(50),p.CREATED_TIME,112)
from PROJECT p
</code></pre>
<p></p>
<p><strong>3.4让枚举显示更方便的CHOOSE函数。</strong></p>
<p>在程序中经常使用枚举值，在数据库中使用tinyint来保存枚举值，但是在查看时却不是很容易理解枚举值的含义，必须查看代码看1对应什么，2对应什么才知道。在显示的时候如果要显示成字符串，那么就需要使用case when进行判断。现在可以使用CHOOSE函数，让枚举转换成字符串变得很简单。比如要显示项目的状态，那么我们的查询就是：</p>
<p></p>
<p>代码如下:</p>
<pre>

<code>select p.CODE,CHOOSE( p.STATUS,&#39;Plan&#39;,&#39;Exec&#39;,&#39;Complete&#39;,&#39;Abort&#39;,&#39;Fail&#39;)
from PROJECT p
</code></pre>
<p></p>
<p>CHOSSE函数比case when有几个缺点，1是不支持0和负数，所以如果枚举的值是0那么就没办法显示，2是枚举值必须连续而且比较小，不能使用100、200等值，那要是用CHOOSE那得写死人了。没有default值，使用case when的时候，如果不匹配还有个else值可以显示，而使用CHOOSE后如果没有匹配的，那么就是NULL值。所以个人觉得这个函数的使用面非常</p>
<p><strong>3.5各种日期时间函数。</strong></p>
<p>除了一个EOMONTH函数是返回给定日期的最后一天外，其他的新函数，都是把年月日作为参数传进去，返回指定数据类型的对象，相当于就是CONVERT函数的变形。总体使用不多，在此不多介绍。</p>
<p><strong>四、OVER子句的增强和新增一些分析函数。</strong>之前OVER子句是用于RANK，ROW_NUMBER等排名函数，现在OVER子句得到了大大的增强， 可以将OVER子句应用到聚合函数中，也增加了一些分析函数。</p>
<p>比如我有一个项目和客户表，一个客户对于多个项目，现在需要知道客户的信息和每个客户的最新项目Code，这个要是以前还不好实现，现在我们有了分析函数，可以使用FIRST_VALUE或者LAST_VALUE再配合OVER子句，得到我们想要的结果：</p>
<p></p>
<p>代码如下:</p>
<pre>

<code>select distinct c.*,FIRST_VALUE(p.CODE) over(PARTITION BY c.CLIENT_ID order by p.[CREATED_TIME] desc) as LAST_PROJECT_CODE
from PROJECT p
inner join CLIENT c
on p.CLIENT_ID=c.CLIENT_ID
</code></pre>
<p></p>

<p>注：关于SQL Server2012在开发中的一些新特性的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>
			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/mysql/biji/3314.html'>SQL Server 游标语句 声明/打开/循环实例</a><a>下一篇</a><a href='/mysql/biji/3316.html'>SQLServer:探讨EXEC与sp_executesql的区别分析</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>