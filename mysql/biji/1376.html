<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>MySQL数据库安全配置介绍第1/2页_mysql教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了MySQL数据库安全配置介绍第1/2页，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
1、前言：
MySQL数据库是完" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
	    <a href="/mysql/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>数据库笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">MySQL数据库安全配置介绍第1/2页</h1>
					</div>
                    <div class="panel-title">
                        2022-11-12 09:25:08                    </div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了MySQL数据库安全配置介绍第1/2页，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
1、前言：
MySQL数据库是完</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了MySQL数据库安全配置介绍第1/2页，具有一定的参考价值，可以用来参考一下。</p>

<p>对此感兴趣的朋友，看看idc笔记做的技术笔记！</p>
<p><strong>1、前言</strong>：</p>
<p>MySQL数据库是完全网络化的跨平台关系型数据库系统，同时是具有客户机/服务器体系结构的分布式数据库管理系统。它具有功能强、使用简便、管理方便、运行速度快、安全可靠性强等优点，用户可利用许多语言编写访问MySQL数据库的程序，特别是与PHP更是黄金组合，运用十分广泛。MySQL数据库的安全配置也是很有必要的，现在的MySQL数据库中信息的安全性常常受到威胁，故安全配置必不可少。</p>
<p>由于MySQL是多平台的数据库，它的默认配置要考虑各种情况下都能适用，所以在我们自己的使用环境下应该进行进一步的安全加固。作为一个MySQL的系统管理员，我们有责任维护MySQL数据库系统的数据安全性和完整性。</p>
<p>MySQL数据库的安全配置必须从两个方面入手，系统内部安全和外部网络安全，另外我们还将简单介绍编程时要注意的一些问题以及一些小窍门。</p>
<p>　<strong>　2、系统内部安全</strong></p>
<p>首先简单介绍一下MySQL数据库目录结构。MySQL安装好，运行了mysql_db_install脚本以后就会建立数据目录和初始化数据库。如果我们用MySQL源码包安装，而且安装目录是/usr/local/mysql，那么数据目录一般会是/usr/local/mysql/var。数据库系统由一系列数据库组成，每个数据库包含一系列数据库表。MySQL是用数据库名在数据目录建立建立一个数据库目录，各数据库表分别以数据库表名作为文件名，扩展名分别为MYD、MYI、frm的三个文件放到数据库目录中。</p>
<p>MySQL的授权表给数据库的访问提供了灵活的权限控制，但是如果本地用户拥有对库文件的读权限的话，攻击者只需把数据库目录打包拷走，然后拷到自己本机的数据目录下就能访问窃取的数据库。所以MySQL所在的主机的安全性是最首要的问题，如果主机不安全，被攻击者控制，那么MySQL的安全性也无从谈起。其次就是数据目录和数据文件的安全性，也就是权限设置问题。</p>
<p>从MySQL主站一些老的binary发行版来看，3.21.xx版本中数据目录的属性是775，这样非常危险，任何本地用户都可以读数据目录，所以数据库文件很不安全。3.22.xx版本中数据目录的属性是770，这种属性也有些危险，本地的同组用户既能读也能写，所以数据文件也不安全。3.23.xx版本数据目录的属性是700，这样就比较好，只有启动数据库的用户可以读写数据库文件，保证了本地数据文件的安全。</p>
<p>如果启动MySQL数据库的用户是mysql，那么象如下的目录和文件的是安全的，请注意数据目录及下面的属性：</p>
<p>shell&gt;ls -l /usr/local/mysql</p>
<p>total 40</p>
<p>drwxrwxr-x 2 root root 4096 Feb 27 20:07 bin</p>
<p>drwxrwxr-x 3 root root 4096 Feb 27 20:07 include</p>
<p>drwxrwxr-x 2 root root 4096 Feb 27 20:07 info</p>
<p>drwxrwxr-x 3 root root 4096 Feb 27 20:07 lib</p>
<p>drwxrwxr-x 2 root root 4096 Feb 27 20:07 libexec</p>
<p>drwxrwxr-x 3 root root 4096 Feb 27 20:07 man</p>
<p>drwxrwxr-x 6 root root 4096 Feb 27 20:07 mysql-test</p>
<p>drwxrwxr-x 3 root root 4096 Feb 27 20:07 share</p>
<p>drwxrwxr-x 7 root root 4096 Feb 27 20:07 sql-bench</p>
<p>drwx------ 4 mysql mysql 4096 Feb 27 20:07 var</p>
<p>shell&gt;ls -l /usr/local/mysql/var</p>
<p>total 8</p>
<p>drwx------ 2 mysql mysql 4096 Feb 27 20:08 mysql</p>
<p>drwx------ 2 mysql mysql 4096 Feb 27 20:08 test</p>
<p>shell&gt;ls -l /usr/local/mysql/var/mysql</p>
<p>total 104</p>
<p>-rw------- 1 mysql mysql 0 Feb 27 20:08 columns_priv.MYD</p>
<p>-rw------- 1 mysql mysql 1024 Feb 27 20:08 columns_priv.MYI</p>
<p>-rw------- 1 mysql mysql 8778 Feb 27 20:08 columns_priv.frm</p>
<p>-rw------- 1 mysql mysql 302 Feb 27 20:08 db.MYD</p>
<p>-rw------- 1 mysql mysql 3072 Feb 27 20:08 db.MYI</p>
<p>-rw------- 1 mysql mysql 8982 Feb 27 20:08 db.frm</p>
<p>-rw------- 1 mysql mysql 0 Feb 27 20:08 func.MYD</p>
<p>-rw------- 1 mysql mysql 1024 Feb 27 20:08 func.MYI</p>
<p>-rw------- 1 mysql mysql 8641 Feb 27 20:08 func.frm</p>
<p>-rw------- 1 mysql mysql 0 Feb 27 20:08 host.MYD</p>
<p>-rw------- 1 mysql mysql 1024 Feb 27 20:08 host.MYI</p>
<p>-rw------- 1 mysql mysql 8958 Feb 27 20:08 host.frm</p>
<p>-rw------- 1 mysql mysql 0 Feb 27 20:08 tables_priv.MYD</p>
<p>-rw------- 1 mysql mysql 1024 Feb 27 20:08 tables_priv.MYI</p>
<p>-rw------- 1 mysql mysql 8877 Feb 27 20:08 tables_priv.frm</p>
<p>-rw------- 1 mysql mysql 428 Feb 27 20:08 user.MYD</p>
<p>-rw------- 1 mysql mysql 2048 Feb 27 20:08 user.MYI</p>
<p>-rw------- 1 mysql mysql 9148 Feb 27 20:08 user.frm</p>
<p>如果这些文件的属主及属性不是这样，请用以下两个命令修正之：</p>
<p>shell&gt;chown -R mysql.mysql /usr/local/mysql/var</p>
<p>shell&gt;chmod -R go-rwx /usr/local/mysql/var</p>
<p>用root用户启动远程服务一直是安全大忌，因为如果服务程序出现问题，远程攻击者极有可能获得主机的完全控制权。MySQL从3.23.15版本开始时作了小小的改动，默认安装后服务要用mysql用户来启动，不允许root用户启动。如果非要用root用户来启动，必须加上--user=root的参数(./safe_mysqld --user=root &amp;)。因为MySQL中有LOAD DATA INFILE和SELECT ... INTO OUTFILE的SQL语句，如果是root用户启动了MySQL服务器，那么，数据库用户就拥有了root用户的写权限。不过MySQL还是做了一些限制的，比如LOAD DATA INFILE只能读全局可读的文件，SELECT ... INTO OUTFILE不能覆盖已经存在的文件。</p>
<p>本地的日志文件也不能忽视，包括shell的日志和MySQL自己的日志。有些用户在本地登陆或备份数据库的时候为了图方便，有时会在命令行参数里直接带了数据库的密码，如：</p>
<p>shell&gt;/usr/local/mysql/bin/mysqldump -uroot -ptest test&gt;test.sql</p>
<p>shell&gt;/usr/local/mysql/bin/mysql -uroot -ptest</p>
<p>这些命令会被shell记录在历史文件里，比如bash会写入用户目录的.bash_history文件，如果这些文件不慎被读，那么数据库的密码就会泄漏。用户登陆数据库后执行的SQL命令也会被MySQL记录在用户目录的.mysql_history文件里。如果数据库用户用SQL语句修改了数据库密码，也会因.mysql_history文件而泄漏。所以我们在shell登陆及备份的时候不要在-p后直接加密码，而是在提示后再输入数据库密码。</p>
<p>另外这两个文件我们也应该不让它记录我们的操作，以防万一。</p>
<p>shell&gt;rm .bash_history .mysql_history</p>
<p>shell&gt;ln -s /dev/null .bash_history</p>
<p>shell&gt;ln -s /dev/null .mysql_history</p>
<p>上门这两条命令把这两个文件链接到/dev/null，那么我们的操作就不会被记录到这两个文件里了。</p>
<div class="pagenum tc"><strong>12下一页阅读全文 </strong>
<p><strong>对此感兴趣的朋友，看看idc笔记做的技术笔记！</strong></p><strong> </strong>
<p></p><strong> </strong>
<p><strong><strong>3、外部网络安全</strong></strong></p><strong> </strong>
<p><strong>MySQL数据库安装好以后，Unix平台的user表是这样的：</strong></p><strong> </strong>
<p><strong>mysql&gt; use mysql;</strong></p><strong> </strong>
<p><strong>Database changed</strong></p><strong> </strong>
<p><strong>mysql&gt; select Host,User,Password,Select_priv,Grant_priv from user;</strong></p><strong> </strong>
<p><strong>4 rows in set (0.00 sec)</strong></p><strong> </strong>
<p><strong>Windows平台的user表是这样的：</strong></p><strong> </strong>
<p><strong>mysql&gt; use mysql;</strong></p><strong> </strong>
<p><strong>Database changed</strong></p><strong> </strong>
<p><strong>mysql&gt; select Host,User,Password,Select_priv,Grant_priv from user;</strong></p><strong> </strong>
<p><strong>4 rows in set (0.00 sec)</strong></p><strong> </strong>
<p><strong>我们先来看Unix平台的user表。其中redhat只是我试验机的机器名，所以实际上Unix平台的MySQL默认只允许本机才能连接数据库。但是缺省root用户口令是空，所以当务之急是给root用户加上口令。给数据库用户加口令有三种方法：</strong></p><strong> </strong>
<p><strong>1)在shell提示符下用mysqladmin命令来改root用户口令:</strong></p><strong> </strong>
<p><strong>shell&gt;mysqladmin -uroot password test</strong></p><strong> </strong>
<p><strong>这样，MySQL数据库root用户的口令就被改成test了。(test只是举例，我们实际使用的口令一定不能使用这种易猜的弱口令)</strong></p><strong> </strong>
<p><strong>2)用set password修改口令：</strong></p><strong> </strong>
<p><strong>mysql&gt; set password for root@localhost=password(&#39;test&#39;);</strong></p><strong> </strong>
<p><strong>这时root用户的口令就被改成test了。</strong></p><strong> </strong>
<p><strong>3)直接修改user表的root用户口令：</strong></p><strong> </strong>
<p><strong>mysql&gt; use mysql;</strong></p><strong> </strong>
<p><strong>mysql&gt; update user set password=password(&#39;test&#39;) where user=&#39;root&#39;;</strong></p><strong> </strong>
<p><strong>mysql&gt; flush privileges;</strong></p><strong> </strong>
<p><strong>这样，MySQL数据库root用户的口令也被改成test了。其中最后一句命令flush privileges的意思是强制刷新内存授权表，否则用的还是缓冲中的口令，这时非法用户还可以用root用户及空口令登陆，直到重启MySQL服务器。</strong></p><strong> </strong>
<p><strong>我们还看到user为空的匿名用户，虽然它在Unix平台下没什么权限，但为了安全起见我们应该删除它：</strong></p><strong> </strong>
<p><strong>mysql&gt; delete from user where user=&#39;&#39;;</strong></p><strong> </strong>
<p><strong>Windows版本MySQL的user表有很大不同，我们看到Host字段除了localhost还有是%。这里%的意思是允许任意的主机连接MySQL服务器，这是非常不安全的，给攻击者造成可乘之机，我们必须删除Host字段为%的记录：</strong></p><strong> </strong>
<p><strong><strong>4、一些小窍门</strong></strong></p><strong> </strong>
<p><strong>1)如果不慎忘记了MySQL的root密码，我们可以在启动MySQL服务器时加上参数--skip-grant-tables来跳过授权表的验证 (./safe_mysqld --skip-grant-tables &amp;)，这样我们就可以直接登陆MySQL服务器，然后再修改root用户的口令，重启MySQL就可以用新口令登陆了。</strong></p><strong> </strong>
<p><strong>2)启动MySQL服务器时加--skip-show-database使一般数据库用户不能浏览其它数据库。</strong></p><strong> </strong>
<p><strong>3)启动MySQL服务器时加上--chroot=path参数，让mysqld守护进程运行在chroot环境中。这样SQL语句LOAD DATA INFILE和SELECT ... INTO OUTFILE就限定在chroot_path下读写文件了。这里有一点要注意，MySQL启动后会建立一个mysql.sock文件，默认是在/tmp目录下。使用了chroot后，MySQL会在chroot_path/tmp去建立mysql.sock文件，如果没有chroot_path/tmp目录或启动MySQL的用户没有这个目录写权限就不能建立mysql.sock文件，MySQL会启动失败。比如我们加了--chroot=/usr/local/mysql/启动参数，那么最好建立一个启动MySQL的用户能写的/usr/local/mysql/tmp目录，当然我们也可以用--socket=path来指定mysql.sock文件的路径，但这个path一定要在chroot_path里面。</strong></p><strong> </strong>
<p><strong>4)启动MySQL服务器时加上--log-slow-queries=file参数，这样mysqld会把SQL命令执行时间超过long_query_time的写入file文件。如果没有指定=file，mysqld默认会写到数据目录下的hostname-slow.log。如果只指定了filename，没有指定路径，那么mysqld也会把filename写到数据目录下。我们通过这个日志文件可以找出执行时间超长的查询语句，然后尽可能的优化它减轻MySQL服务器的负担。</strong></p><strong> </strong>
<p><strong>5)如果我们只需本机使用MySQL服务，那么我们还可以加上--skip-networking启动参数使MySQL不监听任何TCP/IP连接，增加安全性。(非常推荐)</strong></p><strong> </strong>
<p><strong>6)MySQL的更多mysqld启动选项请见MySQL手册4.16.4 mysqld Command-line Options</strong></p><strong> </strong>
<p><strong>References</strong></p><strong> </strong>
<p><strong>MySQL Manual(http://www.mysql.com/documentation/index.html)</strong></p><strong> </strong>
<p><strong>晏子的MySQL管理员指南(http://clyan.hongnet.com/index.html)</strong></p><strong> </strong>
<p><strong>Access Granted(http://www.devshed.com/Server_Side/MySQL/Access)</strong></p><strong> </strong>
<div class="pagenum tc"><strong>上一页1<strong>2阅读全文 </strong></strong></div></div>

<p>注：关于MySQL数据库安全配置介绍第1/2页的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>
			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/mysql/biji/1375.html'>ERROR 1222 (21000): The used SELECT statements have a different number of columns</a><a>下一篇</a><a href='/mysql/biji/1377.html'>MySQL大表中重复字段的高效率查询方法</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>