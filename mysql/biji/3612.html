<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>SQL Server 基本语法及实例操作语句_mysql教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了SQL Server 基本语法及实例操作语句，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！MS SQL基本语法及实例操" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
	    <a href="/mysql/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>数据库笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">SQL Server 基本语法及实例操作语句</h1>
					</div>
                    <div class="panel-title">
                        2022-11-12 09:48:06                    </div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了SQL Server 基本语法及实例操作语句，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！MS SQL基本语法及实例操</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了SQL Server 基本语法及实例操作语句，具有一定的参考价值，可以用来参考一下。</p>

<p>对此感兴趣的朋友，看看idc笔记做的技术笔记！</p>MS SQL基本语法及实例操作一：建表并初始化============================create database mf2011 --创建数据库use mf2011 --使用数据库create table dept --创建&ldquo;部门&rdquo;表( www.512pic.comdeptno int primary key, --部门编号（主键）dname nvarchar(30), --部门名称loc nvarchar(30) --部门所在的地点)-----create table emp --创建&ldquo;员工&rdquo;表(empno int primary key, --员工编号（主键）ename nvarchar(30), --员工的姓名job nvarchar(30), --员工的工作类型mgr int, --员工的上级hiredate datetime, --员工的入职时间（受聘时间）sal numeric(10,2), --员工的每月工资comm numeric(10,2), --员工的年终奖金deptno int foreign key references dept(deptno) --创建一个外键指向部门表（描述该员工属于哪个部门）)--------insert into dept values (10,&#39;accounting&#39;,&#39;new york&#39;)insert into dept values (20,&#39;reasarch&#39;,&#39;dallas&#39;)insert into dept values (30,&#39;sales&#39;,&#39;chicago&#39;)insert into dept values (40,&#39;operations&#39;,&#39;boston&#39;)-------insert into emp (empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7369,&#39;michael&#39;,&#39;clerk&#39;,7902,&#39;2010-1-12&#39;,675.23,300,20)insert into emp (empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7499,&#39;allen&#39;,&#39;salesman&#39;,7698,&#39;2009-1-23&#39;,1675.23,322.50,30)insert into emp (empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7521,&#39;ward&#39;,&#39;salesman&#39;,7698,&#39;2008-1-3&#39;,12675.99,399.50,30)insert into emp (empno,ename,job,mgr,hiredate,comm,deptno) values(7566,&#39;jones&#39;,&#39;manager&#39;,7839,&#39;2000-1-1&#39;,8675.99,20)insert into emp (empno,ename,job,mgr,hiredate,sal,comm,deptno) values(7654,&#39;martin&#39;,&#39;salesman&#39;,7698,&#39;2007-12-31&#39;,1275.99,999.00,30)insert into emp (empno,ename,job,mgr,hiredate,sal,deptno) values(7782,&#39;blake&#39;,&#39;manager&#39;,7839,&#39;2007-12-20&#39;,1275.99,30)insert into emp (empno,ename,job,mgr,hiredate,sal,deptno) values(7788,&#39;sccot&#39;,&#39;analyst&#39;,7566,&#39;2003-1-22&#39;,1275.99,10)insert into emp (empno,ename,job,mgr,hiredate,sal,deptno) values(7781,&#39;miller&#39;,&#39;opreator&#39;,7566,&#39;2005-10-12&#39;,1275.99,40)www.512pic.cominsert into emp (empno,ename,job,mgr,hiredate,sal,deptno) values(7744,&#39;adamc&#39;,&#39;opreator&#39;,7566,&#39;2006-10-30&#39;,1244.0,40)insert into emp (empno,ename,job,hiredate,sal,deptno) values(7839,&#39;king&#39;,&#39;president&#39;,&#39;2000-1-1&#39;,100244.0,10)insert into emp (empno,ename,job,mgr,hiredate,sal,deptno) values(1999,&#39;lxliog&#39;,&#39;opreator&#39;,7566,&#39;2006-10-30&#39;,1244.0,40)-----select * from deptselect * from emp--主键：唯一，非空--外键：只能指向主键，与指向的主键数据类型必须一致二：练习============================1，查询emp表所有列select * from emp --刘君正2，查询指定列（例如：姓名，工资两列）select ename,sal from emp --郑朝阳3，取消重复行（从emp表中查询部门号）select distinct(deptno) from emp --徐绍峰,郝艳芳,刘辉,马东勤4，从emp表中查询名字为lxliog员工的薪水，工作，所作部门select sal,job,deptno from emp where &#39;lxliog&#39;=ename --侯耀文,谭雪玲,黎小龙5，统计总共有都少个部门(两种方式：从emp或从dept)select count(deptno) from dept --诺布才仁select count(distinct(deptno)) as 部门总数 from emp --诺布才仁use mf2011select * from dept;select * from emp;--6，显示每个雇员的年工资select isnull(sal,0)*12+isnull(comm,0) as 年薪 from emp --扎西多杰7，如何显示工资高于3000的员工信息select * from emp where sal&gt;3000 --邓文文www.512pic.com8，如何查找1982.1.1后入职的员工select * from emp where hiredate&gt;&#39;1982-1-1&#39;9，如何显示工资在2000到2500之间的员工情况select * from emp where sal between 1244 and 100244select * from emp where sal&gt;=2000 and sal&lt;=25000010，如何显示首字母为S的员工姓名和工资(模糊查询)select ename ,sal from emp where ename like &#39;s%&#39;11，如何显示第三个字母为&lsquo;O&#39;的所有员工的姓名和工资（模糊查询）select ename 姓名,sal as 月薪 from emp where ename like &#39;__R%&#39;;12，如何显示empno为123,345,800...的员工情况(在where条件中使用in)select * from emp where empno in(123,345,800,1999,7400,7744);13，如何显示没有上级的雇员的情况（使用is null 的操作符）select * from emp where mgr is null;14,查询工资高于1000或是岗位为manager的雇员，同时还要满足他们的姓名首字母为j（使用逻辑操作符）select * from emp where (sal&gt;1000 or job=&#39;manager&#39;)and ename like &#39;j%&#39;;16,如何按工资的从低到高的顺序显示雇员的信息（使用order by字句asc， desc）select * from emp order by sal desc;17,如何按入职的先后顺序显示雇员的信息（使用order by字句asc， desc）select * from emp order by hiredate desc;18，按部门号升序而雇员的工资降序排列显示雇员信息（使用order by字句asc，desc）select * from emp order by deptno asc,sal desc;19，统计每个人的年薪，并按从低到高的顺序排序(使用列的别名排序)select isnull(sal,0)*12+isnull(comm,0) 年薪 from emp order by 年薪;20,如何显示员工中最高工资和最低工资select max(sal) as &quot;max(sal)&quot;,min(sal) from emp;21，如何显示最低工资的员工信息select * from emp where sal = (select min(sal) from emp);www.512pic.com22，显示所有员工的平均工资和工资总和select avg(sal) as &quot;avg(sal)&quot; , sum(sal) as &quot;sum(sal)&quot; from emp;23，把高于平均工资的雇员的名字和他的工资显示出来select ename,sal from emp where sal&gt;(select avg(sal) from emp);24，计算共有多少名员工select count(ename) from emp;25，如何显示每个部门的平均工资和最高工资select avg(sal) as &quot;avg&quot;,max(sal) as &quot;max&quot;,deptnofrom emp group by deptno26，如何显示每个部门的高于总平均工资的平均工资和最高工资select avg(sal) as &quot;avg&quot;,max(sal) as &quot;max&quot;,deptnofrom emp where sal&gt;(select avg(sal) from emp) group by deptno27显示每个部门的每种岗位的平均工资和最低工资select avg(sal),min(sal),deptno,job from emp group by deptno,joborder by deptno28，显示平均工资低于2000的部门号和它的平均工资（having往往和group by结合使用，可以对分组查询结果进行筛选）select avg(sal),deptno from emp group by deptno having avg(sal)&lt;200029，使用企业管理器来操作数据库的分离与附加见操作步骤30，使用企业管理器来操作数据库的备份与恢复操作见操作步骤31，使用查询分析器器来操作数据库的备份与恢复操作（1）备份数据库backup database mf2011 to disk=&#39;f:/lxliog.bak&#39;;（2）删除数据库drop database mf2011;（3）恢复数据库restore database mf2011 from disk=&#39;f:/lxliog.bak&#39;;复杂查询（多表查询）32,显示sales部门的位置和其员工的姓名select d.loc,e.ename from emp e,dept d where d.dname=&#39;sales&#39; and d.deptno=e.deptno33,显示雇员名字，雇员工资及所在部门的名字(当字段有歧义的时候要用别名)select e.ename,e.sal,d.dname from emp e,dept d where e.deptno=d.deptnowww.512pic.com34，显示部门号为10的部门名称，及该部门的员工名字和工资select d.dname, e.ename, e.sal from emp e,dept d where d.deptno=10 and d.deptno=e.deptno35，显示雇员名字，雇员工资及所在部门的名字，并按部门名称排序select e.ename, e.sal, d.dname from emp e,dept d where e.deptno=d.deptno order by d.dname自连接：在同一张表的连接查询36,显示某个员工的上级领导的姓名（比如：smith）（1）select mgr from emp where ename=&#39;adamc&#39;（2）select ename from emp where empno=(select mgr from emp where ename=&#39;adamc&#39;)37,显示公司每个员工和他上级的名字select worker.ename, boss.ename from emp worker, emp boss where worker.mgr=boss.empno子查询：嵌入在其它sql语句中的select语句，也叫嵌套查询。单行子查询：只返回一行数据的子查询语句。38,显示与jones同一部门的所有员工(1)select deptno from emp where ename=&#39;jones&#39;(2)select * from emp where deptno=(select deptno from emp where ename=&#39;jones&#39;)多行子查询：返回多行数据的子查询。39,查询和部门号为10的工作相同的雇员的名字、岗位、工资、部门号。(注意要使用in，不能用=)(1)select distinct job from emp where deptno=20(2)select ename,job,sal,deptno from emp where job in (select distinct job from emp where deptno=20);40，在上面查询结果的基础上排除20部门的员工select ename,job,sal,deptno from emp where job in (select distinct job from emp where deptno=20) anddeptno not in (20);或select ename,job,sal,deptno from emp where job in (select distinct job from emp where deptno=20) and deptno &lt;&gt;20;在from字句中使用子查询41 ,显示各个部门高于本部门平均工资的员工的信息(1)先查出各个部门的平均工资 www.512pic.comselect avg(sal),deptno from emp group by deptno(2)把上面的表当成一个临时表来对待select e.ename,e.sal,tem.myavg,e.deptnofrom emp e,(select avg(sal) myavg,deptno from emp group by deptno) temwhere e.deptno=tem.deptno and e.sal&gt;tem.myavg注意：（1）当在from字句中使用子查询时，该子查询会被当做一个临时表来对待，（2）当在from字句中使用子查询时，必须给子查询指定一个别名分页查询：按雇员的hiredate属性升序取出第5条到第10条记录42，显示第5条到第10条记录（1）显示第1到第4条记录select top 4 empno from emp order by hiredate（2）显示后6条记录（第5条到第10条记录）select top 6 * from emp where empnonot in(select top 4 empno from emp order by hiredate)order by hiredate;43,显示第11个到第13个入职的人的信息（写法同上）44，显示第5到9的人的信息，按薪水的降序排列（写法类似）select top 5 * from emp where empno not in(select top 4 empno from emp order by sal desc)order by sal desc;45，同一张表中的数据复制（1）创建一张临时表：identity(1,1)表示该testId字段自增，从1开始每次+1create table test(testId int primary key identity(1,1),testName varchar(30),testPass varchar(30))（2）插入一条数据insert into test(testName, testPass) values(&#39;zhangsan&#39;,&#39;123456&#39;);（3）复制数据insert into test(testName, testPass) (select testName,testPass from test);46，查询testId为第10000-10009的数据，看看性能。select top 10 * from test where testId not in(select top 9999 testId from test order by testId)order by testId用查询结果创建一张新表（一种快捷的建表方法）47，语法：select *(这里可以选择字段) into 另一张表面 from 表select testName,testPass into mytest from test where testId&lt;8表mytest在上述语句中已经创建好了，并且初始化好了数据并且把testId设置为主键：ALTER TABLE test01 ADD primary key(testId)www.512pic.com48，删除一张表中的重复数据（1）create table cat(catId int,catName varchar(40))（2）insert into cat values(1,&#39;aa&#39;); //重复执行几次insert into cat values(2,&#39;bb&#39;); //重复执行几次（3）select distinct * into #temp from cat;//把cat的记录distinct后的结果，插入到临时表#temp中delete from cat;//把cat表的记录清空insert into cat select * from #temp;//把#temp表的数据（没有重复的数据）插入到cat表中drop table #temp;//删除表#temp3左外连接和右外连接左外连接：左边表的查询数据全部显示，右边的表中如果没有匹配的数据则用null填充右外连接：右边表的查询数据全部显示，左边的表中如果没有匹配的数据则用null填充49，显示emp表中所有雇员的及其上级的名字(看看区别)（1）左外连接：select e.ename 雇员名字,b.ename 上级名字from emp e left join emp b on e.mgr=b.empno;（2）右外连接：select e.ename 雇员名字,b.ename 上级名字from emp e right join emp b on e.mgr=b.empno;常见约束：(1)not null, 非空(2)unique, 唯一，允许出现一个null(3)primary key, 主键，唯一，非空(4)foreign key, 外键,定义主表和从表的关联关系(5)check，检查，强制数据必须满足定义的条件,例如：sal int check(sal&gt;=2000 and sal&lt;=3000)(6)default, 默认值，用于数据的完整性，例如：birthday datetime default getdate(),50，复合主键只能用表级定义例如：create table cat(catId int,catName varchar(40)，catAge int,primary key(catId, catName))www.512pic.com51，商品售货系统表设计案例：现有一个商店数据库，记录客户及其购物情况，由下面三个表组成：商品（goods），客户（customer），购买（purchase）商品goods(商品号goodsId, 商品名称goodsName, 单价unitPrice, 商品类别category, 供应商provider);客户customer(客户号customerId, 姓名name, 住址address, 电邮email, 性别sex, 身份证cardId);购买purchase(客户号customerId, 商品号 goodsId, 购买数量nums);（1）建表，在定义中要求申明：&uuml; 每个表的主键和外键；&uuml; 客户的姓名不能为空；&uuml; 单价必须大于0，购买数量必须在1到10之间&uuml; 电邮不能够重复&uuml; 客户的性别必须是：男或女，默认是男&uuml; 商品的类别是：食物，日用品----goods表Create table goods(goodsid nvarchar(50) primary key,goodsnamd nvarchar(80) not null,unitPrice numeric(10,2) check (unitPrice&gt;0)category nvarchar(3) check (category in (&lsquo;食物&#39;,&#39;日用品&#39;)),provider nvarchar(50))----customerCreate table customer(Customerid nvarchar(50) primary key,Cusname nvarchar(50) not null,Address nvarchar(100),Email nvarchar(50) unique,Sex nchar(1) check(sex in(&lsquo;男&#39;,&#39;女&#39;)) default &lsquo;男&#39;,Cardid nvarchar(18)) www.512pic.com----purchaseCreate table purchase(Customerid nvarchar(50) foreign key references customer(Customerid),goodsid nvarchar(50) foreign key references goods(goodsid),nums int check(nums&gt;0 and nums&lt;10),primary key(customerid, goodsid))作者 qq395740774

<p>注：关于SQL Server 基本语法及实例操作语句的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>
			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/mysql/biji/3611.html'>SQL Server sql不常用函数总结以及事务，增加，删除触发器</a><a>下一篇</a><a href='/mysql/biji/3613.html'>SQL Server 找出所有非xml索引并重新整理的sql</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>