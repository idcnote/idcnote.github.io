<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>15个初学者必看的基础SQL查询语句_mysql教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了15个初学者必看的基础SQL查询语句，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
本文将分享15个初学者必" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
	    <a href="/mysql/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>数据库笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">15个初学者必看的基础SQL查询语句</h1>
					</div>
                    <div class="panel-title">
                        2022-11-12 09:39:49                    </div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了15个初学者必看的基础SQL查询语句，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
本文将分享15个初学者必</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了15个初学者必看的基础SQL查询语句，具有一定的参考价值，可以用来参考一下。</p>

<p>对此感兴趣的朋友，看看idc笔记做的技术笔记！</p>
<p>本文将分享15个初学者必看的基础SQL查询语句，都很基础，但是你不一定都会，所以好好看看吧。</p>
<p></p>
<h3>1、创建表和数据插入SQL</h3>
<p></p>
<p>我们在开始创建数据表和向表中插入演示数据之前，我想给大家解释一下实时数据表的设计理念，这样也许能帮助大家能更好的理解SQL查询。</p>
<p>在数据库设计中，有一条非常重要的规则就是要正确建立主键和外键的关系。</p>
<p>现在我们来创建几个餐厅订单管理的数据表，一共用到3张数据表，Item Master表、Order Master表和Order Detail表。</p>
<p></p>
<h3>创建表：</h3>
<p></p>
<p></p>
<h3>创建Item Master表：</h3>
<p></p>
<p>代码如下：</p>
<pre>
<code>
CREATE TABLE [dbo].[ItemMasters](
 [Item_Code] [varchar](20) NOT NULL,
 [Item_Name] [varchar](100) NOT NULL,
 [Price] Int NOT NULL,
 [TAX1] Int NOT NULL,
 [Discount] Int NOT NULL,
 [Description] [varchar](200) NOT NULL,
 [IN_DATE] [datetime] NOT NULL,
 [IN_USR_ID] [varchar](20) NOT NULL,
 [UP_DATE] [datetime] NOT NULL,
 [UP_USR_ID] [varchar](20) NOT NULL,
 CONSTRAINT [PK_ItemMasters] PRIMARY KEY CLUSTERED 
(
 [Item_Code] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
</code></pre>
<p></p>
<h3>向Item Master表插入数据：</h3>
<p></p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
INSERT INTO [ItemMasters] ([Item_Code],[Item_Name],[Price],[TAX1],[Discount],[Description],[IN_DATE]
   ,[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('Item001','Coke',55,1,0,'Coke which need to be cold',GETDATE(),'SHANU'
   ,GETDATE(),'SHANU')

INSERT INTO [ItemMasters] ([Item_Code],[Item_Name],[Price],[TAX1],[Discount],[Description],[IN_DATE]
   ,[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('Item002','Coffee',40,0,2,'Coffe Might be Hot or Cold user choice',GETDATE(),'SHANU'
   ,GETDATE(),'SHANU')

INSERT INTO [ItemMasters] ([Item_Code],[Item_Name],[Price],[TAX1],[Discount],[Description],[IN_DATE]
   ,[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('Item003','Chiken Burger',125,2,5,'Spicy',GETDATE(),'SHANU'
   ,GETDATE(),'SHANU')

INSERT INTO [ItemMasters] ([Item_Code],[Item_Name],[Price],[TAX1],[Discount],[Description],[IN_DATE]
   ,[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('Item004','Potato Fry',15,0,0,'No Comments',GETDATE(),'SHANU'
   ,GETDATE(),'SHANU')

</code></pre>
<p></p>
<h3>创建Order Master表：</h3>
<p></p>
<p>代码如下：</p>
<pre>
<code>
CREATE TABLE [dbo].[OrderMasters](
 [Order_No] [varchar](20) NOT NULL,
 [Table_ID] [varchar](20) NOT NULL,
 [Description] [varchar](200) NOT NULL,
 [IN_DATE] [datetime] NOT NULL,
 [IN_USR_ID] [varchar](20) NOT NULL,
 [UP_DATE] [datetime] NOT NULL,
 [UP_USR_ID] [varchar](20) NOT NULL,
 CONSTRAINT [PK_OrderMasters] PRIMARY KEY CLUSTERED 
(
 [Order_No] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
</code></pre>
<p></p>
<h3>向Order Master表插入数据：</h3>
<p></p>
<p>代码如下：</p>
<pre>
<code>
INSERT INTO [OrderMasters]
   ([Order_No],[Table_ID] ,[Description],[IN_DATE],[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('Ord_001','T1','',GETDATE(),'SHANU' ,GETDATE(),'SHANU')

INSERT INTO [OrderMasters]
   ([Order_No],[Table_ID] ,[Description],[IN_DATE],[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('Ord_002','T2','',GETDATE(),'Mak' ,GETDATE(),'MAK')

INSERT INTO [OrderMasters]
   ([Order_No],[Table_ID] ,[Description],[IN_DATE],[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('Ord_003','T3','',GETDATE(),'RAJ' ,GETDATE(),'RAJ')

</code></pre>
<p></p>
<h3>创建Order Detail表：</h3>
<p></p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
CREATE TABLE [dbo].[OrderDetails](
 [Order_Detail_No] [varchar](20) NOT NULL,
 [Order_No] [varchar](20) CONSTRAINT fk_OrderMasters FOREIGN KEY REFERENCES OrderMasters(Order_No),
 [Item_Code] [varchar](20) CONSTRAINT fk_ItemMasters FOREIGN KEY REFERENCES ItemMasters(Item_Code),
 [Notes] [varchar](200) NOT NULL,
 [QTY] INT NOT NULL,
 [IN_DATE] [datetime] NOT NULL,
 [IN_USR_ID] [varchar](20) NOT NULL,
 [UP_DATE] [datetime] NOT NULL,
 [UP_USR_ID] [varchar](20) NOT NULL,
 CONSTRAINT [PK_OrderDetails] PRIMARY KEY CLUSTERED 
(
 [Order_Detail_No] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

--Now let’s insert the 3 items for the above Order No 'Ord_001'.
INSERT INTO [OrderDetails]
   ([Order_Detail_No],[Order_No],[Item_Code],[Notes],[QTY]
   ,[IN_DATE],[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('OR_Dt_001','Ord_001','Item001','Need very Cold',3
   ,GETDATE(),'SHANU' ,GETDATE(),'SHANU')

INSERT INTO [OrderDetails]
   ([Order_Detail_No],[Order_No],[Item_Code],[Notes],[QTY]
   ,[IN_DATE],[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('OR_Dt_002','Ord_001','Item004','very Hot ',2
   ,GETDATE(),'SHANU' ,GETDATE(),'SHANU')

INSERT INTO [OrderDetails]
   ([Order_Detail_No],[Order_No],[Item_Code],[Notes],[QTY]
   ,[IN_DATE],[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('OR_Dt_003','Ord_001','Item003','Very Spicy',4
   ,GETDATE(),'SHANU' ,GETDATE(),'SHANU')

</code></pre>
<p></p>
<h3>向Order Detail表插入数据：</h3>
<p></p>
<p>代码如下：</p>
<pre>
<code>
INSERT INTO [OrderDetails]
   ([Order_Detail_No],[Order_No],[Item_Code],[Notes],[QTY]
   ,[IN_DATE],[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('OR_Dt_004','Ord_002','Item002','Need very Hot',2
   ,GETDATE(),'SHANU' ,GETDATE(),'SHANU')

INSERT INTO [OrderDetails]
   ([Order_Detail_No],[Order_No],[Item_Code],[Notes],[QTY]
   ,[IN_DATE],[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('OR_Dt_005','Ord_002','Item003','very Hot ',2
   ,GETDATE(),'SHANU' ,GETDATE(),'SHANU')

INSERT INTO [OrderDetails]
   ([Order_Detail_No],[Order_No],[Item_Code],[Notes],[QTY]
   ,[IN_DATE],[IN_USR_ID],[UP_DATE],[UP_USR_ID])
  VALUES
   ('OR_Dt_006','Ord_003','Item003','Very Spicy',4
   ,GETDATE(),'SHANU' ,GETDATE(),'SHANU')
</code></pre>
<p></p>
<h3>2、简单的Select查询语句</h3>
<p></p>
<p>Select查询语句是SQL中最基本也是最重要的DML语句之一。那么什么是DML？DML全称Data Manipulation Language（数据操纵语言命令），它可以使用户能够查询数据库以及操作已有数据库中的数据。</p>
<p>下面我们在SQL Server中用select语句来查询我的姓名(Name)：</p>
<p>代码如下：</p>
<pre>
<code>
SELECT 'My Name Is SYED SHANU'
-- With Column Name using 'AS'
SELECT 'My Name Is SYED SHANU' as 'MY NAME'
-- With more then the one Column 
SELECT 'My Name' as 'Column1', 'Is' as 'Column2', 'SYED SHANU' as 'Column3'
</code></pre>
<p>在数据表中使用select查询：</p>
<p>代码如下：</p>
<pre>
<code>
-- To Display all the columns from the table we use * operator in select Statement.
Select * from ItemMasters
-- If we need to select only few fields from a table we can use the Column Name in Select Statement.
Select Item_Code
 ,Item_name as Item
 ,Price
 ,Description
 ,In_DATE
 FROM
 ItemMasters
</code></pre>
<p></p>
<h3>3、合计和标量函数</h3>
<p></p>
<p>合计函数和标量函数都是SQL Server的内置函数，我们可以在select查询语句中使用它们，比如Count(), Max(), Sum(), Upper(), lower(), Round()等等。下面我们用SQL代码来解释这些函数的用法：</p>
<p>代码如下：</p>
<pre>
<code>
select * from ItemMasters
-- Aggregate
-- COUNT() -&gt; returns the Total no of records from table , AVG() returns the Average Value from Colum,MAX() Returns MaX Value from Column
-- ,MIN() returns Min Value from Column,SUM() sum of total from Column
Select Count(*) TotalRows,AVG(Price) AVGPrice
 ,MAX(Price) MAXPrice,MIN(Price) MinPrice,Sum(price) PriceTotal 
 FROM ItemMasters

-- Scalar 
-- UCASE() -&gt; Convert to Upper Case ,LCASE() -&gt; Convert to Lower Case,
-- SUBSTRING() -&gt;Display selected char from column -&gt;SUBSTRING(ColumnName,StartIndex,LenthofChartoDisplay)
--,LEN() -&gt; lenth of column date,
-- ROUND() -&gt; Which will round the value
SELECT UPPER(Item_NAME) Uppers,LOWER(Item_NAME) Lowers,
 SUBSTRING(Item_NAME,2,3) MidValue,LEN(Item_NAME) Lenths 
 ,SUBSTRING(Item_NAME,2,LEN(Item_NAME)) MidValuewithLenFunction, 
  ROUND(Price,0) as Rounded
 FROM ItemMasters

</code></pre>
<p></p>
<h3>4、日期函数</h3>
<p></p>
<p>在我们的项目数据表中基本都会使用到日期列，因此日期函数在项目中扮演着非常重要的角色。有时候我们对日期函数要非常的小心，它随时可以给你带来巨大的麻烦。在项目中，我们要选择合适的日期函数和日期格式，下面是一些SQL日期函数的例子：</p>
<p>代码如下：</p>
<pre>
<code>
-- GETDATE() -&gt; to Display the Current Date and Time
-- Format() -&gt; used to display our date in our requested format
Select GETDATE() CurrentDateTime, FORMAT(GETDATE(),'yyyy-MM-dd') AS DateFormats,
 FORMAT(GETDATE(),'HH-mm-ss')TimeFormats,
 CONVERT(VARCHAR(10),GETDATE(),10) Converts1,
 CONVERT(VARCHAR(24),GETDATE(),113),
 CONVERT(NVARCHAR, getdate(), 106) Converts2 ,-- here we used Convert Function 
 REPLACE(convert(NVARCHAR, getdate(), 106), ' ', '/') Formats-- Here we used replace and --convert functions.
 --first we convert the date to nvarchar and then we replace the '' with '/' 

select * from Itemmasters

Select ITEM_NAME,IN_DATE CurrentDateTime, FORMAT(IN_DATE,'yyyy-MM-dd') AS DateFormats,
 FORMAT(IN_DATE,'HH-mm-ss')TimeFormats,
 CONVERT(VARCHAR(10),IN_DATE,10) Converts1,
 CONVERT(VARCHAR(24),IN_DATE,113),
 convert(NVARCHAR, IN_DATE, 106) Converts2 ,-- here we used Convert Function 
 REPLACE(convert(NVARCHAR,IN_DATE, 106), ' ', '/') Formats
 FROM Itemmasters
</code></pre>
<p>DatePart &ndash;&gt; 该函数可以获取年、月、日的信息。</p>
<p>DateADD &ndash;&gt; 该函数可以对当前的日期进行加减。</p>
<p>DateDiff &ndash;&gt; 该函数可以比较2个日期。</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
--Datepart DATEPART(dateparttype,yourDate)
SELECT DATEPART(yyyy,getdate()) AS YEARs ,
DATEPART(mm,getdate()) AS MONTHS,
DATEPART(dd,getdate()) AS Days,
DATEPART(week,getdate()) AS weeks,
DATEPART(hour,getdate()) AS hours

--Days Add to add or subdtract date from a selected date.
SELECT GetDate()CurrentDate,DATEADD(day,12,getdate()) AS AddDays ,
 DATEADD(day,-4,getdate()) AS FourDaysBeforeDate 

 -- DATEDIFF() -&gt; to display the Days between 2 dates
 select DATEDIFF(year,'2003-08-05',getdate()) yearDifferance , 
 DATEDIFF(day,DATEADD(day,-24,getdate()),getdate()) daysDifferent,
 DATEDIFF(month,getdate(),DATEADD(Month,6,getdate())) MonthDifferance

</code></pre>
<p></p>
<h3>5、其他Select函数</h3>
<p></p>
<p></p>
<h3>Top &mdash;&mdash;</h3>结合select语句，Top函数可以查询头几条和末几条的数据记录。
<p></p>
<p></p>
<h3>Order By &mdash;&mdash;</h3>结合select语句，Order By可以让查询结果按某个字段正序和逆序输出数据记录。
<p></p>
<p>代码如下：</p>
<pre>
<code>
--Top to Select Top first and last records using Select Statement.
Select * FROM ItemMasters
--&gt; First Display top 2 Records
Select TOP 2 Item_Code
 ,Item_name as Item
 ,Price
 ,Description
 ,In_DATE
FROM ItemMasters
--&gt; to Display the Last to Records we need to use the Order By Clause
-- order By to display Records in assending or desending order by the columns
Select TOP 2 Item_Code
 ,Item_name as Item
 ,Price
 ,Description
 ,In_DATE
FROM ItemMasters
ORDER BY Item_Code DESC
</code></pre>
<p></p>
<h3>Distinct &mdash;&mdash;</h3>distinct关键字可以过滤重复的数据记录。
<p></p>
<p>代码如下：</p>
<pre>
<code>
Select * FROM ItemMasters
--Distinct -&gt; To avoid the Duplicate records we use the distinct in select statement
-- for example in this table we can see here we have the duplicate record 'Chiken Burger'
-- but with different Item_Code when i use the below select statement see what happen

Select Item_name as Item
 ,Price
 ,Description 
 ,IN_USR_ID 
 FROM ItemMasters
-- here we can see the Row No 3 and 5 have the duplicate record to avoid this we use the distinct Keyword in select statement.

select Distinct Item_name as Item
 ,Price
 ,Description 
 ,IN_USR_ID 
  FROM ItemMasters

</code></pre>
<p></p>
<h3>6、Where子句</h3>
<p></p>
<p>Where子句在SQL Select查询语句中非常重要，为什么要使用where子句？什么时候使用where子句？where子句是利用一些条件来过滤数据结果集。</p>
<p>下面我们从10000条数据记录中查询Order_No为某个值或者某个区间的数据记录，另外还有其他的条件。</p>
<p>代码如下：</p>
<pre>
<code>
Select * from ItemMasters
Select * from OrderDetails
--Where -&gt; To display the data with certain conditions
-- Now below example which will display all the records which has Item_Name='Coke'
select * FROM ItemMasters WHERE ITEM_NAME='COKE'
-- If we want display all the records Iten_Name which Starts with 'C' then we use Like in where clause.
SELECT * FROM ItemMasters WHERE ITEM_NAME Like 'C%'

--&gt; here we display the ItemMasters where the price will be greater then or equal to 40.
--&gt; to use more then one condition we can Use And or Or operator.
--If we want to check the data between to date range then we can use Between Operator in Where Clause.
select Item_name as Item
 ,Price
 ,Description 
 ,IN_USR_ID 
 FROM ItemMasters
 WHERE
 ITEM_NAME Like 'C%' 
 AND 
 price &gt;=40
--&gt; here we display the OrderDetails where the Qty will be greater 3

Select * FROM OrderDetails WHERE qty&gt;3

</code></pre>
<p></p>
<h3>Where &ndash; In 子句</h3>
<p></p>
<p>代码如下：</p>
<pre>
<code>
-- In clause -&gt; used to display the data which is in the condition
select *
 FROM ItemMasters
 WHERE
 Item_name IN ('Coffee','Chiken Burger')

-- In clause with Order By - Here we display the in descending order.
select *
 FROM ItemMasters
 WHERE
 Item_name IN ('Coffee','Chiken Burger')
 ORDER BY Item_Code Desc

</code></pre>
<p></p>
<h3>Where &ndash; Between子句</h3>
<p></p>
<p>代码如下：</p>
<pre>
<code>
-- between -&gt; Now if we want to display the data between to date range then we use betweeen keyword
select * FROM ItemMasters

select * FROM ItemMasters
 WHERE
 In_Date BETWEEN '2014-09-22 15:59:02.853' AND '2014-09-22 15:59:02.853'

select * FROM ItemMasters
 WHERE
 ITEM_NAME Like 'C%' 
 AND
 In_Date BETWEEN '2014-09-22 15:59:02.853' AND '2014-09-22 15:59:02.853'
</code></pre>
<p>查询某个条件区间的数据，我们常常使用between子句。</p>
<p></p>
<h3>7、Group By 子句</h3>
<p></p>
<p></p>
<h3>Group By子句</h3>可以对查询的结果集按指定字段分组：
<p></p>
<p>代码如下：</p>
<pre>
<code>
--Group By -&gt; To display the data with group result.Here we can see we display all the AQggregate result by Item Name
Select ITEM_NAME,Count(*) TotalRows,AVG(Price) AVGPrice
 ,MAX(Price) MAXPrice,MIN(Price) MinPrice,Sum(price) PriceTotal 
 FROM
 ItemMasters
 GROUP BY ITEM_NAME

-- Here this group by will combine all the same Order_No result and make the total or each order_NO
Select Order_NO,Sum(QTy) as TotalQTY 
 FROM OrderDetails
 where qty&gt;=2
 GROUP BY Order_NO

-- Here the Total will be created by order_No and Item_Code
Select Order_NO,Item_Code,Sum(QTy) as TotalQTY 
 FROM OrderDetails
 where qty&gt;=2
 GROUP BY Order_NO,Item_Code
 Order By Order_NO Desc,Item_Code

</code></pre>
<p></p>
<h3>Group By &amp; Having 子句</h3>
<p></p>
<p>代码如下：</p>
<pre>
<code>
--Group By Clause -- here this will display all the Order_no 
Select Order_NO,Sum(QTy) as TotalQTY 
 FROM OrderDetails
 GROUP BY Order_NO

-- Having Clause-- This will avoid the the sum(qty) less then 4 
Select Order_NO,Sum(QTy) as TotalQTY 
 FROM OrderDetails
 GROUP BY Order_NO
 HAVING Sum(QTy) &gt;4

</code></pre>
<p style="text-align: center">【图片暂缺】</p>
<p></p>
<h3>8、子查询</h3>
<p></p>
<p>子查询一般出现在where内连接查询和嵌套查询中，select、update和delete语句中均可以使用。</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
--Sub Query -- Here we used the Sub query in where clause to get all the Item_Code where the price&gt;40 now this sub 
--query reslut we used in our main query to filter all the records which Item_code from Subquery result
SELECT * FROM ItemMasters 
  WHERE Item_Code IN 
 (SELECT Item_Code FROM ItemMasters WHERE price &gt; 40)

-- Sub Query with Insert Statement
INSERT INTO ItemMasters      ([Item_Code] ,[Item_Name],[Price],[TAX1],[Discount],[Description],[IN_DATE]
      ,[IN_USR_ID],[UP_DATE] ,[UP_USR_ID])
  Select 'Item006'
      ,Item_Name,Price+4,TAX1,Discount,Description
      ,GetDate(),'SHANU',GetDate(),'SHANU'
      from ItemMasters
      where Item_code='Item002'   

--After insert we can see the result as 
    Select * from ItemMasters

</code></pre>
<p></p>
<h3>9、连接查询</h3>
<p></p>
<p>到目前为止我们接触了不少单表的查询语句，现在我们来使用连接查询获取多个表的数据。</p>
<p>简单的join语句：</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
--Now we have used the simple join with out any condition this will display all the
-- records with duplicate data to avaoid this we see our next example with condition
SELECT * FROM Ordermasters,OrderDetails
-- Simple Join with Condition now here we can see the duplicate records now has been avoided by using the where checing with both table primaryKey field
SELECT * 
 FROM
 Ordermasters as M, OrderDetails as D
 where M.Order_NO=D.Order_NO
 and M.Order_NO='Ord_001'

-- Now to make more better understanding we need to select the need fields from both 
--table insted of displaying all column.
SELECT M.order_NO,M.Table_ID,D.Order_detail_no,Item_code,Notes,Qty
  FROM 
  Ordermasters as M, OrderDetails as D 
  where M.Order_NO=D.Order_NO         
 -- Now lets Join 3 table
 SELECT M.order_NO,M.Table_ID,D.Order_detail_no,I.Item_Name,D.Notes,D.Qty,I.Price,
        I.Price*D.Qty as TotalPrice
  FROM 
  Ordermasters as M, OrderDetails as D,ItemMasters as I 
  where 
  M.Order_NO=D.Order_NO AND D.Item_Code=I.Item_Code

</code></pre>
<p></p>
<h3>Inner Join,Left Outer Join,Right Outer Join and Full outer Join</h3>
<p></p>
<p>下面是各种类型的连接查询代码：</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
--INNER JOIN 
--This will display the records which in both table Satisfy here i have used Like in where class which display the 
SELECT M.order_NO,M.Table_ID,D.Order_detail_no,I.Item_Name,D.Notes,D.Qty,I.Price,I.Price*D.Qty as TotalPrice
 FROM 
 Ordermasters as M Inner JOIN OrderDetails as D 
 ON M.Order_NO=D.Order_NO
 INNER JOIN ItemMasters as I 
 ON  D.Item_Code=I.Item_Code
 WHERE
 M.Table_ID like 'T%'
--LEFT OUTER JOIN 
--This will display the records which Left side table Satisfy
 SELECT M.order_NO,M.Table_ID,D.Order_detail_no,I.Item_Name,D.Notes,D.Qty,I.Price,I.Price*D.Qty as TotalPrice
 FROM 
 Ordermasters as M LEFT OUTER JOIN OrderDetails as D 
 ON M.Order_NO=D.Order_NO
 LEFT OUTER JOIN ItemMasters as I 
 ON  D.Item_Code=I.Item_Code
 WHERE
 M.Table_ID like 'T%'
--RIGHT OUTER JOIN 
--This will display the records which Left side table Satisfy
 SELECT M.order_NO,M.Table_ID,D.Order_detail_no,I.Item_Name,D.Notes,D.Qty,I.Price,I.Price*D.Qty as TotalPrice
 FROM 
 Ordermasters as M RIGHT OUTER JOIN OrderDetails as D 
 ON M.Order_NO=D.Order_NO
 RIGHT OUTER JOIN ItemMasters as I 
 ON  D.Item_Code=I.Item_Code
 WHERE
 M.Table_ID like 'T%'

--FULL OUTER JOIN 
--This will display the records which Left side table Satisfy
 SELECT M.order_NO,M.Table_ID,D.Order_detail_no,I.Item_Name,D.Notes,D.Qty,I.Price,I.Price*D.Qty as TotalPrice
 FROM 
 Ordermasters as M FULL OUTER JOIN OrderDetails as D 
 ON M.Order_NO=D.Order_NO
 FULL OUTER JOIN ItemMasters as I 
 ON  D.Item_Code=I.Item_Code
 WHERE
 M.Table_ID like 'T%'

</code></pre>
<p></p>
<h3>10、Union合并查询</h3>
<p></p>
<p>Union查询可以把多张表的数据合并起来，Union只会把唯一的数据查询出来，而Union ALL则会把重复的数据也查询出来。</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
Select column1,Colum2 from Table1
Union
Select Column1,Column2 from Table2

Select column1,Colum2 from Table1
Union All
Select Column1,Column2 from Table2

</code></pre>
<p>具体的例子如下：</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
--Select with different where condition which display the result as 2 Table result
select Item_Code,Item_Name,Price,Description FROM ItemMasters where price &lt;=44
select Item_Code,Item_Name,Price,Description FROM ItemMasters where price &gt;44

-- Union with same table but with different where condition now which result as one table which combine both the result.
select Item_Code,Item_Name,Price,Description FROM ItemMasters where price &lt;=44
UNION
select Item_Code,Item_Name,Price,Description FROM ItemMasters where price &gt;44

-- Union ALL with Join sample
 SELECT M.order_NO,M.Table_ID,D.Order_detail_no,I.Item_Name,D.Notes,D.Qty,I.Price,I.Price*D.Qty as TotalPrice
 FROM 
 Ordermasters as M (NOLOCK)  Inner JOIN OrderDetails as D 
 ON M.Order_NO=D.Order_NO INNER JOIN ItemMasters as I 
 ON  D.Item_Code=I.Item_Code WHERE I.Price &lt;=44 
Union ALL
 SELECT M.order_NO,M.Table_ID,D.Order_detail_no,I.Item_Name,D.Notes,D.Qty,I.Price,I.Price*D.Qty as TotalPrice
 FROM 
 Ordermasters as M (NOLOCK)  Inner JOIN OrderDetails as D
 ON M.Order_NO=D.Order_NO INNER JOIN ItemMasters as I
 ON  D.Item_Code=I.Item_Code WHERE I.Price&gt;44

</code></pre>
<p></p>
<h3>11、公用表表达式（CTE）&mdash;&mdash;With语句</h3>
<p></p>
<p>CTE可以看作是一个临时的结果集，可以在接下来的一个SELECT,INSERT,UPDATE,DELETE,MERGE语句中被多次引用。使用公用表达式可以让语句更加清晰简练。</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
declare @sDate datetime,
    @eDate datetime;

select @sDate = getdate()-5,
    @eDate = getdate()+16;
--select @sDate StartDate,@eDate EndDate
;with cte as
  (
   select @sDate StartDate,'W'+convert(varchar(2),
      DATEPART( wk, @sDate))+'('+convert(varchar(2),@sDate,106)+')' as 'SDT'   
 union all
    select dateadd(DAY, 1, StartDate) ,
       'W'+convert(varchar(2),DATEPART( wk, StartDate))+'('+convert(varchar(2),
        dateadd(DAY, 1, StartDate),106)+')' as 'SDT'  
 FROM cte
 WHERE dateadd(DAY, 1, StartDate)&lt;= @eDate 
  )
select * from cte
option (maxrecursion 0)

</code></pre>
<p></p>
<h3>12、视图</h3>
<p></p>
<p>很多人对视图View感到很沮丧，因为它看起来跟select语句没什么区别。在视图中我们同样可以使用select查询语句，但是视图对我们来说依然非常重要。</p>
<p>假设我们要联合查询4张表中的20几个字段，那么这个select查询语句会非常复杂。但是这样的语句我们在很多地方都需要用到，如果将它编写成视图，那么使用起来会方便很多。利用视图查询有以下几个优点：</p>
<ul>
	<li>一定程度上提高查询速度</li>
	<li>可以对一些字段根据不同的权限进行屏蔽，因此提高了安全性</li>
	<li>对多表的连接查询会非常方便</li>
</ul>
<p>下面是一个视图的代码例子：</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
CREATE 
VIEW viewname
AS
Select ColumNames from yourTable

Example : 
-- Here we create view for our Union ALL example
Create 
VIEW myUnionVIEW
AS
 SELECT M.order_NO,M.Table_ID,D.Order_detail_no,I.Item_Name,D.Notes,D.Qty,I.Price,
    I.Price*D.Qty as TotalPrice
   FROM 
  Ordermasters as M Inner JOIN OrderDetails as D 
  ON M.Order_NO=D.Order_NO INNER JOIN ItemMasters as I 
  ON  D.Item_Code=I.Item_Code WHERE I.Price &lt;=44 
Union ALL
 SELECT M.order_NO,M.Table_ID,D.Order_detail_no,I.Item_Name,D.Notes,D.Qty,I.Price,
    I.Price*D.Qty as TotalPrice
   FROM 
  Ordermasters as M Inner JOIN OrderDetails as D 
  ON M.Order_NO=D.Order_NO INNER JOIN ItemMasters as I 
  ON  D.Item_Code=I.Item_Code WHERE I.Price&gt;44

-- View Select query
Select * from myUnionVIEW
-- We can also use the View to display with where condition and with selected fields 
Select order_Detail_NO,Table_ID,Item_Name,Price from myUnionVIEW where price &gt;40

</code></pre>
<p></p>
<h3>13、Pivot行转列</h3>
<p></p>
<p>Pivot可以帮助你实现数据行转换成数据列，具体用法如下：</p>
<p>代码如下：</p>
<pre>
<code>
-- Simple Pivot Example 
SELECT * FROM ItemMasters 
PIVOT(SUM(Price)    
 FOR ITEM_NAME IN ([Chiken Burger], Coffee,Coke)) AS PVTTable

-- Pivot with detail example
SELECT *
FROM (
  SELECT 
    ITEM_NAME, 
    price as TotAmount 
  FROM ItemMasters

) as s
PIVOT
(
  SUM(TotAmount)
  FOR [ITEM_NAME] IN ([Chiken Burger], [Coffee],[Coke])
)AS MyPivot

</code></pre>
<p></p>
<h3>14、存储过程</h3>
<p></p>
<p>我经常看到有人提问如何在SQL Server中编写多条查询的SQL语句，然后将它们使用到C#程序中去。存储过程就可以完成这样的功能，存储过程可以将多个SQL查询聚集在一起，创建存储过程的基本结构是这样的：</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
CREATE PROCEDURE [ProcedureName]                       

AS                                
BEGIN
-- Select or Update or Insert query.
END

To execute SP we use
exec ProcedureName

</code></pre>
<p>创建一个没有参数的存储过程：</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
-- =============================================                                
-- Author   : Shanu                                
-- Create date : 2014-09-15                                
-- Description : To Display Pivot Data                            
-- Latest                                
-- Modifier  : Shanu                                
-- Modify date : 2014-09-15                                 
-- =============================================                                
-- exec USP_SelectPivot                 
-- =============================================                              
Create PROCEDURE [dbo].[USP_SelectPivot]   
AS                                
BEGIN                         
  DECLARE @MyColumns AS NVARCHAR(MAX),
  @SQLquery AS NVARCHAR(MAX)
-- here first we get all the ItemName which should be display in Columns we use this in our necxt pivot query
select @MyColumns = STUFF((SELECT ',' + QUOTENAME(Item_NAME) 
          FROM ItemMasters
          GROUP BY Item_NAME
          ORDER BY Item_NAME
      FOR XML PATH(''), TYPE
      ).value('.', 'NVARCHAR(MAX)') 
    ,1,1,'')
-- here we use the above all Item name to disoplay its price as column and row display
set @SQLquery = N'SELECT ' + @MyColumns + N' from 
       (
         SELECT 
    ITEM_NAME, 
    price as TotAmount 
  FROM ItemMasters
      ) x
      pivot 
      (
         SUM(TotAmount)
        for ITEM_NAME in (' + @MyColumns + N')
      ) p '

exec sp_executesql @SQLquery;     

  RETURN                       
  END

</code></pre>
<p></p>
<h3>15、函数Function</h3>
<p></p>
<p>之前我们介绍了MAX(),SUM(), GetDate()等最基本的SQL函数，现在我们来看看如何创建自定义SQL函数。创建函数的格式如下：</p>
<p>代码如下：</p>
<pre>
<code>
Create Function functionName
As
Begin
END</code></pre>
<p>下面是一个简单的函数示例：</p>
<p></p>
<p>代码如下：</p>
<pre>
<code>
Alter FUNCTION [dbo].[ufnSelectitemMaster]()
RETURNS int 
AS 
-- Returns total Row count of Item Master.

BEGIN
 DECLARE @RowsCount AS int;

Select @RowsCount= count(*)+1 from ItemMasters
 RETURN @RowsCount;

END

-- to View Function we use select and fucntion Name
select [dbo].[ufnSelectitemMaster]()

</code></pre>
<p>下面的一个函数可以实现从给定的日期中得到当前月的最后一天：</p>
<p>代码如下：</p>
<pre>
<code>
ALTER FUNCTION [dbo].[ufn_LastDayOfMonth]
(
  @DATE NVARCHAR(10) 
)
RETURNS NVARCHAR(10)
AS
BEGIN
  RETURN CONVERT(NVARCHAR(10), DATEADD(D, -1, DATEADD(M, 1, CAST(SUBSTRING(@DATE,1,7) + '-01' AS DATETIME))), 120)
END
SELECT dbo.ufn_LastDayOfMonth('2014-09-01')AS LastDay
</code></pre>
<p>以上就是适合初学者学习的基础SQL查询语句，希望对大家学习SQL查询语句有所帮助。</p>

<p>注：关于15个初学者必看的基础SQL查询语句的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>
			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/mysql/biji/2706.html'>SQL Server SSIS 延迟验证示例</a><a>下一篇</a><a href='/mysql/biji/2708.html'>SQL Server数据库访问性能优化示例</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>