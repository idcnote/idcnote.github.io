<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>SQL Server sql cast，convert，QUOTENAME，exec 函数学习记录_mysql教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了SQL Server sql cast，convert，QUOTENAME，exec 函数学习记录，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
语" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
	    <a href="/mysql/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>数据库笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">SQL Server sql cast，convert，QUOTENAME，exec 函数学习记录</h1>
					</div>
                    <div class="panel-title">
                        2022-11-12 09:54:43                    </div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了SQL Server sql cast，convert，QUOTENAME，exec 函数学习记录，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！
语</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了SQL Server sql cast，convert，QUOTENAME，exec 函数学习记录，具有一定的参考价值，可以用来参考一下。</p>

<p>对此感兴趣的朋友，看看idc笔记做的技术笔记！</p>
<p>语法使用 CAST：</p>
<p>CAST ( expression AS data_type )</p>
<p>使用 CONVERT：</p>
<p>CONVERT (data_type[(length)], expression [, style])</p>
<p>参数expression</p>
<p>是任何有效的 Microsoft SQL Server&quot; 表达式。有关更多信息，请参见表达式。</p>
<p>data_type</p>
<p>目标系统所提供的数据类型，包括 bigint 和 sql_variant。不能使用用户定义的数据类型。有关可用的数据类型的更多信息，请参见数据类型。</p>
<p>length</p>
<p>nchar、nvarchar、char、varchar、binary 或 varbinary 数据类型的可选参数。</p>
<p>style</p>
<p>日期格式样式，借以将 datetime 或 smalldatetime 数据转换为字符数据（nchar、nvarchar、char、varchar、nchar 或 nvarchar 数据类型）；或者字符串格式样式，借以将 float、real、money 或 smallmoney 数据转换为字符数据（nchar、nvarchar、char、varchar、nchar 或 nvarchar 数据类型）。</p>
<p>将某种数据类型的表达式显式转换为另一种数据类型。有关可用的数据类型的更多信息，请参见数据类型。日期格式样式，借以将 datetime 或 smalldatetime 数据转换为字符数据（nchar、nvarchar、char、varchar、nchar 或 nvarchar 数据类型）；或者字符串格式样式，借以将 float、real、money 或 smallmoney 数据转换为字符数据（nchar、nvarchar、char、varchar、nchar 或 nvarchar 数据类型）。当转换为字符数据时输出。</p>
<p>隐性转换对于用户是不可见的。SQL Server 自动将数据从一种数据类型转换成另一种数据类型。例如，如果一个 smallint 变量和一个 int 变量相比较，这个 smallint 变量在比较前即被隐性转换成 int 变量。</p>
<p>显式转换使用 CAST 或 CONVERT 函数。CAST 和 CONVERT 函数将数值从一个数据类型（局部变量、列或其它表达式）转换到另一个数据类型。</p>
<p>例如，下面的 CAST 函数将数值 $157.27 转换成字符串 &#39;&#39;$157.27&#39;&#39;：CAST ( $157.27 AS VARCHAR(10) )CAST 函数基于 SQL-92 标准并且优先于 CONVERT。</p>
<p>当从一个 SQL Server 对象的数据类型向另一个转换时，一些隐性和显式数据类型转换是不支持的。例如，nchar 数值根本就不能被转换成 image 数值。nchar 只能显式地转换成 binary，隐性地转换到 binary 是不支持的。nchar 可以显式地或者隐性地转换成 nvarchar。</p>
<p>当处理 sql_variant 数据类型时，SQL Server 支持将具有其它数据类型的对象隐性转换成 sql_variant 类型。然而，SQL Server 并不支持从 sql_variant 数据隐性地转换到其它数据类型的对象。</p>
<p>SELECT CONVERT(CHAR(10), CURRENT_TIMESTAMP, 102） （102表明使用了ANSI日期模式，即yy.mm.dd型） 然而，如果你希望将这个变量明确生成为datetime或smalldatetime变量，以此在特定的数据库栏中兼容，那么你可以使用以下语句： SELECT CAST(CONVERT(CHAR(10),CURRENT_TIMESTAMP,102) AS DATETIME 返回值将是 yy.mm.dd 00:00:00（如12：00AM作为时间戳；</p>
<p>函数QUOTENAME--功能:返回带有分隔符的Unicode字符串，分隔符的加入可使输入的字符串成为有效的MicrosoftSQLServer2005分隔标识符。--语法QUOTENAME(&#39;character_string&#39;[,&#39;quote_character&#39;])--举例说明:--比如你有一个表，名字叫index--你有一个动态查询，参数是表名declare@tbnamevarchar(256)set@tbname=&#39;index&#39;---查这个表里的数据：print(&#39;select*from&#39;+@tbname)exec(&#39;select*from&#39;+@tbname)--这样print出来的数据是select*fromindex--因为index是字键字，肯定出错，加上括号就可以了：select*from[index]--这便有了QUOTENAME，即：print(&#39;select*from&#39;+QUOTENAME(@tbname))--结果：select*from[index]exec(&#39;select*from&#39;+QUOTENAME(@tbname))</p>
<p><strong>EXEC命令有两个用法：执行一个存储过程，或者执行一个动态批次。批次是一个内容为SQL语句的字符串。</strong> 例如： declare @schemaName varchar(80),@tableName varchar(80), @objName varchar(512); set @schemaName=&#39;dbo&#39;; set @tableName=&#39;Orders&#39;; set @objName=@schemaName+&#39;.&#39;+@tableName; exec(&#39;select count(*) from <font color="#0000ff">&#39;+@objName</font>);</p>
<p> 注意，在exec的括号里，只允许是字符串变量、字符串常量存在。不允许在这里调用函数或者使用case表达式。 下面的代码是错误的： exec(&#39;select count(*) from &#39;+quotename(@objName)); 所以，基本的方法是将语句保存到一个变量里，例如： set @sql=&#39;...&#39;; exec(@sql); 这就不存在上述限制了。</p>
<p> 1 EXEC没有接口 Exec的唯一输入是字符串。一个动态批次无权访问调用它的批次内所定义的局部变量： declare @i int set @i=1; declare @sql varchar(255) set @sql=&#39;select * from dbo.orders where <font color="#0000ff">rderid=@i&#39;</font>; exec(@sql); 出错：必须声明标量变量@i 原因还是@i不能放在&#39;&#39;之内，它只能通过字符串连接动态的嵌入到SQL语句里： set @sql=&#39;select * from dbo.orders where rderid=&#39;+cast(@i as varchar(10));</p>
<p> 变量与字符串连接会引发所谓的SQL注入安全隐患，如果变量包含了字符串。要防患SQL注入的一个办法是限制 字符串的大小。 这种连接会对性能造成映像。SS会为每个字符串单独创建一个执行计划，无论两个字符串是否是一个模式。为此， 下面显示了一个例子： 首先清除cache里的执行计划： DBCC freeproccache; 然后执行下面的代码三次，分别将@i设置为10248,10249,10250 DECLARE @i AS INT; SET @i = 10248;</p>
<p> DECLARE @sql AS VARCHAR(52); SET @sql = &#39;SELECT * FROM dbo.Orders WHERE rderID = &#39; + CAST(@i AS VARCHAR(10)) + N&#39;;&#39;; EXEC(@sql) 最后查询sys.syscacheobjects: SELECT cacheobjtype, objtype, usecounts, sql FROM sys.syscacheobjects WHERE sql NOT LIKE &#39;%cache%&#39; AND sql NOT LIKE &#39;%sys.%&#39;; 结果显示为： 它会为每次查询生成一个执行计划。以及一个参数化的执行计划。</p>
<p> EXEC也没有输出参数。缺省情况下，exec将返回该次查询的输出给调用者。如果希望将该结果保存到变量里，那就必须使用Insert EXEC语法，并从表里从新读取该数据，然后储存到目标变量里。 DECLARE @schemaname AS NVARCHAR(128), @tablename AS NVARCHAR(128), @colname AS NVARCHAR(128), @sql AS NVARCHAR(805), @cnt AS INT;</p>
<p> SET @schemaname = N&#39;dbo&#39;; SET @tablename = N&#39;Orders&#39;; SET @colname = N&#39;CustomerID&#39;; SET @sql = N&#39;SELECT COUNT(DISTINCT &#39; + QUOTENAME(@colname) + N&#39;) FROM &#39; + QUOTENAME(@schemaname) + N&#39;.&#39; + QUOTENAME(@tablename) + N&#39;;&#39;;</p>
<p> CREATE TABLE #T(cnt INT); INSERT INTO #T EXEC(@sql); SET @cnt = (SELECT cnt FROM #T); SELECT @cnt; DROP TABLE #T;</p>
<p> 注意如果忘记输入最后的一条语句&ldquo;Drop 。。。&rdquo;，那么就会出现下面的令人讨厌的错误： 数据库中已存在名为 &#39;#T&#39; 的对象。 在上面这段程序里，创建了一个临时表，它对于动态批次是可见的。所以可以修改上面的程序为： SET @sql = N&#39;INSERT INTO #T(cnt) SELECT COUNT(DISTINCT &#39; + QUOTENAME(@colname) + N&#39;) FROM &#39; + QUOTENAME(@schemaname) + N&#39;.&#39; + QUOTENAME(@tablename) + N&#39;;&#39;;</p>
<p> CREATE TABLE #T(cnt INT); EXEC(@sql); SET @cnt = (SELECT cnt FROM #T); SELECT @cnt; DROP TABLE #T; 因为EXEC的执行是在Create Table之后，所以Insert语句可以移到@sql的定义里。</p>
<p> 2 变量的连接 在SS2000里，EXEC优于sp_executesql的一点是，它支持输入的代码长度要长一些。虽然，从技术上说后者的 输入代码字符串是NTEXT类型，通常希望用一个局部变量来保存它。但是，局部变量是不能声明成大对象类型的。 所以，实际上sp_executesql的最大支持的字符串长度是Unicode字符串的长度（NVARCHAR，4000个字符）。而 EXEC，则支持常规的字符串（VARCHAR），即8000个字符。 而且，EXEC支持多个变量的连接，每个变量最大有8000个字符。</p>
<p> 不过在SS2005里，变量类型可以是VARCHAR(max），最大为2G。 3 EXEC AT 这是05里的新语法。执行远程主机上的动态SQL语句</p>
<p>加上 N 代表存入数据库时以 Unicode 格式存储。N&#39;string&#39; 表示string是个Unicode字符串Unicode 字符串的格式与普通字符串相似，但它前面有一个 N 标识符（N 代表 SQL-92 标准中的国际语言 (National Language)）。N 前缀必须是大写字母。例如，&#39;Mich&eacute;l&#39; 是字符串常量而 N&#39;Mich&eacute;l&#39; 则是 Unicode 常量。Unicode 常量被解释为 Unicode 数据，并且不使用代码页进行计算。Unicode 常量确实有排序规则，主要用于控制比较和区分大小写。为 Unicode 常量指派当前数据库的默认排序规则，除非使用 COLLATE 子句为其指定了排序规则。Unicode 数据中的每个字符都使用两个字节进行存储，而字符数据中的每个字符则都使用一个字节进行存储。有关更多信息，请参见使用 Unicode 数据。Unicode 字符串常量支持增强的排序规则</p>
<p><strong>数据库名是一个标识符，表名也是一个标识符，在SQL SERVER中标识符分为两类： </strong></p>
<p><strong>标识符有两类：</strong></p>
<p><strong>常规标识符</strong></p>
<p class="indent">符合标识符的格式规则。在 Transact-SQL 语句中使用常规标识符时不用将其分隔。</p>
<pre>
<code>SELECT *FROM TableXWHERE KeyCol = 124</code></pre>
<p><strong>分隔标识符</strong></p>
<p class="indent">包含在双引号 (&quot;) 或者方括号 ([ ]) 内。符合标识符格式规则的标识符可以分隔，也可以不分隔。</p>
<pre>
<code>SELECT *FROM [TableX]     --Delimiter is optional.WHERE [KeyCol] = 124 --Delimiter is optional.</code></pre>
<p class="indent">在 Transact-SQL 语句中，对不符合所有标识符规则的标识符必须进行分隔。</p>
<pre>
<code>SELECT *FROM [My Table]   --Identifier contains a space and uses a reserved keyword.WHERE [order] = 10  --Identifier is a reserved keyword.</code></pre>
<p>常规标识符和分隔标识符包含的字符数必须在 1 到 128 之间。对于本地临时表，标识符最多可以有 116 个字符。</p>
<p><strong>两者重要的区别：常规标识符必须严格遵守命名的规定，而分隔标识符则可以不遵守命名规定，只要用[],&quot;&quot;分隔出来就可以。</strong></p>
<p>标识符格式:　　　　1、标识符必须是统一码(Unicode)2.0标准中规定的字符，以及其他一些语言字符。如汉字.　　　　2、标识符后的字符可以是(除条件一)&ldquo;_&rdquo;、&ldquo;@&rdquo;、&ldquo;#&rdquo;、&ldquo;$&rdquo;及数字。　　　　3、标识符不允许是Transact-SQL的保留字。　　　　4、标识符内不允许有空格和特殊字符。　　　　另外，某些以特殊符号开头的标识符在SQL　SERVER 中具有特定的含义。</p>
<p>如以&ldquo;@&rdquo;开头的标识符表示这是一个局部变量或是一个函数的参数;以#开头的标识符表示这是一个临时表或是一存储过程。</p>
<p>以&ldquo;##&rdquo;开头的表示这是一个全局的临时数据库对象。T</p>
<p>ransact-SQL的全局变量以&ldquo;@@&rdquo;开头。</p>
<p>标识符最多可以容纳128个字符。</p>

<p>注：关于SQL Server sql cast，convert，QUOTENAME，exec 函数学习记录的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>
			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/mysql/biji/4315.html'>SQL Sever导入数据图文方法</a><a>下一篇</a><a href='/mysql/biji/4317.html'>解决php与mysql中文乱码问题</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>