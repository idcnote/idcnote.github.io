<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>MySQL DBA 常用手册小结_mysql教程_IDC笔记</title>
    <meta name="keywords" content="PHP,PHP笔记,PHP教程" />
    <meta name="description" content="这篇文章主要为大家详细介绍了MySQL DBA 常用手册小结，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！1.mysql的远程连接命令可以远程导入" />
    <meta content="Responsive admin theme build on top of Bootstrap 4" name="description" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
	    <a href="/mysql/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>数据库笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">MySQL DBA 常用手册小结</h1>
					</div>
                    <div class="panel-title">
                        2022-11-12 09:22:05                    </div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>这篇文章主要为大家详细介绍了MySQL DBA 常用手册小结，具有一定的参考价值，可以用来参考一下。

对此感兴趣的朋友，看看idc笔记做的技术笔记！1.mysql的远程连接命令可以远程导入</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span><p>这篇文章主要为大家详细介绍了MySQL DBA 常用手册小结，具有一定的参考价值，可以用来参考一下。</p>

<p>对此感兴趣的朋友，看看idc笔记做的技术笔记！</p>1.mysql的远程连接命令可以远程导入导出数据mysqldump --default-character-set=gb2312 -h255.255.000.00 -uroot -pxxxxxx mydatabase&gt;d:\data.sql将指定的数据库导出到一个外部SQL文件中去！还原命令：mysql --default-character-set=gb2312 -h255.255.000.00 -uroot -pxxxxxx mydatabase&lt;d:\data.sql2. MYSQL三种升级方法安装办法：二进制包编译安装第一种：适用于任何一种存储引擎。1. 下载并安装好新版本的MySQL数据库，并将其端口改为3307（避免和旧版本的3306冲突），启动服务。2. 在新版本下创建同名数据库。# mysqldump -p3307 -uroot create mysqlsystems_com3. 在旧版本下备份该数据库。# mysqldump -p3306 -uroot mysqlsystems_com &gt; mysqlsystems_com.bkNote: 你也可以加上&ndash;opt选项，这样可以使用优化方式将你的数据库导出，减少未知的问题。4. 将导出的数据库备份导入到新版本的MySQL数据库中。# mysql -p3307 -uroot mysqlsystems_com &lt; mysqlsystems_com.bk5. 再将旧版本数据库中的data目录下的mysql数据库全部覆盖到新版本中。# cp -R /opt/mysql-5.1/data/mysql /opt/mysql-5.4/data（权限库保持不变）Note: 大家也都知道这个默认数据库的重要性。6. 在新版下执行mysql_upgrade命令，其实这个命令包含一下三个命令：# mysqlcheck &ndash;check-upgrade &ndash;all-databases &ndash;auto-repair# mysql_fix_privilege_tables# mysqlcheck &ndash;all-databases &ndash;check-upgrade &ndash;fix-db-names &ndash;fix-table-namesNote: 在每一次的升级过程中，mysql_upgrade这个命令我们都应该去执行，它通过mysqlcheck命令帮我们去检查表是否兼容新版本的数据库同时 作出修复，还有个很重要的作用就是使用mysql_fix_privilege_tables命令去升级权限表。7. 关闭旧版本，将新版的数据库的使用端口改为3306，重新启动新版本MySQL数据库。到此，一个简单环境下的数据库升级就结束了。第二种，同样适用任何存储引擎。1. 同样先安装好新版本的MySQL。2. 在旧版本中，备份数据库。# mkdir /opt/mysqlsystems_bk ; mysqldump -p3306 -uroot &ndash;tab=/opt/mysqlsystems_bk mysqlsystems_comNote: &ndash;tab选项可以在备份目录mysqlsystems_bk下生成后缀为*.sql和*.txt的两类文件；其中，.sql保存了创建表的SQL语句而.txt保存着原始数据。3. 接下来在新版本的数据库下更新数据。# mysqladmin -p3307 -uroot create mysqlsystems_com# cat /opt/mysqlsystems_bk/*.sql | mysql -p3307 -uroot mysqlsystems_com ( Create Tables )# mysqlimport mysqlsystems_com /opt/mysqlsystems_bk/*.txt ( Load Data )4. 之后的所有步骤与第一种方法的后三步5、6、7相同。第三种，适用于MyISAM存储引擎，全部是文件间的拷贝。1. 安装。2. 从旧版本mysqlsystems_com数据库下将所有.frm、.MYD 和.MYI文件拷贝到新版本的相同目录下。3.之后的步骤依然同于第一种的后三步。以上就是三种升级MySQL的方法，看似没有出现什么问题，其实，在实际的生产环境中，为会有诸多问题发生，这就需要我们在升级之前充分了解新版本中增加了哪些新功能，进一步分析升级以后这些新特性是否将会对我们原来应用产生影响。3. MYSQL远程连接不了的解决方案有可能是这个用户权限不够。查看一下权限表。4. MYSQL忘记密码解决办法在windows下：打开命令行窗口，停止mysql服务：Net stop mysql到mysql的安装路径启动mysql，在bin目录下使用mysqld-nt.exe启动，在命令行窗口执行：mysqld-nt --skip-grant-tables然后另外打开一个命入令行窗口，执行mysql，此时无需输入密码即可进入。&gt;use mysql&gt;update user set password=password(&quot;new_pass&quot;) where user=&quot;root&quot;;&gt;flush privileges;&gt;exit使用任务管理器，找到mysqld-nt的进程，结束进程！在重新启动mysql-nt服务，就可以用新密码登录了。在linux下：如果 MySQL 正在运行，首先杀之： killall -TERM mysqld。启动 MySQL ：bin/safe_mysqld --skip-grant-tables &amp;就可以不需要密码就进入 MySQL 了。然后就是&gt;use mysql&gt;update user set password=password(&quot;new_pass&quot;) where user=&quot;root&quot;;&gt;flush privileges;重新杀 MySQL ，用正常方法启动 MySQL 。5. 更改MYSQL的默认字符集法1、 用 SET 语法来指定，不加 &quot;GLOBAL&quot; 的话就只对本次会话有效SET [GLOBAL] character_set_client = utf8;SET [GLOBAL] character_set_connection = utf8;SET [GLOBAL] character_set_database = utf8;SET [GLOBAL] character_set_results = utf8;SET [GLOBAL] character_set_server = utf8;方法2、 也用SET语法，只对本次会话有效SET NAMES &#39;utf8&#39;;方法3、） 直接修改 my.cnf，增加一行内容，然后重启 MySQL，使之全局生效default-character-set = utf86.MYSQL慢查询分析工具：mysqldumpslowmysqldumpslow命令/path/mysqldumpslow -s c -t 10 /database/mysql/slow-log这会输出记录次数最多的10条SQL语句，其中：* -s, 是表示按照何种方式排序，c、t、l、r分别是按照记录次数、时间、查询时间、返回的记录数来排序，ac、at、al、ar，表示相应的倒叙；* -t, 是top n的意思，即为返回前面多少条的数据；* -g, 后边可以写一个正则匹配模式，大小写不敏感的；比如/path/mysqldumpslow -s r -t 10 /database/mysql/slow-log得到返回记录集最多的10个查询。/path/mysqldumpslow -s t -t 10 -g &ldquo;left join&rdquo; /database/mysql/slow-log得到按照时间排序的前10条里面含有左连接的查询语句。查看mysql的某个选项show variables like &lsquo;%VAR_NAME%&#39;;select @@VAR_NAME;在Linux下管理MySQL数据库的时候总有一些很紧急的情况，发现数据库突然变得压力很大了，那么作为一个DBA，也许需要一些常用的手段或者说命令去分析问题出现在哪里，然后解决：数据库突然产生压力时查看正在查询的SQL:(如果这里内容太多表示并发执行的SQL过多，或许数据库堵塞了，会越来越慢，正常情况下这里应该很少有东西的，也就是连接都在Sleep状态）/usr/local/mysql/bin/mysql -uroot -ppassword databaseName -e &ldquo;show full processlist&rdquo; | grep -v Sleep正在运行的SQL太多了，看不过来，那需要排序了，看持续执行时间最长的那些SQL：/usr/local/mysql/bin/mysql -uroot -ppassword databaseName -e &ldquo;show full processlist&rdquo; | grep -v Sleep | sort -k6rn &gt;sort.tmp如果发现IOWait很高，请查看临时表的生成情况，特别是disk tmp table:/usr/local/mysql/bin/mysql -uroot -ppassword databaseName -e &ldquo;show global status like &lsquo;%tmp%&#39;&rdquo;通过这样一些办法可以查看数据库都在忙什么，那些忙的SQL又具体在哪一个步骤上卡住了，是在创建磁盘临时文件、Sending Data、statistics？依照不同的原因来解决问题&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;关于Mysql Replication日常管理，重做，问题分析时常用的办法：重做Slave，或者Master变化等等，需要将Slave与新的Master同步：change master to master_host=IP,master_user=&#39;replication userName&#39;,master_password=&#39;replication Passwrod&#39;,master_log_file=&#39;log-bin.000001&prime;,master_log_pos=0;导出数据成SQL文本，慎用，根据你的DB大小会锁表，导致堵塞其他访问：nohup /usr/local/mysql/bin/mysqldump &ndash;database DATABASEName -uUserName -pPassWord &ndash;lock-all-tables -F &gt;DATA20070519.sql &amp;-F后会刷新Master Log这样配合上面的Change Master可以让Slave进行同步只导出数据库的结构（没有任何内容）/usr/local/mysql/bin/mysqldump -d DATABASEName -uUserName -pPassWord &gt;DATA20070519.structure只导出数据库的数据（没有创建表结构的语句等等）/usr/local/mysql/bin/mysqldump -t DATABASEName -uUserName -pPassWord &gt;DATA20070519.data同步的时候出现问题（或者其他问题）了，根据同步出现问题的位置（偏移量），查看Binlog的具体内容/usr/local/mysql/bin/mysqlbinlog binlogFileName &ndash;start-position=偏移量呵呵，我们碰到过Master执行的SQL到了Slave会报语法错误，够诡异吧！不过就是这样查到了原因：如果通过存储过程将bit的内容改为1就会出现这样的问题，后来将bit改为tinyint(1)就好了授权给某一台Slave拥有复制的权限：grant replication slave on *.* to 用户名@IP identified by &lsquo;密码&#39;;查看Slave状态：Show slave status \G查看Master状态：Show master status;重置Slave（慎用）reset slave;Slave出现问题了，先跳过这一条语句（请确认所要跳过的具体内容不会影响后面的同步，确认方法查看Binlog文件）：set global sql_slave_skip_counter=1; (记得先暂停Slave：stop slave; 然后重启Slave：start slave;)&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;纯粹Linux相关的：tcpdump -A &ldquo;dst port 3306&Prime; 查看3306端口的通信具体内容

<p>注：关于MySQL DBA 常用手册小结的内容就先介绍到这里，更多相关文章的可以留意</span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span></span>                                     
		    	</div>
			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/mysql/biji/1055.html'>MySQL存储过程 游标 循环使用介绍</a><a>下一篇</a><a href='/mysql/biji/1057.html'>MySQL中自增auto_increment功能的相关设置及问题</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>