<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <title>全面挖掘Java Excel API 使用方法_java教程_IDC笔记</title>
    <meta name="keywords" content=",java教程" />
    <meta name="description" content="使用Windows操作系统的朋友对Excel（电子表格）一定不会陌生，但是要使用Java语言来操纵Excel文件并不是一件容易的事。" />
    <meta content="idcnote.com" name="author" />
    <link rel="shortcut icon" href="/skin1/images/favicon.ico">
    <!--Morris Chart CSS -->
    <link rel="stylesheet" href="/skin1/css/morris.css">
    <link href="/skin1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/metismenu.min.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/icons.css" rel="stylesheet" type="text/css">
    <link href="/skin1/css/style.css" rel="stylesheet" type="text/css">
<link href="/SyntaxHighlighter/shCoreDefault.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="/SyntaxHighlighter/shCore.js"></script>
<script type="text/javascript">
 SyntaxHighlighter.all();
</script>
<script>
var paras = document.getElementsByTagName("pre");
for ( var i=0;i<paras.length;i++ ) {
    paras[i].setAttribute("class","brush:php;toolbar:false");     
}
</script>
</head>
<body>
<!-- Begin page -->
		<div id="wrapper">
			<!-- Top Bar Start -->
			<div class="topbar">
				<!-- LOGO -->
				<div class="topbar-left">
					<a href="/" class="logo">
						<span class="logo-light">
                            <i class="mdi mdi-camera-control"></i>IDC笔记
                        </span>
						<span class="logo-sm">
                            <i class="mdi mdi-camera-control"></i>
                        </span>
					</a>
				</div>
				<nav class="navbar-custom">
					<ul class="navbar-right list-inline float-right mb-0">
						<!--<li class="dropdown notification-list list-inline-item d-none d-md-inline-block">
							<a class="nav-link waves-effect" href="#" id="btn-fullscreen">
								<i class="mdi mdi-arrow-expand-all noti-icon"></i>
							</a>
						</li>
						<li class="dropdown notification-list list-inline-item">
							<div class="dropdown notification-list nav-pro-img">
								<a class="dropdown-toggle nav-link arrow-none nav-user" data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
									<img src="/skin1/picture/user-4.jpg" alt="user" class="rounded-circle">
								</a>
								<div class="dropdown-menu dropdown-menu-right profile-dropdown ">
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-account-circle"></i> Profile</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-wallet"></i> Wallet</a>
									<a class="dropdown-item d-block" href="#">
										<span class="badge badge-success float-right">11</span>
										<i class="mdi mdi-settings"></i> Settings</a>
									<a class="dropdown-item" href="#">
										<i class="mdi mdi-lock-open-outline"></i> Lock screen</a>
									<div class="dropdown-divider"></div>
									<a class="dropdown-item text-danger" href="#">
										<i class="mdi mdi-power text-danger"></i> Logout</a>
								</div>
							</div>
						</li>
						-->
					</ul>
					<ul class="list-inline menu-left mb-0">
						<li class="float-left">
							<button class="button-menu-mobile open-left waves-effect">
                            <i class="mdi mdi-menu"></i>
                        </button>
						</li>
						<li class="d-none d-md-inline-block">
							<form role="search" class="app-search">
								<div class="form-group mb-0">
									<input type="text" class="form-control" placeholder="Search..">
									<button type="submit"><i class="fa fa-search"></i></button>
								</div>
							</form>
						</li>
					</ul>
				</nav>
			</div>
<!-- ========== Left Sidebar Start ========== -->
<div class="left side-menu">
    <div class="slimscroll-menu" id="remove-scroll">
    <!--- Sidemenu -->
    <div id="sidebar-menu">
    <!-- Left Menu Start -->
    <ul class="metismenu" id="side-menu">
			<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> Java入门			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/java/start/184.html">第一个Java程序</a></li><li><a href="/java/start/185.html">如何运行Java程序</a></li><li><a href="/java/start/186.html">Java标识符与关键字</a></li><li><a href="/java/start/187.html">Java注释</a></li><li><a href="/java/start/188.html">Java常量</a></li><li><a href="/java/start/189.html">Java基本数据类型</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> Java运算符和表达式			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/java/operators/190.html">Java运算符和表达式</a></li><li><a href="/java/operators/191.html">Java算数运算符实例讲解</a></li><li><a href="/java/operators/192.html">Java关系运算符实例讲解</a></li><li><a href="/java/operators/193.html">Java逻辑运算符实例讲解</a></li><li><a href="/java/operators/194.html">Java位运算符实例讲解</a></li><li><a href="/java/operators/195.html">Java赋值运算符实例讲解</a></li><li><a href="/java/operators/196.html">Java条件运算符实例讲解</a></li><li><a href="/java/operators/197.html">Java instanceof运算符实例讲解</a></li><li><a href="/java/operators/198.html">Java运算符的优先级和结合性</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> Java流程控制			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/java/control/200.html">Java if条件分支语句</a></li><li><a href="/java/control/199.html">Java语句</a></li><li><a href="/java/control/201.html">Java switch开关语句</a></li><li><a href="/java/control/203.html">Java while循环语句</a></li><li><a href="/java/control/202.html">Java for循环语句</a></li><li><a href="/java/control/205.html">Java break语句</a></li><li><a href="/java/control/204.html">Java do-while循环语句</a></li><li><a href="/java/control/206.html">Java continue语句</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> Java类与对象			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 <li><a href="/java/objects/209.html">Java方法</a></li><li><a href="/java/objects/208.html">Java成员变量</a></li><li><a href="/java/objects/207.html">Java类</a></li><li><a href="/java/objects/211.html">Java创建对象</a></li><li><a href="/java/objects/210.html">Java类的构造方法</a></li><li><a href="/java/objects/213.html">Java对象的引用和实体</a></li><li><a href="/java/objects/212.html">Java使用对象</a></li><li><a href="/java/objects/216.html">Java实例变量和类变量</a></li><li><a href="/java/objects/215.html">Java参数传值</a></li><li><a href="/java/objects/214.html">Java类与程序的基本结构</a></li><li><a href="/java/objects/217.html">Java实例方法和类方法</a></li><li><a href="/java/objects/218.html">Java方法重载</a></li><li><a href="/java/objects/222.html">Java访问权限</a></li><li><a href="/java/objects/221.html">Java import语句</a></li><li><a href="/java/objects/220.html">Java包</a></li>		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> Java子类与继承			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> Java接口与实现			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> Java内部类与异常类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 		</ul>
	</li>
		<li>
		<a href="javascript:void(0);" class="waves-effect">
			<i class="icon-share"></i>
			<span> Java常用实用类			<span class="float-right menu-arrow">
			<i class="mdi mdi-chevron-right"></i>
			</span> 
			</span>
		</a>
		<ul class="submenu">
			 		</ul>
	</li>
		<li>
	    <a href="/java/biji/" class="waves-effect">
		    <i class="icon-share"></i>
		    <span>JAVA笔记
		       	<span class="float-right menu-arrow">
		       	<i class="mdi mdi-chevron-right"></i>
		       	</span>
		    </span>
	    </a>
	</li>
	</ul>
</div>
<!-- Sidebar -->
<div class="clearfix"></div>
</div>
<!-- Sidebar -left -->
</div>
<!-- Left Sidebar End -->
<!-- Start right Content here -->
<div class="content-page">
	<div class="content">
		<div class="container-fluid">
			<div class="page-title-box">
				<div class="row align-items-center">
					<div class="col-sm-6">
						<h1 class="page-title">全面挖掘Java Excel API 使用方法</h1>
					</div>
				</div>
				<!-- end row -->
			</div>
			<!-- end page-title -->
			<!-- START ROW -->
			<div class="panel panel-forbid">
				<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>内容摘要</div>
			    <div class="panel-content">
			    <span>使用Windows操作系统的朋友对Excel（电子表格）一定不会陌生，但是要使用Java语言来操纵Excel文件并不是一件容易的事。</span>                                     
		    	</div>
			    <div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>文章正文</div>
			    <div class="panel-content">
			    <span>&nbsp;&nbsp;&nbsp; 使用Windows操作系统的朋友对Excel（电子表格）一定不会陌生，但是要使用Java语言来操纵Excel文件并不是一件容易的事。在Web应用日益盛行的今天，通过Web来操作Excel文件的需求越来越强烈，目前较为流行的操作是在JSP或Servlet 中创建一个CSV （comma separated values）文件，并将这个文件以MIME，text/csv类型返回给浏览器，接着浏览器调用Excel并且显示CSV文件。这样只是说可以访问到Excel文件，但是还不能真正的操纵Excel文件，本文将给大家一个惊喜，向大家介绍一个开放源码项目，Java Excel API，使用它大家就可以方便地操纵Excel文件了。<br /><br />　　Java Excel API简介<br /><br />　　Java Excel是一开放源码项目，通过它Java开发人员可以读取Excel文件的内容、创建新的Excel文件、更新已经存在的Excel文件。使用该API非Windows操作系统也可以通过纯Java应用来处理Excel数据表。因为是使用Java编写的，所以我们在Web应用中可以通过JSP、Servlet来调用API实现对Excel数据表的访问。<br /><br />　　现在发布的稳定版本是V2.0，提供以下功能：<br /><br />　　　从Excel 95、97、2000等格式的文件中读取数据；<br />　　　读取Excel公式（可以读取Excel 97以后的公式）；<br />　　　生成Excel数据表（格式为Excel 97）；<br />　　　支持字体、数字、日期的格式化；<br />　　　支持单元格的阴影操作，以及颜色操作；<br />　　　修改已经存在的数据表；<br /><br />　　现在还不支持以下功能，但不久就会提供了：<br /><br />　　　不能够读取图表信息；<br />　　　可以读，但是不能生成公式，任何类型公式最后的计算值都可以读出；<br />　<br />　　 应用示例<br /><br />　　1、从Excel文件读取数据表<br /><br />　　Java Excel API既可以从本地文件系统的一个文件(.xls)，也可以从输入流中读取Excel数据表。读取Excel数据表的第一步是创建Workbook(术语：工作薄)，下面的代码片段举例说明了应该如何操作：(完整代码见ExcelReading.java)<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>import java.io.*;<br />import jxl.*;<br />&hellip; &hellip; &hellip; &hellip;<br />try<br />{<br />//构建Workbook对象, 只读Workbook对象<br />//直接从本地文件创建Workbook<br />//从输入流创建Workbook<br />InputStream is = new FileInputStream(sourcefile);<br />jxl.Workbook rwb = Workbook.getWorkbook(is);<br />}<br />catch (Exception e)<br />{<br />e.printStackTrace();<br />}</td>
		</tr>
	</tbody>
</table><br />　　一旦创建了Workbook，我们就可以通过它来访问Excel Sheet(术语：工作表)。参考下面的代码片段：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>//获取第一张Sheet表<br />Sheet rs = rwb.getSheet(0);</td>
		</tr>
	</tbody>
</table><br />　　我们既可能通过Sheet的名称来访问它，也可以通过下标来访问它。如果通过下标来访问的话，要注意的一点是下标从0开始，就像数组一样。<br /><br />　　一旦得到了Sheet，我们就可以通过它来访问Excel Cell(术语：单元格)。参考下面的代码片段：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>//获取第一行，第一列的值<br />Cell c00 = rs.getCell(0, 0);<br />String strc00 = c00.getContents();<br /><br />//获取第一行，第二列的值<br />Cell c10 = rs.getCell(1, 0);<br />String strc10 = c10.getContents();<br /><br />//获取第二行，第二列的值<br />Cell c11 = rs.getCell(1, 1);<br />String strc11 = c11.getContents();<br /><br />System.out.println(&quot;Cell(0, 0)&quot; + &quot; value : &quot; + strc00 + &quot;; type : &quot; + c00.getType());<br />System.out.println(&quot;Cell(1, 0)&quot; + &quot; value : &quot; + strc10 + &quot;; type : &quot; + c10.getType());<br />System.out.println(&quot;Cell(1, 1)&quot; + &quot; value : &quot; + strc11 + &quot;; type : &quot; + c11.getType());</td>
		</tr>
	</tbody>
</table><br />　　如果仅仅是取得Cell的值，我们可以方便地通过getContents()方法，它可以将任何类型的Cell值都作为一个字符串返回。示例代码中Cell(0, 0)是文本型，Cell(1, 0)是数字型，Cell(1,1)是日期型，通过getContents()，三种类型的返回值都是字符型。<br /><br />　　如果有需要知道Cell内容的确切类型，API也提供了一系列的方法。参考下面的代码片段：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>String strc00 = null;<br />double strc10 = 0.00;<br />Date strc11 = null;<br /><br />Cell c00 = rs.getCell(0, 0);<br />Cell c10 = rs.getCell(1, 0);<br />Cell c11 = rs.getCell(1, 1);<br /><br />if(c00.getType() == CellType.LABEL)<br />{<br />LabelCell labelc00 = (LabelCell)c00;<br />strc00 = labelc00.getString();<br />}<br />if(c10.getType() == CellType.NUMBER)<br />{<br />NmberCell numc10 = (NumberCell)c10;<br />strc10 = numc10.getvalue();<br />}<br />if(c11.getType() == CellType.DATE)<br />{<br />DateCell datec11 = (DateCell)c11;<br />strc11 = datec11.getDate();<br />}<br /><br />System.out.println(&quot;Cell(0, 0)&quot; + &quot; value : &quot; + strc00 + &quot;; type : &quot; + c00.getType());<br />System.out.println(&quot;Cell(1, 0)&quot; + &quot; value : &quot; + strc10 + &quot;; type : &quot; + c10.getType());<br />System.out.println(&quot;Cell(1, 1)&quot; + &quot; value : &quot; + strc11 + &quot;; type : &quot; + c11.getType());</td>
		</tr>
	</tbody>
</table><br />　　在得到Cell对象后，通过getType()方法可以获得该单元格的类型，然后与API提供的基本类型相匹配，强制转换成相应的类型，最后调用相应的取值方法getXXX()，就可以得到确定类型的值。API提供了以下基本类型，与Excel的数据格式相对应，如下图所示：<br /><br />　　每种类型的具体意义，请参见Java Excel API document．<br /><br />　　当你完成对Excel电子表格数据的处理后，一定要使用close()方法来关闭先前创建的对象，以释放读取数据表的过程中所占用的内存空间，在读取大量数据时显得尤为重要。参考如下代码片段：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>//操作完成时，关闭对象，释放占用的内存空间<br />rwb.close();</td>
		</tr>
	</tbody>
</table>
<p><br />　　Java Excel API提供了许多访问Excel数据表的方法，在这里我只简要地介绍几个常用的方法，其它的方法请参考附录中的Java Excel API document．</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp; Workbook类提供的方法<br /><br />　　1. int getNumberOfSheets()<br /><br />　　获得工作薄（Workbook）中工作表（Sheet）的个数，示例：</p>&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));<br />int sheets = rwb.getNumberOfSheets();</td>
		</tr>
	</tbody>
</table><br />　　2. Sheet[] getSheets()<br /><br />　　返回工作薄（Workbook）中工作表（Sheet）对象数组，示例：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));<br />Sheet[] sheets = rwb.getSheets();</td>
		</tr>
	</tbody>
</table><br />　　3. String getVersion()<br /><br />　　返回正在使用的API的版本号，好像是没什么太大的作用。<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));<br />String apiVersion = rwb.getVersion();</td>
		</tr>
	</tbody>
</table><br />　　Sheet接口提供的方法<br /><br />　　1) String getName()<br /><br />　　获取Sheet的名称，示例：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));<br />jxl.Sheet rs = rwb.getSheet(0);<br />String sheetName = rs.getName();</td>
		</tr>
	</tbody>
</table><br />　　2) int getColumns()<br /><br />　　获取Sheet表中所包含的总列数，示例：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));<br />jxl.Sheet rs = rwb.getSheet(0);<br />int rsColumns = rs.getColumns();</td>
		</tr>
	</tbody>
</table><br />　　3) Cell[] getColumn(int column)<br /><br />　　获取某一列的所有单元格，返回的是单元格对象数组，示例：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));<br />jxl.Sheet rs = rwb.getSheet(0);<br />Cell[] cell = rs.getColumn(0);</td>
		</tr>
	</tbody>
</table><br />　　4) int getRows()<br /><br />　　获取Sheet表中所包含的总行数，示例：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));<br />jxl.Sheet rs = rwb.getSheet(0);<br />int rsRows = rs.getRows();</td>
		</tr>
	</tbody>
</table><br />　　5) Cell[] getRow(int row)<br /><br />　　获取某一行的所有单元格，返回的是单元格对象数组，示例子：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));<br />jxl.Sheet rs = rwb.getSheet(0);<br />Cell[] cell = rs.getRow(0);</td>
		</tr>
	</tbody>
</table><br />　　6) Cell getCell(int column, int row)<br /><br />　　获取指定单元格的对象引用，需要注意的是它的两个参数，第一个是列数，第二个是行数，这与通常的行、列组合有些不同。<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>jxl.Workbook rwb = jxl.Workbook.getWorkbook(new File(sourcefile));<br />jxl.Sheet rs = rwb.getSheet(0);<br />Cell cell = rs.getCell(0, 0);</td>
		</tr>
	</tbody>
</table><br />　　2、生成新的Excel工作薄<br /><br />　　下面的代码主要是向大家介绍如何生成简单的Excel工作表，在这里单元格的内容是不带任何修饰的(如：字体，颜色等等)，所有的内容都作为字符串写入。(完整代码见ExcelWriting.java)<br /><br />　　与读取Excel工作表相似，首先要使用Workbook类的工厂方法创建一个可写入的工作薄(Workbook)对象，这里要注意的是，只能通过API提供的工厂方法来创建Workbook，而不能使用WritableWorkbook的构造函数，因为类WritableWorkbook的构造函数为protected类型。示例代码片段如下：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>import java.io.*;<br />import jxl.*;<br />import jxl.write.*;<br />&hellip; &hellip; &hellip; &hellip;<br />try<br />{<br />//构建Workbook对象, 只读Workbook对象<br />//Method 1：创建可写入的Excel工作薄<br />jxl.write.WritableWorkbook wwb = Workbook.createWorkbook(new File(targetfile));<br /><br />//Method 2：将WritableWorkbook直接写入到输出流<br />/*<br />OutputStream os = new FileOutputStream(targetfile);<br />jxl.write.WritableWorkbook wwb = Workbook.createWorkbook(os);<br />*/<br />}<br />catch (Exception e)<br />{<br />e.printStackTrace();<br />}</td>
		</tr>
	</tbody>
</table><br />　　API提供了两种方式来处理可写入的输出流，一种是直接生成本地文件，如果文件名不带全路径的话，缺省的文件会定位在当前目录，如果文件名带有全路径的话，则生成的Excel文件则会定位在相应的目录；另外一种是将Excel对象直接写入到输出流，例如：用户通过浏览器来访问Web服务器，如果HTTP头设置正确的话，浏览器自动调用客户端的Excel应用程序，来显示动态生成的Excel电子表格。<br /><br />　　接下来就是要创建工作表，创建工作表的方法与创建工作薄的方法几乎一样，同样是通过工厂模式方法获得相应的对象，该方法需要两个参数，一个是工作表的名称，另一个是工作表在工作薄中的位置，参考下面的代码片段：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>//创建Excel工作表<br />jxl.write.WritableSheet ws = wwb.createSheet(&quot;Test Sheet 1&quot;, 0);<br /><br />&quot;这锅也支好了，材料也准备齐全了，可以开始下锅了！&quot;，现在要做的只是实例化API所提供的Excel基本数据类型，并将它们添加到工作表中就可以了，参考下面的代码片段：<br />//1.添加Label对象<br />jxl.write.Label labelC = new jxl.write.Label(0, 0, &quot;This is a Label cell&quot;);<br />ws.addCell(labelC);<br /><br />//添加带有字型Formatting的对象<br />jxl.write.WritableFont wf = new jxl.write.WritableFont(WritableFont.TIMES, 18, WritableFont.BOLD, true);<br />jxl.write.WritableCellFormat wcfF = new jxl.write.WritableCellFormat(wf);<br />jxl.write.Label labelCF = new jxl.write.Label(1, 0, &quot;This is a Label Cell&quot;, wcfF);<br />ws.addCell(labelCF);<br /><br />//添加带有字体颜色Formatting的对象<br />jxl.write.WritableFont wfc = new jxl.write.WritableFont(WritableFont.ARIAL, 10, WritableFont.NO_BOLD, false,<br />Underlinestyle.NO_UNDERLINE, jxl.format.Colour.RED);<br />jxl.write.WritableCellFormat wcfFC = new jxl.write.WritableCellFormat(wfc);<br />jxl.write.Label labelCFC = new jxl.write.Label(1, 0, &quot;This is a Label Cell&quot;, wcfFC);<br />ws.addCell(labelCF);<br /><br />//2.添加Number对象<br />jxl.write.Number labelN = new jxl.write.Number(0, 1, 3.1415926);<br />ws.addCell(labelN);<br /><br />//添加带有formatting的Number对象<br />jxl.write.NumberFormat nf = new jxl.write.NumberFormat(&quot;#.##&quot;);<br />jxl.write.WritableCellFormat wcfN = new jxl.write.WritableCellFormat(nf);<br />jxl.write.Number labelNF = new jxl.write.Number(1, 1, 3.1415926, wcfN);<br />ws.addCell(labelNF);<br /><br />//3.添加Boolean对象<br />jxl.write.Boolean labelB = new jxl.write.Boolean(0, 2, false);<br />ws.addCell(labelB);<br /><br />//4.添加DateTime对象<br />jxl.write.DateTime labelDT = new jxl.write.DateTime(0, 3, new java.util.Date());<br />ws.addCell(labelDT);<br /><br />//添加带有formatting的DateFormat对象<br />jxl.write.DateFormat df = new jxl.write.DateFormat(&quot;dd MM yyyy hh:mm:ss&quot;);<br />jxl.write.WritableCellFormat wcfDF = new jxl.write.WritableCellFormat(df);<br />jxl.write.DateTime labelDTF = new jxl.write.DateTime(1, 3, new java.util.Date(), wcfDF);<br />ws.addCell(labelDTF);</td>
		</tr>
	</tbody>
</table><br />　　这里有两点大家要引起大家的注意。第一点，在构造单元格时，单元格在工作表中的位置就已经确定了。一旦创建后，单元格的位置是不能够变更的，尽管单元格的内容是可以改变的。第二点，单元格的定位是按照下面这样的规律(column, row)，而且下标都是从0开始，例如，A1被存储在(0, 0)，B1被存储在(1, 0)。<br /><br />　　最后，不要忘记关闭打开的Excel工作薄对象，以释放占用的内存，参见下面的代码片段：<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>//写入Exel工作表<br />wwb.write();<br /><br />//关闭Excel工作薄对象<br />wwb.close();</td>
		</tr>
	</tbody>
</table><br />　　这可能与读取Excel文件的操作有少少不同，在关闭Excel对象之前，你必须要先调用write()方法，因为先前的操作都是存储在缓存中的，所以要通过该方法将操作的内容保存在文件中。如果你先关闭了Excel对象，那么只能得到一张空的工作薄了。<br /><br />　　3、拷贝、更新Excel工作薄<br /><br />　　接下来简要介绍一下如何更新一个已经存在的工作薄，主要是下面二步操作，第一步是构造只读的Excel工作薄，第二步是利用已经创建的Excel工作薄创建新的可写入的Excel工作薄，参考下面的代码片段：(完整代码见ExcelModifying.java)<br />&nbsp;
<table align="center" bgcolor="#e8e9e0" border="1" bordercolor="#ffcc66" width="90%">
	<tbody>
		<tr>
			<td>//创建只读的Excel工作薄的对象<br />jxl.Workbook rw = jxl.Workbook.getWorkbook(new File(sourcefile));<br /><br />//创建可写入的Excel工作薄对象<br />jxl.write.WritableWorkbook wwb = Workbook.createWorkbook(new File(targetfile), rw);<br /><br />//读取第一张工作表<br />jxl.write.WritableSheet ws = wwb.getSheet(0);<br /><br />//获得第一个单元格对象<br />jxl.write.WritableCell wc = ws.getWritableCell(0, 0);<br /><br />//判断单元格的类型, 做出相应的转化<br />if(wc.getType() == CellType.LABEL)<br />{<br />Label l = (Label)wc;<br />l.setString(&quot;The value has been modified.&quot;);<br />}<br /><br />//写入Excel对象<br />wwb.write();<br /><br />//关闭可写入的Excel对象<br />wwb.close();<br /><br />//关闭只读的Excel对象<br />rw.close();</td>
		</tr>
	</tbody>
</table><br />　　之所以使用这种方式构建Excel对象，完全是因为效率的原因，因为上面的示例才是API的主要应用。为了提高性能，在读取工作表时，与数据相关的一些输出信息，所有的格式信息，如：字体、颜色等等，是不被处理的，因为我们的目的是获得行数据的值，既使没有了修饰，也不会对行数据的值产生什么影响。唯一的不利之处就是，在内存中会同时保存两个同样的工作表，这样当工作表体积比较大时，会占用相当大的内存，但现在好像内存的大小并不是什么关键因素了。<br /><br />　　一旦获得了可写入的工作表对象，我们就可以对单元格对象进行更新的操作了，在这里我们不必调用API提供的add()方法，因为单元格已经于工作表当中，所以我们只需要调用相应的setXXX()方法，就可以完成更新的操作了。<br /><br />　　尽单元格原有的格式化修饰是不能去掉的，我们还是可以将新的单元格修饰加上去，以使单元格的内容以不同的形式表现。<br /><br />　　新生成的工作表对象是可写入的，我们除了更新原有的单元格外，还可以添加新的单元格到工作表中，这与示例2的操作是完全一样的。<br /><br />　　最后，不要忘记调用write()方法，将更新的内容写入到文件中，然后关闭工作薄对象，这里有两个工作薄对象要关闭，一个是只读的，另外一个是可写入的。
<div class="c" id="weste_pagead_4"><script type="text/javascript">BAIDU_CLB_fillSlot("160927");</script></div></span>                                     
		    	</div>
		    	<div class="panel-title"><i class="fa fa fa-file-text fa-fw"></i>代码注释</div>
			    <div class="panel-content">
			    <span>[!--zhushi--]</span>                                     
		    	</div>

			</div>

			<!-- END ROW -->
			<div class="newsPage">
				<div class="newsPageTurn">
				    <span><a>上一篇</a><a href='/java/biji/129.html'>在JBoss中配置多个数据库和数据源</a><a>下一篇</a><a href='/java/biji/131.html'>Java Servlet和数据库连接池的部署</a></span>
				</div>
			</div>
		</div>


<div id="author-box">
    <h3>作者：喵哥笔记</h3>
        <div class="author-info">
            <div class="author-avatar">
                <img src="/skin1/picture/01.jpg" alt="IDC笔记" class="avatar" width="64" height="64">
            </div>
        <div class="author-description">
            <p>学的不仅是技术，更是梦想！</p>
            <ul class="author-social follows nb">
            	<li>
                    <a target="_blank" href="/" title="IDC笔记">IDC笔记</a>
                </li>
            </ul>
        </div>
        <div class="clear"></div>
    </div>
</div>

<!-- container-fluid -->
	</div>
<!-- content -->
	<footer class="footer">
	© 2020 IDC笔记 <i class="mdi mdi-heart text-danger"></i>. | 备案号：<a href="https://beian.miit.gov.cn/">辽ICP备18000516号</a>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?674585fbbd2294d3faf910f668ea91b4";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

	</footer>
</div>

</div>
<!-- END wrapper -->
<!-- jQuery  -->
<script src="/skin1/js/jquery.min.js"></script>
<script src="/skin1/js/bootstrap.bundle.min.js"></script>
<script src="/skin1/js/metismenu.min.js"></script>
<script src="/skin1/js/jquery.slimscroll.js"></script>
<script src="/skin1/js/waves.min.js"></script>
<!--Morris Chart-->
<script src="/skin1/js/morris.min.js"></script>
<script src="/skin1/js/raphael.min.js"></script>
<script src="/skin1/js/dashboard.init.js"></script>
<script src="/skin1/js/app.js"></script>
<script src="/foot.js"></script>
</body>
</html>